var tl=Object.defineProperty;var il=(t,e,i)=>e in t?tl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var Q=(t,e,i)=>(il(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}})();var Zt=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(Zt||{}),fc=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(fc||{}),Sn=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Sn||{}),Y=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(Y||{}),ct=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(ct||{}),F=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(F||{}),pi=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(pi||{}),z=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(z||{}),An=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(An||{}),De=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(De||{}),Rt=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Rt||{}),ut=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(ut||{}),et=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(et||{}),at=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(at||{}),pa=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(pa||{}),ke=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(ke||{}),ye=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(ye||{}),me=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(me||{}),ht=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(ht||{});const sl={createCanvas:(t,e)=>{const i=document.createElement("canvas");return i.width=t,i.height=e,i},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},L={ADAPTER:sl,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var kr=/iPhone/i,Fa=/iPod/i,La=/iPad/i,Na=/\biOS-universal(?:.+)Mac\b/i,Ur=/\bAndroid(?:.+)Mobile\b/i,ka=/Android/i,ei=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ys=/Silk/i,pt=/Windows Phone/i,Ua=/\bWindows(?:.+)ARM\b/i,Ga=/BlackBerry/i,Ha=/BB10/i,Xa=/Opera Mini/i,$a=/\b(CriOS|Chrome)(?:.+)Mobile/i,Va=/Mobile(?:.+)Firefox\b/i,za=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function rl(t){return function(e){return e.test(t)}}function Wa(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var i=e.userAgent,s=i.split("[FBAN");typeof s[1]<"u"&&(i=s[0]),s=i.split("Twitter"),typeof s[1]<"u"&&(i=s[0]);var r=rl(i),n={apple:{phone:r(kr)&&!r(pt),ipod:r(Fa),tablet:!r(kr)&&(r(La)||za(e))&&!r(pt),universal:r(Na),device:(r(kr)||r(Fa)||r(La)||r(Na)||za(e))&&!r(pt)},amazon:{phone:r(ei),tablet:!r(ei)&&r(ys),device:r(ei)||r(ys)},android:{phone:!r(pt)&&r(ei)||!r(pt)&&r(Ur),tablet:!r(pt)&&!r(ei)&&!r(Ur)&&(r(ys)||r(ka)),device:!r(pt)&&(r(ei)||r(ys)||r(Ur)||r(ka))||r(/\bokhttp\b/i)},windows:{phone:r(pt),tablet:r(Ua),device:r(pt)||r(Ua)},other:{blackberry:r(Ga),blackberry10:r(Ha),opera:r(Xa),firefox:r(Va),chrome:r($a),device:r(Ga)||r(Ha)||r(Xa)||r(Va)||r($a)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const nl=Wa.default??Wa,_t=nl(globalThis.navigator);L.RETINA_PREFIX=/@([0-9\.]+)x/;L.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function al(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var i=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(i,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),i}var dc={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,i="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1));function r(c,h,l){this.fn=c,this.context=h,this.once=l||!1}function n(c,h,l,f,u){if(typeof l!="function")throw new TypeError("The listener must be a function");var p=new r(l,f||c,u),m=i?i+h:h;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function a(c,h){--c._eventsCount===0?c._events=new s:delete c._events[h]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var h=[],l,f;if(this._eventsCount===0)return h;for(f in l=this._events)e.call(l,f)&&h.push(i?f.slice(1):f);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(l)):h},o.prototype.listeners=function(h){var l=i?i+h:h,f=this._events[l];if(!f)return[];if(f.fn)return[f.fn];for(var u=0,p=f.length,m=new Array(p);u<p;u++)m[u]=f[u].fn;return m},o.prototype.listenerCount=function(h){var l=i?i+h:h,f=this._events[l];return f?f.fn?1:f.length:0},o.prototype.emit=function(h,l,f,u,p,m){var b=i?i+h:h;if(!this._events[b])return!1;var _=this._events[b],T=arguments.length,g,d;if(_.fn){switch(_.once&&this.removeListener(h,_.fn,void 0,!0),T){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,l),!0;case 3:return _.fn.call(_.context,l,f),!0;case 4:return _.fn.call(_.context,l,f,u),!0;case 5:return _.fn.call(_.context,l,f,u,p),!0;case 6:return _.fn.call(_.context,l,f,u,p,m),!0}for(d=1,g=new Array(T-1);d<T;d++)g[d-1]=arguments[d];_.fn.apply(_.context,g)}else{var v=_.length,w;for(d=0;d<v;d++)switch(_[d].once&&this.removeListener(h,_[d].fn,void 0,!0),T){case 1:_[d].fn.call(_[d].context);break;case 2:_[d].fn.call(_[d].context,l);break;case 3:_[d].fn.call(_[d].context,l,f);break;case 4:_[d].fn.call(_[d].context,l,f,u);break;default:if(!g)for(w=1,g=new Array(T-1);w<T;w++)g[w-1]=arguments[w];_[d].fn.apply(_[d].context,g)}}return!0},o.prototype.on=function(h,l,f){return n(this,h,l,f,!1)},o.prototype.once=function(h,l,f){return n(this,h,l,f,!0)},o.prototype.removeListener=function(h,l,f,u){var p=i?i+h:h;if(!this._events[p])return this;if(!l)return a(this,p),this;var m=this._events[p];if(m.fn)m.fn===l&&(!u||m.once)&&(!f||m.context===f)&&a(this,p);else{for(var b=0,_=[],T=m.length;b<T;b++)(m[b].fn!==l||u&&!m[b].once||f&&m[b].context!==f)&&_.push(m[b]);_.length?this._events[p]=_.length===1?_[0]:_:a(this,p)}return this},o.prototype.removeAllListeners=function(h){var l;return h?(l=i?i+h:h,this._events[l]&&a(this,l)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o})(dc);var ol=dc.exports;const as=uc(ol);var ma={exports:{}};ma.exports=vr;ma.exports.default=vr;function vr(t,e,i){i=i||2;var s=e&&e.length,r=s?e[0]*i:t.length,n=pc(t,0,r,i,!0),a=[];if(!n||n.next===n.prev)return a;var o,c,h,l,f,u,p;if(s&&(n=ul(t,e,n,i)),t.length>80*i){o=h=t[0],c=l=t[1];for(var m=i;m<r;m+=i)f=t[m],u=t[m+1],f<o&&(o=f),u<c&&(c=u),f>h&&(h=f),u>l&&(l=u);p=Math.max(h-o,l-c),p=p!==0?32767/p:0}return es(n,a,i,o,c,p,0),a}function pc(t,e,i,s,r){var n,a;if(r===In(t,e,i,s)>0)for(n=e;n<i;n+=s)a=ja(n,t[n],t[n+1],a);else for(n=i-s;n>=e;n-=s)a=ja(n,t[n],t[n+1],a);return a&&br(a,a.next)&&(is(a),a=a.next),a}function Yt(t,e){if(!t)return t;e||(e=t);var i=t,s;do if(s=!1,!i.steiner&&(br(i,i.next)||le(i.prev,i,i.next)===0)){if(is(i),i=e=i.prev,i===i.next)break;s=!0}else i=i.next;while(s||i!==e);return e}function es(t,e,i,s,r,n,a){if(t){!a&&n&&yl(t,s,r,n);for(var o=t,c,h;t.prev!==t.next;){if(c=t.prev,h=t.next,n?hl(t,s,r,n):cl(t)){e.push(c.i/i|0),e.push(t.i/i|0),e.push(h.i/i|0),is(t),t=h.next,o=h.next;continue}if(t=h,t===o){a?a===1?(t=ll(Yt(t),e,i),es(t,e,i,s,r,n,2)):a===2&&fl(t,e,i,s,r,n):es(Yt(t),e,i,s,r,n,1);break}}}}function cl(t){var e=t.prev,i=t,s=t.next;if(le(e,i,s)>=0)return!1;for(var r=e.x,n=i.x,a=s.x,o=e.y,c=i.y,h=s.y,l=r<n?r<a?r:a:n<a?n:a,f=o<c?o<h?o:h:c<h?c:h,u=r>n?r>a?r:a:n>a?n:a,p=o>c?o>h?o:h:c>h?c:h,m=s.next;m!==e;){if(m.x>=l&&m.x<=u&&m.y>=f&&m.y<=p&&ui(r,o,n,c,a,h,m.x,m.y)&&le(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function hl(t,e,i,s){var r=t.prev,n=t,a=t.next;if(le(r,n,a)>=0)return!1;for(var o=r.x,c=n.x,h=a.x,l=r.y,f=n.y,u=a.y,p=o<c?o<h?o:h:c<h?c:h,m=l<f?l<u?l:u:f<u?f:u,b=o>c?o>h?o:h:c>h?c:h,_=l>f?l>u?l:u:f>u?f:u,T=Cn(p,m,e,i,s),g=Cn(b,_,e,i,s),d=t.prevZ,v=t.nextZ;d&&d.z>=T&&v&&v.z<=g;){if(d.x>=p&&d.x<=b&&d.y>=m&&d.y<=_&&d!==r&&d!==a&&ui(o,l,c,f,h,u,d.x,d.y)&&le(d.prev,d,d.next)>=0||(d=d.prevZ,v.x>=p&&v.x<=b&&v.y>=m&&v.y<=_&&v!==r&&v!==a&&ui(o,l,c,f,h,u,v.x,v.y)&&le(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;d&&d.z>=T;){if(d.x>=p&&d.x<=b&&d.y>=m&&d.y<=_&&d!==r&&d!==a&&ui(o,l,c,f,h,u,d.x,d.y)&&le(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=g;){if(v.x>=p&&v.x<=b&&v.y>=m&&v.y<=_&&v!==r&&v!==a&&ui(o,l,c,f,h,u,v.x,v.y)&&le(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function ll(t,e,i){var s=t;do{var r=s.prev,n=s.next.next;!br(r,n)&&mc(r,s,s.next,n)&&ts(r,n)&&ts(n,r)&&(e.push(r.i/i|0),e.push(s.i/i|0),e.push(n.i/i|0),is(s),is(s.next),s=t=n),s=s.next}while(s!==t);return Yt(s)}function fl(t,e,i,s,r,n){var a=t;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&bl(a,o)){var c=gc(a,o);a=Yt(a,a.next),c=Yt(c,c.next),es(a,e,i,s,r,n,0),es(c,e,i,s,r,n,0);return}o=o.next}a=a.next}while(a!==t)}function ul(t,e,i,s){var r=[],n,a,o,c,h;for(n=0,a=e.length;n<a;n++)o=e[n]*s,c=n<a-1?e[n+1]*s:t.length,h=pc(t,o,c,s,!1),h===h.next&&(h.steiner=!0),r.push(vl(h));for(r.sort(dl),n=0;n<r.length;n++)i=pl(r[n],i);return i}function dl(t,e){return t.x-e.x}function pl(t,e){var i=ml(t,e);if(!i)return e;var s=gc(i,t);return Yt(s,s.next),Yt(i,i.next)}function ml(t,e){var i=e,s=t.x,r=t.y,n=-1/0,a;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var o=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=s&&o>n&&(n=o,a=i.x<i.next.x?i:i.next,o===s))return a}i=i.next}while(i!==e);if(!a)return null;var c=a,h=a.x,l=a.y,f=1/0,u;i=a;do s>=i.x&&i.x>=h&&s!==i.x&&ui(r<l?s:n,r,h,l,r<l?n:s,r,i.x,i.y)&&(u=Math.abs(r-i.y)/(s-i.x),ts(i,t)&&(u<f||u===f&&(i.x>a.x||i.x===a.x&&gl(a,i)))&&(a=i,f=u)),i=i.next;while(i!==c);return a}function gl(t,e){return le(t.prev,t,e.prev)<0&&le(e.next,t,t.next)<0}function yl(t,e,i,s){var r=t;do r.z===0&&(r.z=Cn(r.x,r.y,e,i,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,_l(r)}function _l(t){var e,i,s,r,n,a,o,c,h=1;do{for(i=t,t=null,n=null,a=0;i;){for(a++,s=i,o=0,e=0;e<h&&(o++,s=s.nextZ,!!s);e++);for(c=h;o>0||c>0&&s;)o!==0&&(c===0||!s||i.z<=s.z)?(r=i,i=i.nextZ,o--):(r=s,s=s.nextZ,c--),n?n.nextZ=r:t=r,r.prevZ=n,n=r;i=s}n.nextZ=null,h*=2}while(a>1);return t}function Cn(t,e,i,s,r){return t=(t-i)*r|0,e=(e-s)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function vl(t){var e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function ui(t,e,i,s,r,n,a,o){return(r-a)*(e-o)>=(t-a)*(n-o)&&(t-a)*(s-o)>=(i-a)*(e-o)&&(i-a)*(n-o)>=(r-a)*(s-o)}function bl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!xl(t,e)&&(ts(t,e)&&ts(e,t)&&El(t,e)&&(le(t.prev,t,e.prev)||le(t,e.prev,e))||br(t,e)&&le(t.prev,t,t.next)>0&&le(e.prev,e,e.next)>0)}function le(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function br(t,e){return t.x===e.x&&t.y===e.y}function mc(t,e,i,s){var r=vs(le(t,e,i)),n=vs(le(t,e,s)),a=vs(le(i,s,t)),o=vs(le(i,s,e));return!!(r!==n&&a!==o||r===0&&_s(t,i,e)||n===0&&_s(t,s,e)||a===0&&_s(i,t,s)||o===0&&_s(i,e,s))}function _s(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function vs(t){return t>0?1:t<0?-1:0}function xl(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&mc(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function ts(t,e){return le(t.prev,t,t.next)<0?le(t,e,t.next)>=0&&le(t,t.prev,e)>=0:le(t,e,t.prev)<0||le(t,t.next,e)<0}function El(t,e){var i=t,s=!1,r=(t.x+e.x)/2,n=(t.y+e.y)/2;do i.y>n!=i.next.y>n&&i.next.y!==i.y&&r<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next;while(i!==t);return s}function gc(t,e){var i=new Pn(t.i,t.x,t.y),s=new Pn(e.i,e.x,e.y),r=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,s.next=i,i.prev=s,n.next=s,s.prev=n,s}function ja(t,e,i,s){var r=new Pn(t,e,i);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function is(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Pn(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}vr.deviation=function(t,e,i,s){var r=e&&e.length,n=r?e[0]*i:t.length,a=Math.abs(In(t,0,n,i));if(r)for(var o=0,c=e.length;o<c;o++){var h=e[o]*i,l=o<c-1?e[o+1]*i:t.length;a-=Math.abs(In(t,h,l,i))}var f=0;for(o=0;o<s.length;o+=3){var u=s[o]*i,p=s[o+1]*i,m=s[o+2]*i;f+=Math.abs((t[u]-t[m])*(t[p+1]-t[u+1])-(t[u]-t[p])*(t[m+1]-t[u+1]))}return a===0&&f===0?0:Math.abs((f-a)/a)};function In(t,e,i,s){for(var r=0,n=e,a=i-s;n<i;n+=s)r+=(t[a]-t[n])*(t[n+1]+t[a+1]),a=n;return r}vr.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,r=0;r<t.length;r++){for(var n=0;n<t[r].length;n++)for(var a=0;a<e;a++)i.vertices.push(t[r][n][a]);r>0&&(s+=t[r-1].length,i.holes.push(s))}return i};var Tl=ma.exports;const wl=uc(Tl);var tr={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */tr.exports;(function(t,e){(function(i){var s=e&&!e.nodeType&&e,r=t&&!t.nodeType&&t,n=typeof qe=="object"&&qe;(n.global===n||n.window===n||n.self===n)&&(i=n);var a,o=2147483647,c=36,h=1,l=26,f=38,u=700,p=72,m=128,b="-",_=/^xn--/,T=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=c-h,w=Math.floor,P=String.fromCharCode,R;function I(D){throw new RangeError(d[D])}function E(D,k){for(var X=D.length,Z=[];X--;)Z[X]=k(D[X]);return Z}function x(D,k){var X=D.split("@"),Z="";X.length>1&&(Z=X[0]+"@",D=X[1]),D=D.replace(g,".");var J=D.split("."),ae=E(J,k).join(".");return Z+ae}function y(D){for(var k=[],X=0,Z=D.length,J,ae;X<Z;)J=D.charCodeAt(X++),J>=55296&&J<=56319&&X<Z?(ae=D.charCodeAt(X++),(ae&64512)==56320?k.push(((J&1023)<<10)+(ae&1023)+65536):(k.push(J),X--)):k.push(J);return k}function C(D){return E(D,function(k){var X="";return k>65535&&(k-=65536,X+=P(k>>>10&1023|55296),k=56320|k&1023),X+=P(k),X}).join("")}function S(D){return D-48<10?D-22:D-65<26?D-65:D-97<26?D-97:c}function A(D,k){return D+22+75*(D<26)-((k!=0)<<5)}function B(D,k,X){var Z=0;for(D=X?w(D/u):D>>1,D+=w(D/k);D>v*l>>1;Z+=c)D=w(D/v);return w(Z+(v+1)*D/(D+f))}function M(D){var k=[],X=D.length,Z,J=0,ae=m,se=p,ue,_e,Be,Ee,oe,pe,ge,tt,it;for(ue=D.lastIndexOf(b),ue<0&&(ue=0),_e=0;_e<ue;++_e)D.charCodeAt(_e)>=128&&I("not-basic"),k.push(D.charCodeAt(_e));for(Be=ue>0?ue+1:0;Be<X;){for(Ee=J,oe=1,pe=c;Be>=X&&I("invalid-input"),ge=S(D.charCodeAt(Be++)),(ge>=c||ge>w((o-J)/oe))&&I("overflow"),J+=ge*oe,tt=pe<=se?h:pe>=se+l?l:pe-se,!(ge<tt);pe+=c)it=c-tt,oe>w(o/it)&&I("overflow"),oe*=it;Z=k.length+1,se=B(J-Ee,Z,Ee==0),w(J/Z)>o-ae&&I("overflow"),ae+=w(J/Z),J%=Z,k.splice(J++,0,ae)}return C(k)}function O(D){var k,X,Z,J,ae,se,ue,_e,Be,Ee,oe,pe=[],ge,tt,it,Bi;for(D=y(D),ge=D.length,k=m,X=0,ae=p,se=0;se<ge;++se)oe=D[se],oe<128&&pe.push(P(oe));for(Z=J=pe.length,J&&pe.push(b);Z<ge;){for(ue=o,se=0;se<ge;++se)oe=D[se],oe>=k&&oe<ue&&(ue=oe);for(tt=Z+1,ue-k>w((o-X)/tt)&&I("overflow"),X+=(ue-k)*tt,k=ue,se=0;se<ge;++se)if(oe=D[se],oe<k&&++X>o&&I("overflow"),oe==k){for(_e=X,Be=c;Ee=Be<=ae?h:Be>=ae+l?l:Be-ae,!(_e<Ee);Be+=c)Bi=_e-Ee,it=c-Ee,pe.push(P(A(Ee+Bi%it,0))),_e=w(Bi/it);pe.push(P(A(_e,0))),ae=B(X,tt,Z==J),X=0,++Z}++X,++k}return pe.join("")}function H(D){return x(D,function(k){return _.test(k)?M(k.slice(4).toLowerCase()):k})}function j(D){return x(D,function(k){return T.test(k)?"xn--"+O(k):k})}if(a={version:"1.4.1",ucs2:{decode:y,encode:C},decode:M,encode:O,toASCII:j,toUnicode:H},s&&r)if(t.exports==s)r.exports=a;else for(R in a)a.hasOwnProperty(R)&&(s[R]=a[R]);else i.punycode=a})(qe)})(tr,tr.exports);var Sl=tr.exports,Al=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},i=Symbol("test"),s=Object(i);if(typeof i=="string"||Object.prototype.toString.call(i)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var r=42;e[i]=r;for(i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var n=Object.getOwnPropertySymbols(e);if(n.length!==1||n[0]!==i||!Object.prototype.propertyIsEnumerable.call(e,i))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,i);if(a.value!==r||a.enumerable!==!0)return!1}return!0},Ya=typeof Symbol<"u"&&Symbol,Cl=Al,Pl=function(){return typeof Ya!="function"||typeof Symbol!="function"||typeof Ya("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Cl()},qa={foo:{}},Il=Object,Rl=function(){return{__proto__:qa}.foo===qa.foo&&!({__proto__:null}instanceof Il)},Ml="Function.prototype.bind called on incompatible ",Gr=Array.prototype.slice,Dl=Object.prototype.toString,Bl="[object Function]",Ol=function(e){var i=this;if(typeof i!="function"||Dl.call(i)!==Bl)throw new TypeError(Ml+i);for(var s=Gr.call(arguments,1),r,n=function(){if(this instanceof r){var l=i.apply(this,s.concat(Gr.call(arguments)));return Object(l)===l?l:this}else return i.apply(e,s.concat(Gr.call(arguments)))},a=Math.max(0,i.length-s.length),o=[],c=0;c<a;c++)o.push("$"+c);if(r=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(n),i.prototype){var h=function(){};h.prototype=i.prototype,r.prototype=new h,h.prototype=null}return r},Fl=Ol,ga=Function.prototype.bind||Fl,Ll=ga,Nl=Ll.call(Function.call,Object.prototype.hasOwnProperty),ee,xi=SyntaxError,yc=Function,mi=TypeError,Hr=function(t){try{return yc('"use strict"; return ('+t+").constructor;")()}catch{}},zt=Object.getOwnPropertyDescriptor;if(zt)try{zt({},"")}catch{zt=null}var Xr=function(){throw new mi},kl=zt?function(){try{return arguments.callee,Xr}catch{try{return zt(arguments,"callee").get}catch{return Xr}}}():Xr,ti=Pl(),Ul=Rl(),be=Object.getPrototypeOf||(Ul?function(t){return t.__proto__}:null),ai={},Gl=typeof Uint8Array>"u"||!be?ee:be(Uint8Array),Wt={"%AggregateError%":typeof AggregateError>"u"?ee:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ee:ArrayBuffer,"%ArrayIteratorPrototype%":ti&&be?be([][Symbol.iterator]()):ee,"%AsyncFromSyncIteratorPrototype%":ee,"%AsyncFunction%":ai,"%AsyncGenerator%":ai,"%AsyncGeneratorFunction%":ai,"%AsyncIteratorPrototype%":ai,"%Atomics%":typeof Atomics>"u"?ee:Atomics,"%BigInt%":typeof BigInt>"u"?ee:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ee:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ee:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ee:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?ee:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ee:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ee:FinalizationRegistry,"%Function%":yc,"%GeneratorFunction%":ai,"%Int8Array%":typeof Int8Array>"u"?ee:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ee:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ee:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ti&&be?be(be([][Symbol.iterator]())):ee,"%JSON%":typeof JSON=="object"?JSON:ee,"%Map%":typeof Map>"u"?ee:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ti||!be?ee:be(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ee:Promise,"%Proxy%":typeof Proxy>"u"?ee:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?ee:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ee:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ti||!be?ee:be(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ee:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ti&&be?be(""[Symbol.iterator]()):ee,"%Symbol%":ti?Symbol:ee,"%SyntaxError%":xi,"%ThrowTypeError%":kl,"%TypedArray%":Gl,"%TypeError%":mi,"%Uint8Array%":typeof Uint8Array>"u"?ee:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ee:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ee:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ee:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?ee:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ee:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ee:WeakSet};if(be)try{null.error}catch(t){var Hl=be(be(t));Wt["%Error.prototype%"]=Hl}var Xl=function t(e){var i;if(e==="%AsyncFunction%")i=Hr("async function () {}");else if(e==="%GeneratorFunction%")i=Hr("function* () {}");else if(e==="%AsyncGeneratorFunction%")i=Hr("async function* () {}");else if(e==="%AsyncGenerator%"){var s=t("%AsyncGeneratorFunction%");s&&(i=s.prototype)}else if(e==="%AsyncIteratorPrototype%"){var r=t("%AsyncGenerator%");r&&be&&(i=be(r.prototype))}return Wt[e]=i,i},Ka={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},os=ga,ir=Nl,$l=os.call(Function.call,Array.prototype.concat),Vl=os.call(Function.apply,Array.prototype.splice),Za=os.call(Function.call,String.prototype.replace),sr=os.call(Function.call,String.prototype.slice),zl=os.call(Function.call,RegExp.prototype.exec),Wl=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,jl=/\\(\\)?/g,Yl=function(e){var i=sr(e,0,1),s=sr(e,-1);if(i==="%"&&s!=="%")throw new xi("invalid intrinsic syntax, expected closing `%`");if(s==="%"&&i!=="%")throw new xi("invalid intrinsic syntax, expected opening `%`");var r=[];return Za(e,Wl,function(n,a,o,c){r[r.length]=o?Za(c,jl,"$1"):a||n}),r},ql=function(e,i){var s=e,r;if(ir(Ka,s)&&(r=Ka[s],s="%"+r[0]+"%"),ir(Wt,s)){var n=Wt[s];if(n===ai&&(n=Xl(s)),typeof n>"u"&&!i)throw new mi("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:s,value:n}}throw new xi("intrinsic "+e+" does not exist!")},ya=function(e,i){if(typeof e!="string"||e.length===0)throw new mi("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof i!="boolean")throw new mi('"allowMissing" argument must be a boolean');if(zl(/^%?[^%]*%?$/,e)===null)throw new xi("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var s=Yl(e),r=s.length>0?s[0]:"",n=ql("%"+r+"%",i),a=n.name,o=n.value,c=!1,h=n.alias;h&&(r=h[0],Vl(s,$l([0,1],h)));for(var l=1,f=!0;l<s.length;l+=1){var u=s[l],p=sr(u,0,1),m=sr(u,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new xi("property names with quotes must have matching quotes");if((u==="constructor"||!f)&&(c=!0),r+="."+u,a="%"+r+"%",ir(Wt,a))o=Wt[a];else if(o!=null){if(!(u in o)){if(!i)throw new mi("base intrinsic for "+e+" exists, but the property is not available.");return}if(zt&&l+1>=s.length){var b=zt(o,u);f=!!b,f&&"get"in b&&!("originalValue"in b.get)?o=b.get:o=o[u]}else f=ir(o,u),o=o[u];f&&!c&&(Wt[a]=o)}}return o},_c={exports:{}};(function(t){var e=ga,i=ya,s=i("%Function.prototype.apply%"),r=i("%Function.prototype.call%"),n=i("%Reflect.apply%",!0)||e.call(r,s),a=i("%Object.getOwnPropertyDescriptor%",!0),o=i("%Object.defineProperty%",!0),c=i("%Math.max%");if(o)try{o({},"a",{value:1})}catch{o=null}t.exports=function(f){var u=n(e,r,arguments);if(a&&o){var p=a(u,"length");p.configurable&&o(u,"length",{value:1+c(0,f.length-(arguments.length-1))})}return u};var h=function(){return n(e,s,arguments)};o?o(t.exports,"apply",{value:h}):t.exports.apply=h})(_c);var Kl=_c.exports,vc=ya,bc=Kl,Zl=bc(vc("String.prototype.indexOf")),Jl=function(e,i){var s=vc(e,!!i);return typeof s=="function"&&Zl(e,".prototype.")>-1?bc(s):s};const Ql={},ef=Object.freeze(Object.defineProperty({__proto__:null,default:Ql},Symbol.toStringTag,{value:"Module"})),tf=al(ef);var _a=typeof Map=="function"&&Map.prototype,$r=Object.getOwnPropertyDescriptor&&_a?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,rr=_a&&$r&&typeof $r.get=="function"?$r.get:null,Ja=_a&&Map.prototype.forEach,va=typeof Set=="function"&&Set.prototype,Vr=Object.getOwnPropertyDescriptor&&va?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,nr=va&&Vr&&typeof Vr.get=="function"?Vr.get:null,Qa=va&&Set.prototype.forEach,sf=typeof WeakMap=="function"&&WeakMap.prototype,ji=sf?WeakMap.prototype.has:null,rf=typeof WeakSet=="function"&&WeakSet.prototype,Yi=rf?WeakSet.prototype.has:null,nf=typeof WeakRef=="function"&&WeakRef.prototype,eo=nf?WeakRef.prototype.deref:null,af=Boolean.prototype.valueOf,of=Object.prototype.toString,cf=Function.prototype.toString,hf=String.prototype.match,ba=String.prototype.slice,Ct=String.prototype.replace,lf=String.prototype.toUpperCase,to=String.prototype.toLowerCase,xc=RegExp.prototype.test,io=Array.prototype.concat,ot=Array.prototype.join,ff=Array.prototype.slice,so=Math.floor,Rn=typeof BigInt=="function"?BigInt.prototype.valueOf:null,zr=Object.getOwnPropertySymbols,Mn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ei=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Re=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ei||"symbol")?Symbol.toStringTag:null,Ec=Object.prototype.propertyIsEnumerable,ro=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function no(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||xc.call(/e/,e))return e;var i=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var s=t<0?-so(-t):so(t);if(s!==t){var r=String(s),n=ba.call(e,r.length+1);return Ct.call(r,i,"$&_")+"."+Ct.call(Ct.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ct.call(e,i,"$&_")}var Dn=tf,ao=Dn.custom,oo=wc(ao)?ao:null,uf=function t(e,i,s,r){var n=i||{};if(St(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(St(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=St(n,"customInspect")?n.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(St(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(St(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=n.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Ac(e,n);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return o?no(e,c):c}if(typeof e=="bigint"){var h=String(e)+"n";return o?no(e,h):h}var l=typeof n.depth>"u"?5:n.depth;if(typeof s>"u"&&(s=0),s>=l&&l>0&&typeof e=="object")return Bn(e)?"[Array]":"[Object]";var f=Rf(n,s);if(typeof r>"u")r=[];else if(Sc(r,e)>=0)return"[Circular]";function u(S,A,B){if(A&&(r=ff.call(r),r.push(A)),B){var M={depth:n.depth};return St(n,"quoteStyle")&&(M.quoteStyle=n.quoteStyle),t(S,M,s+1,r)}return t(S,n,s+1,r)}if(typeof e=="function"&&!co(e)){var p=xf(e),m=bs(e,u);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(m.length>0?" { "+ot.call(m,", ")+" }":"")}if(wc(e)){var b=Ei?Ct.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Mn.call(e);return typeof e=="object"&&!Ei?Oi(b):b}if(Cf(e)){for(var _="<"+to.call(String(e.nodeName)),T=e.attributes||[],g=0;g<T.length;g++)_+=" "+T[g].name+"="+Tc(df(T[g].value),"double",n);return _+=">",e.childNodes&&e.childNodes.length&&(_+="..."),_+="</"+to.call(String(e.nodeName))+">",_}if(Bn(e)){if(e.length===0)return"[]";var d=bs(e,u);return f&&!If(d)?"["+On(d,f)+"]":"[ "+ot.call(d,", ")+" ]"}if(mf(e)){var v=bs(e,u);return!("cause"in Error.prototype)&&"cause"in e&&!Ec.call(e,"cause")?"{ ["+String(e)+"] "+ot.call(io.call("[cause]: "+u(e.cause),v),", ")+" }":v.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+ot.call(v,", ")+" }"}if(typeof e=="object"&&a){if(oo&&typeof e[oo]=="function"&&Dn)return Dn(e,{depth:l-s});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Ef(e)){var w=[];return Ja&&Ja.call(e,function(S,A){w.push(u(A,e,!0)+" => "+u(S,e))}),ho("Map",rr.call(e),w,f)}if(Sf(e)){var P=[];return Qa&&Qa.call(e,function(S){P.push(u(S,e))}),ho("Set",nr.call(e),P,f)}if(Tf(e))return Wr("WeakMap");if(Af(e))return Wr("WeakSet");if(wf(e))return Wr("WeakRef");if(yf(e))return Oi(u(Number(e)));if(vf(e))return Oi(u(Rn.call(e)));if(_f(e))return Oi(af.call(e));if(gf(e))return Oi(u(String(e)));if(!pf(e)&&!co(e)){var R=bs(e,u),I=ro?ro(e)===Object.prototype:e instanceof Object||e.constructor===Object,E=e instanceof Object?"":"null prototype",x=!I&&Re&&Object(e)===e&&Re in e?ba.call(Ot(e),8,-1):E?"Object":"",y=I||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",C=y+(x||E?"["+ot.call(io.call([],x||[],E||[]),": ")+"] ":"");return R.length===0?C+"{}":f?C+"{"+On(R,f)+"}":C+"{ "+ot.call(R,", ")+" }"}return String(e)};function Tc(t,e,i){var s=(i.quoteStyle||e)==="double"?'"':"'";return s+t+s}function df(t){return Ct.call(String(t),/"/g,"&quot;")}function Bn(t){return Ot(t)==="[object Array]"&&(!Re||!(typeof t=="object"&&Re in t))}function pf(t){return Ot(t)==="[object Date]"&&(!Re||!(typeof t=="object"&&Re in t))}function co(t){return Ot(t)==="[object RegExp]"&&(!Re||!(typeof t=="object"&&Re in t))}function mf(t){return Ot(t)==="[object Error]"&&(!Re||!(typeof t=="object"&&Re in t))}function gf(t){return Ot(t)==="[object String]"&&(!Re||!(typeof t=="object"&&Re in t))}function yf(t){return Ot(t)==="[object Number]"&&(!Re||!(typeof t=="object"&&Re in t))}function _f(t){return Ot(t)==="[object Boolean]"&&(!Re||!(typeof t=="object"&&Re in t))}function wc(t){if(Ei)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Mn)return!1;try{return Mn.call(t),!0}catch{}return!1}function vf(t){if(!t||typeof t!="object"||!Rn)return!1;try{return Rn.call(t),!0}catch{}return!1}var bf=Object.prototype.hasOwnProperty||function(t){return t in this};function St(t,e){return bf.call(t,e)}function Ot(t){return of.call(t)}function xf(t){if(t.name)return t.name;var e=hf.call(cf.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function Sc(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1}function Ef(t){if(!rr||!t||typeof t!="object")return!1;try{rr.call(t);try{nr.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function Tf(t){if(!ji||!t||typeof t!="object")return!1;try{ji.call(t,ji);try{Yi.call(t,Yi)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function wf(t){if(!eo||!t||typeof t!="object")return!1;try{return eo.call(t),!0}catch{}return!1}function Sf(t){if(!nr||!t||typeof t!="object")return!1;try{nr.call(t);try{rr.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function Af(t){if(!Yi||!t||typeof t!="object")return!1;try{Yi.call(t,Yi);try{ji.call(t,ji)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function Cf(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function Ac(t,e){if(t.length>e.maxStringLength){var i=t.length-e.maxStringLength,s="... "+i+" more character"+(i>1?"s":"");return Ac(ba.call(t,0,e.maxStringLength),e)+s}var r=Ct.call(Ct.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Pf);return Tc(r,"single",e)}function Pf(t){var e=t.charCodeAt(0),i={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return i?"\\"+i:"\\x"+(e<16?"0":"")+lf.call(e.toString(16))}function Oi(t){return"Object("+t+")"}function Wr(t){return t+" { ? }"}function ho(t,e,i,s){var r=s?On(i,s):ot.call(i,", ");return t+" ("+e+") {"+r+"}"}function If(t){for(var e=0;e<t.length;e++)if(Sc(t[e],`
`)>=0)return!1;return!0}function Rf(t,e){var i;if(t.indent==="	")i="	";else if(typeof t.indent=="number"&&t.indent>0)i=ot.call(Array(t.indent+1)," ");else return null;return{base:i,prev:ot.call(Array(e+1),i)}}function On(t,e){if(t.length===0)return"";var i=`
`+e.prev+e.base;return i+ot.call(t,","+i)+`
`+e.prev}function bs(t,e){var i=Bn(t),s=[];if(i){s.length=t.length;for(var r=0;r<t.length;r++)s[r]=St(t,r)?e(t[r],t):""}var n=typeof zr=="function"?zr(t):[],a;if(Ei){a={};for(var o=0;o<n.length;o++)a["$"+n[o]]=n[o]}for(var c in t)St(t,c)&&(i&&String(Number(c))===c&&c<t.length||Ei&&a["$"+c]instanceof Symbol||(xc.call(/[^\w$]/,c)?s.push(e(c,t)+": "+e(t[c],t)):s.push(c+": "+e(t[c],t))));if(typeof zr=="function")for(var h=0;h<n.length;h++)Ec.call(t,n[h])&&s.push("["+e(n[h])+"]: "+e(t[n[h]],t));return s}var xa=ya,Ci=Jl,Mf=uf,Df=xa("%TypeError%"),xs=xa("%WeakMap%",!0),Es=xa("%Map%",!0),Bf=Ci("WeakMap.prototype.get",!0),Of=Ci("WeakMap.prototype.set",!0),Ff=Ci("WeakMap.prototype.has",!0),Lf=Ci("Map.prototype.get",!0),Nf=Ci("Map.prototype.set",!0),kf=Ci("Map.prototype.has",!0),Ea=function(t,e){for(var i=t,s;(s=i.next)!==null;i=s)if(s.key===e)return i.next=s.next,s.next=t.next,t.next=s,s},Uf=function(t,e){var i=Ea(t,e);return i&&i.value},Gf=function(t,e,i){var s=Ea(t,e);s?s.value=i:t.next={key:e,next:t.next,value:i}},Hf=function(t,e){return!!Ea(t,e)},Xf=function(){var e,i,s,r={assert:function(n){if(!r.has(n))throw new Df("Side channel does not contain "+Mf(n))},get:function(n){if(xs&&n&&(typeof n=="object"||typeof n=="function")){if(e)return Bf(e,n)}else if(Es){if(i)return Lf(i,n)}else if(s)return Uf(s,n)},has:function(n){if(xs&&n&&(typeof n=="object"||typeof n=="function")){if(e)return Ff(e,n)}else if(Es){if(i)return kf(i,n)}else if(s)return Hf(s,n);return!1},set:function(n,a){xs&&n&&(typeof n=="object"||typeof n=="function")?(e||(e=new xs),Of(e,n,a)):Es?(i||(i=new Es),Nf(i,n,a)):(s||(s={key:{},next:null}),Gf(s,n,a))}};return r},$f=String.prototype.replace,Vf=/%20/g,jr={RFC1738:"RFC1738",RFC3986:"RFC3986"},Ta={default:jr.RFC3986,formatters:{RFC1738:function(t){return $f.call(t,Vf,"+")},RFC3986:function(t){return String(t)}},RFC1738:jr.RFC1738,RFC3986:jr.RFC3986},zf=Ta,Yr=Object.prototype.hasOwnProperty,Xt=Array.isArray,st=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),Wf=function(e){for(;e.length>1;){var i=e.pop(),s=i.obj[i.prop];if(Xt(s)){for(var r=[],n=0;n<s.length;++n)typeof s[n]<"u"&&r.push(s[n]);i.obj[i.prop]=r}}},Cc=function(e,i){for(var s=i&&i.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(s[r]=e[r]);return s},jf=function t(e,i,s){if(!i)return e;if(typeof i!="object"){if(Xt(e))e.push(i);else if(e&&typeof e=="object")(s&&(s.plainObjects||s.allowPrototypes)||!Yr.call(Object.prototype,i))&&(e[i]=!0);else return[e,i];return e}if(!e||typeof e!="object")return[e].concat(i);var r=e;return Xt(e)&&!Xt(i)&&(r=Cc(e,s)),Xt(e)&&Xt(i)?(i.forEach(function(n,a){if(Yr.call(e,a)){var o=e[a];o&&typeof o=="object"&&n&&typeof n=="object"?e[a]=t(o,n,s):e.push(n)}else e[a]=n}),e):Object.keys(i).reduce(function(n,a){var o=i[a];return Yr.call(n,a)?n[a]=t(n[a],o,s):n[a]=o,n},r)},Yf=function(e,i){return Object.keys(i).reduce(function(s,r){return s[r]=i[r],s},e)},qf=function(t,e,i){var s=t.replace(/\+/g," ");if(i==="iso-8859-1")return s.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(s)}catch{return s}},Kf=function(e,i,s,r,n){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),s==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});for(var o="",c=0;c<a.length;++c){var h=a.charCodeAt(c);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===zf.RFC1738&&(h===40||h===41)){o+=a.charAt(c);continue}if(h<128){o=o+st[h];continue}if(h<2048){o=o+(st[192|h>>6]+st[128|h&63]);continue}if(h<55296||h>=57344){o=o+(st[224|h>>12]+st[128|h>>6&63]+st[128|h&63]);continue}c+=1,h=65536+((h&1023)<<10|a.charCodeAt(c)&1023),o+=st[240|h>>18]+st[128|h>>12&63]+st[128|h>>6&63]+st[128|h&63]}return o},Zf=function(e){for(var i=[{obj:{o:e},prop:"o"}],s=[],r=0;r<i.length;++r)for(var n=i[r],a=n.obj[n.prop],o=Object.keys(a),c=0;c<o.length;++c){var h=o[c],l=a[h];typeof l=="object"&&l!==null&&s.indexOf(l)===-1&&(i.push({obj:a,prop:h}),s.push(l))}return Wf(i),e},Jf=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Qf=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},eu=function(e,i){return[].concat(e,i)},tu=function(e,i){if(Xt(e)){for(var s=[],r=0;r<e.length;r+=1)s.push(i(e[r]));return s}return i(e)},Pc={arrayToObject:Cc,assign:Yf,combine:eu,compact:Zf,decode:qf,encode:Kf,isBuffer:Qf,isRegExp:Jf,maybeMap:tu,merge:jf},Ic=Xf,js=Pc,qi=Ta,iu=Object.prototype.hasOwnProperty,lo={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,i){return e+"["+i+"]"},repeat:function(e){return e}},yt=Array.isArray,su=Array.prototype.push,Rc=function(t,e){su.apply(t,yt(e)?e:[e])},ru=Date.prototype.toISOString,fo=qi.default,Ae={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:js.encode,encodeValuesOnly:!1,format:fo,formatter:qi.formatters[fo],indices:!1,serializeDate:function(e){return ru.call(e)},skipNulls:!1,strictNullHandling:!1},nu=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},qr={},au=function t(e,i,s,r,n,a,o,c,h,l,f,u,p,m,b,_){for(var T=e,g=_,d=0,v=!1;(g=g.get(qr))!==void 0&&!v;){var w=g.get(e);if(d+=1,typeof w<"u"){if(w===d)throw new RangeError("Cyclic object value");v=!0}typeof g.get(qr)>"u"&&(d=0)}if(typeof c=="function"?T=c(i,T):T instanceof Date?T=f(T):s==="comma"&&yt(T)&&(T=js.maybeMap(T,function(M){return M instanceof Date?f(M):M})),T===null){if(n)return o&&!m?o(i,Ae.encoder,b,"key",u):i;T=""}if(nu(T)||js.isBuffer(T)){if(o){var P=m?i:o(i,Ae.encoder,b,"key",u);return[p(P)+"="+p(o(T,Ae.encoder,b,"value",u))]}return[p(i)+"="+p(String(T))]}var R=[];if(typeof T>"u")return R;var I;if(s==="comma"&&yt(T))m&&o&&(T=js.maybeMap(T,o)),I=[{value:T.length>0?T.join(",")||null:void 0}];else if(yt(c))I=c;else{var E=Object.keys(T);I=h?E.sort(h):E}for(var x=r&&yt(T)&&T.length===1?i+"[]":i,y=0;y<I.length;++y){var C=I[y],S=typeof C=="object"&&typeof C.value<"u"?C.value:T[C];if(!(a&&S===null)){var A=yt(T)?typeof s=="function"?s(x,C):x:x+(l?"."+C:"["+C+"]");_.set(e,d);var B=Ic();B.set(qr,_),Rc(R,t(S,A,s,r,n,a,s==="comma"&&m&&yt(T)?null:o,c,h,l,f,u,p,m,b,B))}}return R},ou=function(e){if(!e)return Ae;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var i=e.charset||Ae.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=qi.default;if(typeof e.format<"u"){if(!iu.call(qi.formatters,e.format))throw new TypeError("Unknown format option provided.");s=e.format}var r=qi.formatters[s],n=Ae.filter;return(typeof e.filter=="function"||yt(e.filter))&&(n=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ae.addQueryPrefix,allowDots:typeof e.allowDots>"u"?Ae.allowDots:!!e.allowDots,charset:i,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ae.charsetSentinel,delimiter:typeof e.delimiter>"u"?Ae.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ae.encode,encoder:typeof e.encoder=="function"?e.encoder:Ae.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ae.encodeValuesOnly,filter:n,format:s,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ae.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ae.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ae.strictNullHandling}},cu=function(t,e){var i=t,s=ou(e),r,n;typeof s.filter=="function"?(n=s.filter,i=n("",i)):yt(s.filter)&&(n=s.filter,r=n);var a=[];if(typeof i!="object"||i===null)return"";var o;e&&e.arrayFormat in lo?o=e.arrayFormat:e&&"indices"in e?o=e.indices?"indices":"repeat":o="indices";var c=lo[o];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=c==="comma"&&e&&e.commaRoundTrip;r||(r=Object.keys(i)),s.sort&&r.sort(s.sort);for(var l=Ic(),f=0;f<r.length;++f){var u=r[f];s.skipNulls&&i[u]===null||Rc(a,au(i[u],u,c,h,s.strictNullHandling,s.skipNulls,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}var p=a.join(s.delimiter),m=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),p.length>0?m+p:""},Ti=Pc,Fn=Object.prototype.hasOwnProperty,hu=Array.isArray,ve={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Ti.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},lu=function(t){return t.replace(/&#(\d+);/g,function(e,i){return String.fromCharCode(parseInt(i,10))})},Mc=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},fu="utf8=%26%2310003%3B",uu="utf8=%E2%9C%93",du=function(e,i){var s={__proto__:null},r=i.ignoreQueryPrefix?e.replace(/^\?/,""):e,n=i.parameterLimit===1/0?void 0:i.parameterLimit,a=r.split(i.delimiter,n),o=-1,c,h=i.charset;if(i.charsetSentinel)for(c=0;c<a.length;++c)a[c].indexOf("utf8=")===0&&(a[c]===uu?h="utf-8":a[c]===fu&&(h="iso-8859-1"),o=c,c=a.length);for(c=0;c<a.length;++c)if(c!==o){var l=a[c],f=l.indexOf("]="),u=f===-1?l.indexOf("="):f+1,p,m;u===-1?(p=i.decoder(l,ve.decoder,h,"key"),m=i.strictNullHandling?null:""):(p=i.decoder(l.slice(0,u),ve.decoder,h,"key"),m=Ti.maybeMap(Mc(l.slice(u+1),i),function(b){return i.decoder(b,ve.decoder,h,"value")})),m&&i.interpretNumericEntities&&h==="iso-8859-1"&&(m=lu(m)),l.indexOf("[]=")>-1&&(m=hu(m)?[m]:m),Fn.call(s,p)?s[p]=Ti.combine(s[p],m):s[p]=m}return s},pu=function(t,e,i,s){for(var r=s?e:Mc(e,i),n=t.length-1;n>=0;--n){var a,o=t[n];if(o==="[]"&&i.parseArrays)a=[].concat(r);else{a=i.plainObjects?Object.create(null):{};var c=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,h=parseInt(c,10);!i.parseArrays&&c===""?a={0:r}:!isNaN(h)&&o!==c&&String(h)===c&&h>=0&&i.parseArrays&&h<=i.arrayLimit?(a=[],a[h]=r):c!=="__proto__"&&(a[c]=r)}r=a}return r},mu=function(e,i,s,r){if(e){var n=s.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,c=s.depth>0&&a.exec(n),h=c?n.slice(0,c.index):n,l=[];if(h){if(!s.plainObjects&&Fn.call(Object.prototype,h)&&!s.allowPrototypes)return;l.push(h)}for(var f=0;s.depth>0&&(c=o.exec(n))!==null&&f<s.depth;){if(f+=1,!s.plainObjects&&Fn.call(Object.prototype,c[1].slice(1,-1))&&!s.allowPrototypes)return;l.push(c[1])}return c&&l.push("["+n.slice(c.index)+"]"),pu(l,i,s,r)}},gu=function(e){if(!e)return ve;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=typeof e.charset>"u"?ve.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?ve.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:ve.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:ve.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:ve.arrayLimit,charset:i,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ve.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:ve.comma,decoder:typeof e.decoder=="function"?e.decoder:ve.decoder,delimiter:typeof e.delimiter=="string"||Ti.isRegExp(e.delimiter)?e.delimiter:ve.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:ve.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:ve.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:ve.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:ve.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ve.strictNullHandling}},yu=function(t,e){var i=gu(e);if(t===""||t===null||typeof t>"u")return i.plainObjects?Object.create(null):{};for(var s=typeof t=="string"?du(t,i):t,r=i.plainObjects?Object.create(null):{},n=Object.keys(s),a=0;a<n.length;++a){var o=n[a],c=mu(o,s[o],i,typeof t=="string");r=Ti.merge(r,c,i)}return i.allowSparse===!0?r:Ti.compact(r)},_u=cu,vu=yu,bu=Ta,xu={formats:bu,parse:vu,stringify:_u},Eu=Sl;function Ze(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Tu=/^([a-z0-9.+-]+:)/i,wu=/:[0-9]*$/,Su=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Au=["<",">",'"',"`"," ","\r",`
`,"	"],Cu=["{","}","|","\\","^","`"].concat(Au),Ln=["'"].concat(Cu),uo=["%","/","?",";","#"].concat(Ln),po=["/","?","#"],Pu=255,mo=/^[+a-z0-9A-Z_-]{0,63}$/,Iu=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ru={javascript:!0,"javascript:":!0},Nn={javascript:!0,"javascript:":!0},gi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},kn=xu;function xr(t,e,i){if(t&&typeof t=="object"&&t instanceof Ze)return t;var s=new Ze;return s.parse(t,e,i),s}Ze.prototype.parse=function(t,e,i){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),r=s!==-1&&s<t.indexOf("#")?"?":"#",n=t.split(r),a=/\\/g;n[0]=n[0].replace(a,"/"),t=n.join(r);var o=t;if(o=o.trim(),!i&&t.split("#").length===1){var c=Su.exec(o);if(c)return this.path=o,this.href=o,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=kn.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=Tu.exec(o);if(h){h=h[0];var l=h.toLowerCase();this.protocol=l,o=o.substr(h.length)}if(i||h||o.match(/^\/\/[^@/]+@[^@/]+/)){var f=o.substr(0,2)==="//";f&&!(h&&Nn[h])&&(o=o.substr(2),this.slashes=!0)}if(!Nn[h]&&(f||h&&!gi[h])){for(var u=-1,p=0;p<po.length;p++){var m=o.indexOf(po[p]);m!==-1&&(u===-1||m<u)&&(u=m)}var b,_;u===-1?_=o.lastIndexOf("@"):_=o.lastIndexOf("@",u),_!==-1&&(b=o.slice(0,_),o=o.slice(_+1),this.auth=decodeURIComponent(b)),u=-1;for(var p=0;p<uo.length;p++){var m=o.indexOf(uo[p]);m!==-1&&(u===-1||m<u)&&(u=m)}u===-1&&(u=o.length),this.host=o.slice(0,u),o=o.slice(u),this.parseHost(),this.hostname=this.hostname||"";var T=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!T)for(var g=this.hostname.split(/\./),p=0,d=g.length;p<d;p++){var v=g[p];if(v&&!v.match(mo)){for(var w="",P=0,R=v.length;P<R;P++)v.charCodeAt(P)>127?w+="x":w+=v[P];if(!w.match(mo)){var I=g.slice(0,p),E=g.slice(p+1),x=v.match(Iu);x&&(I.push(x[1]),E.unshift(x[2])),E.length&&(o="/"+E.join(".")+o),this.hostname=I.join(".");break}}}this.hostname.length>Pu?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=Eu.toASCII(this.hostname));var y=this.port?":"+this.port:"",C=this.hostname||"";this.host=C+y,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),o[0]!=="/"&&(o="/"+o))}if(!Ru[l])for(var p=0,d=Ln.length;p<d;p++){var S=Ln[p];if(o.indexOf(S)!==-1){var A=encodeURIComponent(S);A===S&&(A=escape(S)),o=o.split(S).join(A)}}var B=o.indexOf("#");B!==-1&&(this.hash=o.substr(B),o=o.slice(0,B));var M=o.indexOf("?");if(M!==-1?(this.search=o.substr(M),this.query=o.substr(M+1),e&&(this.query=kn.parse(this.query)),o=o.slice(0,M)):e&&(this.search="",this.query={}),o&&(this.pathname=o),gi[l]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var y=this.pathname||"",O=this.search||"";this.path=y+O}return this.href=this.format(),this};function Mu(t){return typeof t=="string"&&(t=xr(t)),t instanceof Ze?t.format():Ze.prototype.format.call(t)}Ze.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",s=this.hash||"",r=!1,n="";this.host?r=t+this.host:this.hostname&&(r=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=kn.stringify(this.query));var a=this.search||n&&"?"+n||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||gi[e])&&r!==!1?(r="//"+(r||""),i&&i.charAt(0)!=="/"&&(i="/"+i)):r||(r=""),s&&s.charAt(0)!=="#"&&(s="#"+s),a&&a.charAt(0)!=="?"&&(a="?"+a),i=i.replace(/[?#]/g,function(o){return encodeURIComponent(o)}),a=a.replace("#","%23"),e+r+i+a+s};function Du(t,e){return xr(t,!1,!0).resolve(e)}Ze.prototype.resolve=function(t){return this.resolveObject(xr(t,!1,!0)).format()};Ze.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new Ze;e.parse(t,!1,!0),t=e}for(var i=new Ze,s=Object.keys(this),r=0;r<s.length;r++){var n=s[r];i[n]=this[n]}if(i.hash=t.hash,t.href==="")return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),o=0;o<a.length;o++){var c=a[o];c!=="protocol"&&(i[c]=t[c])}return gi[i.protocol]&&i.hostname&&!i.pathname&&(i.pathname="/",i.path=i.pathname),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!gi[t.protocol]){for(var h=Object.keys(t),l=0;l<h.length;l++){var f=h[l];i[f]=t[f]}return i.href=i.format(),i}if(i.protocol=t.protocol,!t.host&&!Nn[t.protocol]){for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),d[0]!==""&&d.unshift(""),d.length<2&&d.unshift(""),i.pathname=d.join("/")}else i.pathname=t.pathname;if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var u=i.pathname||"",p=i.search||"";i.path=u+p}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var m=i.pathname&&i.pathname.charAt(0)==="/",b=t.host||t.pathname&&t.pathname.charAt(0)==="/",_=b||m||i.host&&t.pathname,T=_,g=i.pathname&&i.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],v=i.protocol&&!gi[i.protocol];if(v&&(i.hostname="",i.port=null,i.host&&(g[0]===""?g[0]=i.host:g.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(d[0]===""?d[0]=t.host:d.unshift(t.host)),t.host=null),_=_&&(d[0]===""||g[0]==="")),b)i.host=t.host||t.host===""?t.host:i.host,i.hostname=t.hostname||t.hostname===""?t.hostname:i.hostname,i.search=t.search,i.query=t.query,g=d;else if(d.length)g||(g=[]),g.pop(),g=g.concat(d),i.search=t.search,i.query=t.query;else if(t.search!=null){if(v){i.host=g.shift(),i.hostname=i.host;var w=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;w&&(i.auth=w.shift(),i.hostname=w.shift(),i.host=i.hostname)}return i.search=t.search,i.query=t.query,(i.pathname!==null||i.search!==null)&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!g.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var P=g.slice(-1)[0],R=(i.host||t.host||g.length>1)&&(P==="."||P==="..")||P==="",I=0,E=g.length;E>=0;E--)P=g[E],P==="."?g.splice(E,1):P===".."?(g.splice(E,1),I++):I&&(g.splice(E,1),I--);if(!_&&!T)for(;I--;I)g.unshift("..");_&&g[0]!==""&&(!g[0]||g[0].charAt(0)!=="/")&&g.unshift(""),R&&g.join("/").substr(-1)!=="/"&&g.push("");var x=g[0]===""||g[0]&&g[0].charAt(0)==="/";if(v){i.hostname=x?"":g.length?g.shift():"",i.host=i.hostname;var w=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;w&&(i.auth=w.shift(),i.hostname=w.shift(),i.host=i.hostname)}return _=_||i.host&&g.length,_&&!x&&g.unshift(""),g.length>0?i.pathname=g.join("/"):(i.pathname=null,i.path=null),(i.pathname!==null||i.search!==null)&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i};Ze.prototype.parseHost=function(){var t=this.host,e=wu.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var Bu=xr,Ou=Du,Fu=Mu;const Lu={parse:Bu,format:Fu,resolve:Ou};function He(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Fi(t){return t.split("?")[0].split("#")[0]}function Nu(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ku(t,e,i){return t.replace(new RegExp(Nu(e),"g"),i)}function Uu(t,e){let i="",s=0,r=-1,n=0,a=-1;for(let o=0;o<=t.length;++o){if(o<t.length)a=t.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(r===o-1||n===1))if(r!==o-1&&n===2){if(i.length<2||s!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){const c=i.lastIndexOf("/");if(c!==i.length-1){c===-1?(i="",s=0):(i=i.slice(0,c),s=i.length-1-i.lastIndexOf("/")),r=o,n=0;continue}}else if(i.length===2||i.length===1){i="",s=0,r=o,n=0;continue}}e&&(i.length>0?i+="/..":i="..",s=2)}else i.length>0?i+=`/${t.slice(r+1,o)}`:i=t.slice(r+1,o),s=o-r-1;r=o,n=0}else a===46&&n!==-1?++n:n=-1}return i}const Ie={toPosix(t){return ku(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},hasProtocol(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol(t){He(t),t=this.toPosix(t);let e="";const i=/^file:\/\/\//.exec(t),s=/^[^/:]+:\/\//.exec(t),r=/^[^/:]+:\//.exec(t);if(i||s||r){const n=(i==null?void 0:i[0])||(s==null?void 0:s[0])||(r==null?void 0:r[0]);e=n,t=t.slice(n.length)}return e},toAbsolute(t,e,i){if(this.isDataUrl(t))return t;const s=Fi(this.toPosix(e??L.ADAPTER.getBaseUrl())),r=Fi(this.toPosix(i??this.rootname(s)));return He(t),t=this.toPosix(t),t.startsWith("/")?Ie.join(r,t.slice(1)):this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if(t=this.toPosix(t),He(t),t.length===0)return".";let e="";const i=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return t=Uu(t,!1),t.length>0&&s&&(t+="/"),i?`/${t}`:e+t},isAbsolute(t){return He(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let i=0;i<t.length;++i){const s=t[i];if(He(s),s.length>0)if(e===void 0)e=s;else{const r=t[i-1]??"";this.extname(r)?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(He(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const i=e===47;let s=-1,r=!0;const n=this.getProtocol(t),a=t;t=t.slice(n.length);for(let o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),e===47){if(!r){s=o;break}}else r=!1;return s===-1?i?"/":this.isUrl(a)?n+t:n:i&&s===1?"//":n+t.slice(0,s)},rootname(t){He(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const i=t.indexOf("/",e.length);i!==-1?e=t.slice(0,i):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){He(t),e&&He(e),t=Fi(this.toPosix(t));let i=0,s=-1,r=!0,n;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let a=e.length-1,o=-1;for(n=t.length-1;n>=0;--n){const c=t.charCodeAt(n);if(c===47){if(!r){i=n+1;break}}else o===-1&&(r=!1,o=n+1),a>=0&&(c===e.charCodeAt(a)?--a===-1&&(s=n):(a=-1,s=o))}return i===s?s=o:s===-1&&(s=t.length),t.slice(i,s)}for(n=t.length-1;n>=0;--n)if(t.charCodeAt(n)===47){if(!r){i=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":t.slice(i,s)},extname(t){He(t),t=Fi(this.toPosix(t));let e=-1,i=0,s=-1,r=!0,n=0;for(let a=t.length-1;a>=0;--a){const o=t.charCodeAt(a);if(o===47){if(!r){i=a+1;break}continue}s===-1&&(r=!1,s=a+1),o===46?e===-1?e=a:n!==1&&(n=1):e!==-1&&(n=-1)}return e===-1||s===-1||n===0||n===1&&e===s-1&&e===i+1?"":t.slice(e,s)},parse(t){He(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Fi(this.toPosix(t));let i=t.charCodeAt(0);const s=this.isAbsolute(t);let r;e.root=this.rootname(t),s||this.hasProtocol(t)?r=1:r=0;let n=-1,a=0,o=-1,c=!0,h=t.length-1,l=0;for(;h>=r;--h){if(i=t.charCodeAt(h),i===47){if(!c){a=h+1;break}continue}o===-1&&(c=!1,o=h+1),i===46?n===-1?n=h:l!==1&&(l=1):n!==-1&&(l=-1)}return n===-1||o===-1||l===0||l===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&s?e.base=e.name=t.slice(1,o):e.base=e.name=t.slice(a,o)):(a===0&&s?(e.name=t.slice(1,n),e.base=t.slice(1,o)):(e.name=t.slice(a,n),e.base=t.slice(a,o)),e.ext=t.slice(n,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"},go={};function te(t,e,i=3){if(go[e])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(s=s.split(`
`).splice(i).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(s))),go[e]=!0}let Kr;function Gu(){return typeof Kr>"u"&&(Kr=function(){var i;const e={stencil:!0,failIfMajorPerformanceCaveat:L.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!L.ADAPTER.getWebGLRenderingContext())return!1;const s=L.ADAPTER.createCanvas();let r=s.getContext("webgl",e)||s.getContext("experimental-webgl",e);const n=!!((i=r==null?void 0:r.getContextAttributes())!=null&&i.stencil);if(r){const a=r.getExtension("WEBGL_lose_context");a&&a.loseContext()}return r=null,n}catch{return!1}}()),Kr}var Hu={grad:.9,turn:360,rad:360/(2*Math.PI)},mt=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},xe=function(t,e,i){return e===void 0&&(e=0),i===void 0&&(i=Math.pow(10,e)),Math.round(i*t)/i+0},Ue=function(t,e,i){return e===void 0&&(e=0),i===void 0&&(i=1),t>i?i:t>e?t:e},Dc=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},yo=function(t){return{r:Ue(t.r,0,255),g:Ue(t.g,0,255),b:Ue(t.b,0,255),a:Ue(t.a)}},Zr=function(t){return{r:xe(t.r),g:xe(t.g),b:xe(t.b),a:xe(t.a,3)}},Xu=/^#([0-9a-f]{3,8})$/i,Ts=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Bc=function(t){var e=t.r,i=t.g,s=t.b,r=t.a,n=Math.max(e,i,s),a=n-Math.min(e,i,s),o=a?n===e?(i-s)/a:n===i?2+(s-e)/a:4+(e-i)/a:0;return{h:60*(o<0?o+6:o),s:n?a/n*100:0,v:n/255*100,a:r}},Oc=function(t){var e=t.h,i=t.s,s=t.v,r=t.a;e=e/360*6,i/=100,s/=100;var n=Math.floor(e),a=s*(1-i),o=s*(1-(e-n)*i),c=s*(1-(1-e+n)*i),h=n%6;return{r:255*[s,o,a,a,c,s][h],g:255*[c,s,s,o,a,a][h],b:255*[a,a,c,s,s,o][h],a:r}},_o=function(t){return{h:Dc(t.h),s:Ue(t.s,0,100),l:Ue(t.l,0,100),a:Ue(t.a)}},vo=function(t){return{h:xe(t.h),s:xe(t.s),l:xe(t.l),a:xe(t.a,3)}},bo=function(t){return Oc((i=(e=t).s,{h:e.h,s:(i*=((s=e.l)<50?s:100-s)/100)>0?2*i/(s+i)*100:0,v:s+i,a:e.a}));var e,i,s},Ki=function(t){return{h:(e=Bc(t)).h,s:(r=(200-(i=e.s))*(s=e.v)/100)>0&&r<200?i*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,i,s,r},$u=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Vu=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,zu=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Wu=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Un={string:[[function(t){var e=Xu.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?xe(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?xe(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=zu.exec(t)||Wu.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:yo({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=$u.exec(t)||Vu.exec(t);if(!e)return null;var i,s,r=_o({h:(i=e[1],s=e[2],s===void 0&&(s="deg"),Number(i)*(Hu[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return bo(r)},"hsl"]],object:[[function(t){var e=t.r,i=t.g,s=t.b,r=t.a,n=r===void 0?1:r;return mt(e)&&mt(i)&&mt(s)?yo({r:Number(e),g:Number(i),b:Number(s),a:Number(n)}):null},"rgb"],[function(t){var e=t.h,i=t.s,s=t.l,r=t.a,n=r===void 0?1:r;if(!mt(e)||!mt(i)||!mt(s))return null;var a=_o({h:Number(e),s:Number(i),l:Number(s),a:Number(n)});return bo(a)},"hsl"],[function(t){var e=t.h,i=t.s,s=t.v,r=t.a,n=r===void 0?1:r;if(!mt(e)||!mt(i)||!mt(s))return null;var a=function(o){return{h:Dc(o.h),s:Ue(o.s,0,100),v:Ue(o.v,0,100),a:Ue(o.a)}}({h:Number(e),s:Number(i),v:Number(s),a:Number(n)});return Oc(a)},"hsv"]]},xo=function(t,e){for(var i=0;i<e.length;i++){var s=e[i][0](t);if(s)return[s,e[i][1]]}return[null,void 0]},ju=function(t){return typeof t=="string"?xo(t.trim(),Un.string):typeof t=="object"&&t!==null?xo(t,Un.object):[null,void 0]},Jr=function(t,e){var i=Ki(t);return{h:i.h,s:Ue(i.s+100*e,0,100),l:i.l,a:i.a}},Qr=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Eo=function(t,e){var i=Ki(t);return{h:i.h,s:i.s,l:Ue(i.l+100*e,0,100),a:i.a}},Gn=function(){function t(e){this.parsed=ju(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return xe(Qr(this.rgba),2)},t.prototype.isDark=function(){return Qr(this.rgba)<.5},t.prototype.isLight=function(){return Qr(this.rgba)>=.5},t.prototype.toHex=function(){return e=Zr(this.rgba),i=e.r,s=e.g,r=e.b,a=(n=e.a)<1?Ts(xe(255*n)):"","#"+Ts(i)+Ts(s)+Ts(r)+a;var e,i,s,r,n,a},t.prototype.toRgb=function(){return Zr(this.rgba)},t.prototype.toRgbString=function(){return e=Zr(this.rgba),i=e.r,s=e.g,r=e.b,(n=e.a)<1?"rgba("+i+", "+s+", "+r+", "+n+")":"rgb("+i+", "+s+", "+r+")";var e,i,s,r,n},t.prototype.toHsl=function(){return vo(Ki(this.rgba))},t.prototype.toHslString=function(){return e=vo(Ki(this.rgba)),i=e.h,s=e.s,r=e.l,(n=e.a)<1?"hsla("+i+", "+s+"%, "+r+"%, "+n+")":"hsl("+i+", "+s+"%, "+r+"%)";var e,i,s,r,n},t.prototype.toHsv=function(){return e=Bc(this.rgba),{h:xe(e.h),s:xe(e.s),v:xe(e.v),a:xe(e.a,3)};var e},t.prototype.invert=function(){return rt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),rt(Jr(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),rt(Jr(this.rgba,-e))},t.prototype.grayscale=function(){return rt(Jr(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),rt(Eo(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),rt(Eo(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?rt({r:(i=this.rgba).r,g:i.g,b:i.b,a:e}):xe(this.rgba.a,3);var i},t.prototype.hue=function(e){var i=Ki(this.rgba);return typeof e=="number"?rt({h:e,s:i.s,l:i.l,a:i.a}):xe(i.h)},t.prototype.isEqual=function(e){return this.toHex()===rt(e).toHex()},t}(),rt=function(t){return t instanceof Gn?t:new Gn(t)},To=[],Yu=function(t){t.forEach(function(e){To.indexOf(e)<0&&(e(Gn,Un),To.push(e))})};function qu(t,e){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in i)s[i[r]]=r;var n={};t.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,c,h=s[this.toHex()];if(h)return h;if(a!=null&&a.closest){var l=this.toRgb(),f=1/0,u="black";if(!n.length)for(var p in i)n[p]=new t(i[p]).toRgb();for(var m in i){var b=(o=l,c=n[m],Math.pow(o.r-c.r,2)+Math.pow(o.g-c.g,2)+Math.pow(o.b-c.b,2));b<f&&(f=b,u=m)}return u}},e.string.push([function(a){var o=a.toLowerCase(),c=o==="transparent"?"#0000":i[o];return c?new t(c).toRgb():null},"name"])}Yu([qu]);const yi=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof yi)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,n)=>r===e[n]);if(t!==null&&e!==null){const r=Object.keys(t),n=Object.keys(e);return r.length!==n.length?!1:r.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,i,s]=this._components;return{r:t,g:e,b:i,a:s}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,s]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(s*255),t}toRgbArray(t){t=t??[];const[e,i,s]=this._components;return t[0]=e,t[1]=i,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,s,r]=yi.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=s,this._components[3]*=r,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,r=this._int&255;return e&&(i=i*t+.5|0,s=s*t+.5|0,r=r*t+.5|0),(t*255<<24)+(i<<16)+(s<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,i,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,i,s,r]=this._components;return t[0]=e,t[1]=i,t[2]=s,t[3]=r,t}normalize(t){let e,i,s,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const n=t;e=(n>>16&255)/255,i=(n>>8&255)/255,s=(n&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,s,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,s,r=255]=t,e/=255,i/=255,s/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=yi.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const n=rt(t);n.isValid()&&({r:e,g:i,b:s,a:r}=n.rgba,e/=255,i/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=s,this._components[3]=r,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((s,r)=>{t[r]=Math.min(Math.max(s,e),i)}),t)}};let ne=yi;ne.shared=new yi;ne.temp=new yi;ne.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function Ku(t){return te("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),ne.shared.setValue(t).toHex()}function Zu(t){return te("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),ne.shared.setValue(t).toNumber()}function Ju(){const t=[],e=[];for(let s=0;s<32;s++)t[s]=s,e[s]=s;t[Y.NORMAL_NPM]=Y.NORMAL,t[Y.ADD_NPM]=Y.ADD,t[Y.SCREEN_NPM]=Y.SCREEN,e[Y.NORMAL]=Y.NORMAL_NPM,e[Y.ADD]=Y.ADD_NPM,e[Y.SCREEN]=Y.SCREEN_NPM;const i=[];return i.push(e),i.push(t),i}const Fc=Ju();function Lc(t,e){return Fc[e?1:0][t]}function Qu(t,e=null){const i=t*6;if(e=e||new Uint16Array(i),e.length!==i)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${i}`);for(let s=0,r=0;s<i;s+=6,r+=4)e[s+0]=r+0,e[s+1]=r+1,e[s+2]=r+2,e[s+3]=r+0,e[s+4]=r+2,e[s+5]=r+3;return e}function Nc(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function ar(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function wo(t){return!(t&t-1)&&!!t}function So(t){let e=(t>65535?1:0)<<4;t>>>=e;let i=(t>255?1:0)<<3;return t>>>=i,e|=i,i=(t>15?1:0)<<2,t>>>=i,e|=i,i=(t>3?1:0)<<1,t>>>=i,e|=i,e|t>>1}function _i(t,e,i){const s=t.length;let r;if(e>=s||i===0)return;i=e+i>s?s-e:i;const n=s-i;for(r=e;r<n;++r)t[r]=t[r+i];t.length=n}function Pt(t){return t===0?0:t<0?-1:1}let ed=0;function qt(){return++ed}const kc=class{constructor(t,e,i,s){this.left=t,this.top=e,this.right=i,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Hn=kc;Hn.EMPTY=new kc(0,0,0,0);const Ao={},nt=Object.create(null),wt=Object.create(null);class td{constructor(e,i,s){this._canvas=L.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=s||L.RESOLUTION,this.resize(e,i)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,i){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(i*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Co(t,e,i){for(let s=0,r=4*i*e;s<e;++s,r+=4)if(t[r+3]!==0)return!1;return!0}function Po(t,e,i,s,r){const n=4*e;for(let a=s,o=s*n+4*i;a<=r;++a,o+=n)if(t[o+3]!==0)return!1;return!0}function id(t){const{width:e,height:i}=t,s=t.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const n=s.getImageData(0,0,e,i).data;let a=0,o=0,c=e-1,h=i-1;for(;o<i&&Co(n,e,o);)++o;if(o===i)return Hn.EMPTY;for(;Co(n,e,h);)--h;for(;Po(n,e,a,o,h);)++a;for(;Po(n,e,c,o,h);)--c;return++c,++h,new Hn(a,o,c,h)}function sd(t){const e=id(t),{width:i,height:s}=e;let r=null;if(!e.isEmpty()){const n=t.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");r=n.getImageData(e.left,e.top,i,s)}return{width:i,height:s,data:r}}let ws;function rd(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,ws||(ws=document.createElement("a")),ws.href=t;const i=Lu.parse(ws.href),s=!i.port&&e.port===""||i.port===e.port;return i.hostname!==e.hostname||!s||i.protocol!==e.protocol?"anonymous":""}function Mt(t,e=1){var s;const i=(s=L.RETINA_PREFIX)==null?void 0:s.exec(t);return i?parseFloat(i[1]):e}var N=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(N||{});const Xn=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Io=(t,e)=>Xn(t).priority??e,V={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Xn).forEach(e=>{e.type.forEach(i=>{var s,r;return(r=(s=this._removeHandlers)[i])==null?void 0:r.call(s,e)})}),this},add(...t){return t.map(Xn).forEach(e=>{e.type.forEach(i=>{const s=this._addHandlers,r=this._queue;s[i]?s[i](e):(r[i]=r[i]||[],r[i].push(e))})}),this},handle(t,e,i){const s=this._addHandlers,r=this._removeHandlers;if(s[t]||r[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,r[t]=i;const n=this._queue;return n[t]&&(n[t].forEach(a=>e(a)),delete n[t]),this},handleByMap(t,e){return this.handle(t,i=>{e[i.name]=i.ref},i=>{delete e[i.name]})},handleByList(t,e,i=-1){return this.handle(t,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((r,n)=>Io(n,i)-Io(r,i)))},s=>{const r=e.indexOf(s.ref);r!==-1&&e.splice(r,1)})}};class $n{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const nd=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ad(t){let e="";for(let i=0;i<t;++i)i>0&&(e+=`
else `),i<t-1&&(e+=`if(test == ${i}.0){}`);return e}function od(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=e.createShader(e.FRAGMENT_SHADER);for(;;){const s=nd.replace(/%forloop%/gi,ad(t));if(e.shaderSource(i,s),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))t=t/2|0;else break}return t}const en=0,tn=1,sn=2,rn=3,nn=4,an=5;class xt{constructor(){this.data=0,this.blendMode=Y.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<en)}set blend(e){!!(this.data&1<<en)!==e&&(this.data^=1<<en)}get offsets(){return!!(this.data&1<<tn)}set offsets(e){!!(this.data&1<<tn)!==e&&(this.data^=1<<tn)}get culling(){return!!(this.data&1<<sn)}set culling(e){!!(this.data&1<<sn)!==e&&(this.data^=1<<sn)}get depthTest(){return!!(this.data&1<<rn)}set depthTest(e){!!(this.data&1<<rn)!==e&&(this.data^=1<<rn)}get depthMask(){return!!(this.data&1<<an)}set depthMask(e){!!(this.data&1<<an)!==e&&(this.data^=1<<an)}get clockwiseFrontFace(){return!!(this.data&1<<nn)}set clockwiseFrontFace(e){!!(this.data&1<<nn)!==e&&(this.data^=1<<nn)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==Y.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new xt;return e.depthTest=!1,e.blend=!0,e}}const Vn=[];function Uc(t,e){if(!t)return null;let i="";if(typeof t=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);s&&(i=s[1].toLowerCase())}for(let s=Vn.length-1;s>=0;--s){const r=Vn[s];if(r.test&&r.test(t,i))return new r(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Je{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,i,s,r,n,a,o,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:l}=this;this._aliasCount++;for(let f=0,u=l.length;f<u;f++)l[f][h](e,i,s,r,n,a,o,c);return l===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const i=this.items.indexOf(e);return i!==-1&&(this.ensureNonAliasedItems(),this.items.splice(i,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Je.prototype,{dispatch:{value:Je.prototype.emit},run:{value:Je.prototype.emit}});class ss{constructor(e=0,i=0){this._width=e,this._height=i,this.destroyed=!1,this.internal=!1,this.onResize=new Je("setRealSize"),this.onUpdate=new Je("update"),this.onError=new Je("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,i){(e!==this._width||i!==this._height)&&(this._width=e,this._height=i,this.onResize.emit(e,i))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,i,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,i){return!1}}class cs extends ss{constructor(e,i){const{width:s,height:r}=i||{};if(!s||!r)throw new Error("BufferResource width or height invalid");super(s,r),this.data=e}upload(e,i,s){const r=e.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===et.UNPACK);const n=i.realWidth,a=i.realHeight;return s.width===n&&s.height===a?r.texSubImage2D(i.target,0,0,0,n,a,i.format,s.type,this.data):(s.width=n,s.height=a,r.texImage2D(i.target,0,s.internalFormat,n,a,0,i.format,s.type,this.data)),!0}dispose(){this.data=null}static test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array}}const cd={scaleMode:De.NEAREST,format:F.RGBA,alphaMode:et.NPM},oi=class extends as{constructor(t=null,e=null){super(),e=Object.assign({},oi.defaultOptions,e);const{alphaMode:i,mipmap:s,anisotropicLevel:r,scaleMode:n,width:a,height:o,wrapMode:c,format:h,type:l,target:f,resolution:u,resourceOptions:p}=e;t&&!(t instanceof ss)&&(t=Uc(t,p),t.internal=!0),this.resolution=u||L.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((o||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=r,this._wrapMode=c,this._scaleMode=n,this.format=h,this.type=l,this.target=f,this.alphaMode=i,this.uid=qt(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&o>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=wo(this.realWidth)&&wo(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete wt[this.cacheId],delete nt[this.cacheId],this.cacheId=null),this.dispose(),oi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=L.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let r=null;if(s)r=t;else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${qt()}`}r=t._pixiId}let n=wt[r];if(s&&i&&!n)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return n||(n=new oi(t,e),n.cacheId=r,oi.addToCache(n,r)),n}static fromBuffer(t,e,i,s){t=t||new Float32Array(e*i*4);const r=new cs(t,{width:e,height:i}),n=t instanceof Float32Array?z.FLOAT:z.UNSIGNED_BYTE;return new oi(r,Object.assign({},cd,{type:n},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),wt[e]&&wt[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),wt[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=wt[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete wt[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete wt[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};let q=oi;q.defaultOptions={mipmap:ut.POW2,anisotropicLevel:0,scaleMode:De.LINEAR,wrapMode:Rt.CLAMP,alphaMode:et.UNPACK,target:pi.TEXTURE_2D,format:F.RGBA,type:z.UNSIGNED_BYTE};q._globalBatch=0;class zn{constructor(){this.texArray=null,this.blend=0,this.type=ct.TRIANGLES,this.start=0,this.size=0,this.data=null}}let hd=0;class de{constructor(e,i=!0,s=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=i,this.id=hd++,this.disposeRunner=new Je("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?ht.ELEMENT_ARRAY_BUFFER:ht.ARRAY_BUFFER}get index(){return this.type===ht.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new de(e)}}class or{constructor(e,i=0,s=!1,r=z.FLOAT,n,a,o,c=1){this.buffer=e,this.size=i,this.normalized=s,this.type=r,this.stride=n,this.start=a,this.instance=o,this.divisor=c}destroy(){this.buffer=null}static from(e,i,s,r,n){return new or(e,i,s,r,n)}}const ld={Float32Array,Uint32Array,Int32Array,Uint8Array};function fd(t,e){let i=0,s=0;const r={};for(let c=0;c<t.length;c++)s+=e[c],i+=t[c].length;const n=new ArrayBuffer(i*4);let a=null,o=0;for(let c=0;c<t.length;c++){const h=e[c],l=t[c],f=Nc(l);r[f]||(r[f]=new ld[f](n)),a=r[f];for(let u=0;u<l.length;u++){const p=(u/h|0)*s+o,m=u%h;a[p+m]=l[u]}o+=h}return new Float32Array(n)}const Ro={5126:4,5123:2,5121:1};let ud=0;const dd={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Dt{constructor(e=[],i={}){this.buffers=e,this.indexBuffer=null,this.attributes=i,this.glVertexArrayObjects={},this.id=ud++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Je("disposeGeometry"),this.refCount=0}addAttribute(e,i,s=0,r=!1,n,a,o,c=!1){if(!i)throw new Error("You must pass a buffer when creating an attribute");i instanceof de||(i instanceof Array&&(i=new Float32Array(i)),i=new de(i));const h=e.split("|");if(h.length>1){for(let f=0;f<h.length;f++)this.addAttribute(h[f],i,s,r,n);return this}let l=this.buffers.indexOf(i);return l===-1&&(this.buffers.push(i),l=this.buffers.length-1),this.attributes[e]=new or(l,s,r,n,a,o,c),this.instanced=this.instanced||c,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof de||(e instanceof Array&&(e=new Uint16Array(e)),e=new de(e)),e.type=ht.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],i=[],s=new de;let r;for(r in this.attributes){const n=this.attributes[r],a=this.buffers[n.buffer];e.push(a.data),i.push(n.size*Ro[n.type]/4),n.buffer=0}for(s.data=fd(e,i),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const i=this.attributes[e];return this.buffers[i.buffer].data.length/(i.stride/4||i.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Dt;for(let i=0;i<this.buffers.length;i++)e.buffers[i]=new de(this.buffers[i].data.slice(0));for(const i in this.attributes){const s=this.attributes[i];e.attributes[i]=new or(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=ht.ELEMENT_ARRAY_BUFFER),e}static merge(e){const i=new Dt,s=[],r=[],n=[];let a;for(let o=0;o<e.length;o++){a=e[o];for(let c=0;c<a.buffers.length;c++)r[c]=r[c]||0,r[c]+=a.buffers[c].data.length,n[c]=0}for(let o=0;o<a.buffers.length;o++)s[o]=new dd[Nc(a.buffers[o].data)](r[o]),i.buffers[o]=new de(s[o]);for(let o=0;o<e.length;o++){a=e[o];for(let c=0;c<a.buffers.length;c++)s[c].set(a.buffers[c].data,n[c]),n[c]+=a.buffers[c].data.length}if(i.attributes=a.attributes,a.indexBuffer){i.indexBuffer=i.buffers[a.buffers.indexOf(a.indexBuffer)],i.indexBuffer.type=ht.ELEMENT_ARRAY_BUFFER;let o=0,c=0,h=0,l=0;for(let f=0;f<a.buffers.length;f++)if(a.buffers[f]!==a.indexBuffer){l=f;break}for(const f in a.attributes){const u=a.attributes[f];(u.buffer|0)===l&&(c+=u.size*Ro[u.type]/4)}for(let f=0;f<e.length;f++){const u=e[f].indexBuffer.data;for(let p=0;p<u.length;p++)i.indexBuffer.data[p+h]+=o;o+=e[f].buffers[l].data.length/c,h+=u.length}}return i}}class Gc extends Dt{constructor(e=!1){super(),this._buffer=new de(null,e,!1),this._indexBuffer=new de(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,z.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,z.FLOAT).addAttribute("aColor",this._buffer,4,!0,z.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,z.FLOAT).addIndex(this._indexBuffer)}}const cr=Math.PI*2,pd=180/Math.PI,md=Math.PI/180;var we=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(we||{});let ie=class Hc{constructor(e=0,i=0){this.x=0,this.y=0,this.x=e,this.y=i}clone(){return new Hc(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,i=e){return this.x=e,this.y=i,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};const Ss=[new ie,new ie,new ie,new ie];class K{constructor(e=0,i=0,s=0,r=0){this.x=Number(e),this.y=Number(i),this.width=Number(s),this.height=Number(r),this.type=we.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new K(0,0,0,0)}clone(){return new K(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,i){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height}intersects(e,i){if(!i){const I=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=I)return!1;const x=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>x}const s=this.left,r=this.right,n=this.top,a=this.bottom;if(r<=s||a<=n)return!1;const o=Ss[0].set(e.left,e.top),c=Ss[1].set(e.left,e.bottom),h=Ss[2].set(e.right,e.top),l=Ss[3].set(e.right,e.bottom);if(h.x<=o.x||c.y<=o.y)return!1;const f=Math.sign(i.a*i.d-i.b*i.c);if(f===0||(i.apply(o,o),i.apply(c,c),i.apply(h,h),i.apply(l,l),Math.max(o.x,c.x,h.x,l.x)<=s||Math.min(o.x,c.x,h.x,l.x)>=r||Math.max(o.y,c.y,h.y,l.y)<=n||Math.min(o.y,c.y,h.y,l.y)>=a))return!1;const u=f*(c.y-o.y),p=f*(o.x-c.x),m=u*s+p*n,b=u*r+p*n,_=u*s+p*a,T=u*r+p*a;if(Math.max(m,b,_,T)<=u*o.x+p*o.y||Math.min(m,b,_,T)>=u*l.x+p*l.y)return!1;const g=f*(o.y-h.y),d=f*(h.x-o.x),v=g*s+d*n,w=g*r+d*n,P=g*s+d*a,R=g*r+d*a;return!(Math.max(v,w,P,R)<=g*o.x+d*o.y||Math.min(v,w,P,R)>=g*l.x+d*l.y)}pad(e=0,i=e){return this.x-=e,this.y-=i,this.width+=e*2,this.height+=i*2,this}fit(e){const i=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),n=Math.min(this.y+this.height,e.y+e.height);return this.x=i,this.width=Math.max(s-i,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(e=1,i=.001){const s=Math.ceil((this.x+this.width-i)*e)/e,r=Math.ceil((this.y+this.height-i)*e)/e;return this.x=Math.floor((this.x+i)*e)/e,this.y=Math.floor((this.y+i)*e)/e,this.width=s-this.x,this.height=r-this.y,this}enlarge(e){const i=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),n=Math.max(this.y+this.height,e.y+e.height);return this.x=i,this.width=s-i,this.y=r,this.height=n-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}let gd=class Xc{constructor(e=0,i=0,s=0){this.x=e,this.y=i,this.radius=s,this.type=we.CIRC}clone(){return new Xc(this.x,this.y,this.radius)}contains(e,i){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-e,n=this.y-i;return r*=r,n*=n,r+n<=s}getBounds(){return new K(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}},yd=class $c{constructor(e=0,i=0,s=0,r=0){this.x=e,this.y=i,this.width=s,this.height=r,this.type=we.ELIP}clone(){return new $c(this.x,this.y,this.width,this.height)}contains(e,i){if(this.width<=0||this.height<=0)return!1;let s=(e-this.x)/this.width,r=(i-this.y)/this.height;return s*=s,r*=r,s+r<=1}getBounds(){return new K(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};class vi{constructor(...e){let i=Array.isArray(e[0])?e[0]:e;if(typeof i[0]!="number"){const s=[];for(let r=0,n=i.length;r<n;r++)s.push(i[r].x,i[r].y);i=s}this.points=i,this.type=we.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),i=new vi(e);return i.closeStroke=this.closeStroke,i}contains(e,i){let s=!1;const r=this.points.length/2;for(let n=0,a=r-1;n<r;a=n++){const o=this.points[n*2],c=this.points[n*2+1],h=this.points[a*2],l=this.points[a*2+1];c>i!=l>i&&e<(h-o)*((i-c)/(l-c))+o&&(s=!s)}return s}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,i)=>`${e}, ${i}`,"")}]`}}class wa{constructor(e=0,i=0,s=0,r=0,n=20){this.x=e,this.y=i,this.width=s,this.height=r,this.radius=n,this.type=we.RREC}clone(){return new wa(this.x,this.y,this.width,this.height,this.radius)}contains(e,i){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(i>=this.y+s&&i<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let r=e-(this.x+s),n=i-(this.y+s);const a=s*s;if(r*r+n*n<=a||(r=e-(this.x+this.width-s),r*r+n*n<=a)||(n=i-(this.y+this.height-s),r*r+n*n<=a)||(r=e-(this.x+s),r*r+n*n<=a))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class ce{constructor(e=1,i=0,s=0,r=1,n=0,a=0){this.array=null,this.a=e,this.b=i,this.c=s,this.d=r,this.tx=n,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,i,s,r,n,a){return this.a=e,this.b=i,this.c=s,this.d=r,this.tx=n,this.ty=a,this}toArray(e,i){this.array||(this.array=new Float32Array(9));const s=i||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,i){i=i||new ie;const s=e.x,r=e.y;return i.x=this.a*s+this.c*r+this.tx,i.y=this.b*s+this.d*r+this.ty,i}applyInverse(e,i){i=i||new ie;const s=1/(this.a*this.d+this.c*-this.b),r=e.x,n=e.y;return i.x=this.d*s*r+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,i.y=this.a*s*n+-this.b*s*r+(-this.ty*this.a+this.tx*this.b)*s,i}translate(e,i){return this.tx+=e,this.ty+=i,this}scale(e,i){return this.a*=e,this.d*=i,this.c*=e,this.b*=i,this.tx*=e,this.ty*=i,this}rotate(e){const i=Math.cos(e),s=Math.sin(e),r=this.a,n=this.c,a=this.tx;return this.a=r*i-this.b*s,this.b=r*s+this.b*i,this.c=n*i-this.d*s,this.d=n*s+this.d*i,this.tx=a*i-this.ty*s,this.ty=a*s+this.ty*i,this}append(e){const i=this.a,s=this.b,r=this.c,n=this.d;return this.a=e.a*i+e.b*r,this.b=e.a*s+e.b*n,this.c=e.c*i+e.d*r,this.d=e.c*s+e.d*n,this.tx=e.tx*i+e.ty*r+this.tx,this.ty=e.tx*s+e.ty*n+this.ty,this}setTransform(e,i,s,r,n,a,o,c,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-c)*a,this.d=Math.cos(o-c)*a,this.tx=e-(s*this.a+r*this.c),this.ty=i-(s*this.b+r*this.d),this}prepend(e){const i=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,r=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=i*e.a+this.ty*e.c+e.tx,this.ty=i*e.b+this.ty*e.d+e.ty,this}decompose(e){const i=this.a,s=this.b,r=this.c,n=this.d,a=e.pivot,o=-Math.atan2(-r,n),c=Math.atan2(s,i),h=Math.abs(o+c);return h<1e-5||Math.abs(cr-h)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=c),e.scale.x=Math.sqrt(i*i+s*s),e.scale.y=Math.sqrt(r*r+n*n),e.position.x=this.tx+(a.x*i+a.y*r),e.position.y=this.ty+(a.x*s+a.y*n),e}invert(){const e=this.a,i=this.b,s=this.c,r=this.d,n=this.tx,a=e*r-i*s;return this.a=r/a,this.b=-i/a,this.c=-s/a,this.d=e/a,this.tx=(s*this.ty-r*n)/a,this.ty=-(e*this.ty-i*n)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ce;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new ce}static get TEMP_MATRIX(){return new ce}}const kt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ut=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Gt=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ht=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Wn=[],Vc=[],As=Math.sign;function _d(){for(let t=0;t<16;t++){const e=[];Wn.push(e);for(let i=0;i<16;i++){const s=As(kt[t]*kt[i]+Gt[t]*Ut[i]),r=As(Ut[t]*kt[i]+Ht[t]*Ut[i]),n=As(kt[t]*Gt[i]+Gt[t]*Ht[i]),a=As(Ut[t]*Gt[i]+Ht[t]*Ht[i]);for(let o=0;o<16;o++)if(kt[o]===s&&Ut[o]===r&&Gt[o]===n&&Ht[o]===a){e.push(o);break}}}for(let t=0;t<16;t++){const e=new ce;e.set(kt[t],Ut[t],Gt[t],Ht[t],0,0),Vc.push(e)}}_d();const he={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>kt[t],uY:t=>Ut[t],vX:t=>Gt[t],vY:t=>Ht[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Wn[t][e],sub:(t,e)=>Wn[t][he.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?he.S:he.N:Math.abs(e)*2<=Math.abs(t)?t>0?he.E:he.W:e>0?t>0?he.SE:he.SW:t>0?he.NE:he.NW,matrixAppendRotationInv:(t,e,i=0,s=0)=>{const r=Vc[he.inv(e)];r.tx=i,r.ty=s,t.append(r)}};class It{constructor(e,i,s=0,r=0){this._x=s,this._y=r,this.cb=e,this.scope=i}clone(e=this.cb,i=this.scope){return new It(e,i,this._x,this._y)}set(e=0,i=e){return(this._x!==e||this._y!==i)&&(this._x=e,this._y=i,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}const zc=class{constructor(){this.worldTransform=new ce,this.localTransform=new ce,this.position=new It(this.onChange,this,0,0),this.scale=new It(this.onChange,this,1,1),this.pivot=new It(this.onChange,this,0,0),this.skew=new It(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const i=t.worldTransform,s=this.worldTransform;s.a=e.a*i.a+e.b*i.c,s.b=e.a*i.b+e.b*i.d,s.c=e.c*i.a+e.d*i.c,s.d=e.c*i.b+e.d*i.d,s.tx=e.tx*i.a+e.ty*i.c+i.tx,s.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};let Sa=zc;Sa.IDENTITY=new zc;var vd=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,bd=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Mo(t,e,i){const s=t.createShader(e);return t.shaderSource(s,i),t.compileShader(s),s}function on(t){const e=new Array(t);for(let i=0;i<e.length;i++)e[i]=!1;return e}function Wc(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return on(2*e);case"bvec3":return on(3*e);case"bvec4":return on(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const bi=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],xd={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Ed={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Td(t,e){var s;const i=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in t.uniforms){const n=e[r];if(!n){(s=t.uniforms[r])!=null&&s.group&&(t.uniforms[r].ubo?i.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):i.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const a=t.uniforms[r];let o=!1;for(let c=0;c<bi.length;c++)if(bi[c].test(n,a)){i.push(bi[c].code(r,a)),o=!0;break}if(!o){const h=(n.size===1&&!n.isArray?xd:Ed)[n.type].replace("location",`ud["${r}"].location`);i.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",i.join(`
`))}const jc={};let ii=jc;function wd(){if(ii===jc||ii!=null&&ii.isContextLost()){const t=L.ADAPTER.createCanvas();let e;L.PREFER_ENV>=Zt.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),ii=e}return ii}let Cs;function Sd(){if(!Cs){Cs=ke.MEDIUM;const t=wd();t&&t.getShaderPrecisionFormat&&(Cs=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?ke.HIGH:ke.MEDIUM)}return Cs}function Do(t,e){const i=t.getShaderSource(e).split(`
`).map((h,l)=>`${l}: ${h}`),s=t.getShaderInfoLog(e),r=s.split(`
`),n={},a=r.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!n[h]?(n[h]=!0,!0):!1),o=[""];a.forEach(h=>{i[h-1]=`%c${i[h-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=i.join(`
`);o[0]=c,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}function Ad(t,e,i,s){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(i,t.COMPILE_STATUS)||Do(t,i),t.getShaderParameter(s,t.COMPILE_STATUS)||Do(t,s),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const Cd={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Yc(t){return Cd[t]}let Ps=null;const Bo={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function qc(t,e){if(!Ps){const i=Object.keys(Bo);Ps={};for(let s=0;s<i.length;++s){const r=i[s];Ps[t[r]]=Bo[r]}}return Ps[e]}function Oo(t,e,i){if(t.substring(0,9)!=="precision"){let s=e;return e===ke.HIGH&&i!==ke.HIGH&&(s=ke.MEDIUM),`precision ${s} float;
${t}`}else if(i!==ke.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let Li;function Pd(){if(typeof Li=="boolean")return Li;try{Li=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Li=!1}return Li}let Id=0;const Is={},ci=class{constructor(t,e,i="pixi-shader",s={}){this.extra={},this.id=Id++,this.vertexSrc=t||ci.defaultVertexSrc,this.fragmentSrc=e||ci.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Is[i]?(Is[i]++,i+=`-${Is[i]}`):Is[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=Oo(this.vertexSrc,ci.defaultVertexPrecision,ke.HIGH),this.fragmentSrc=Oo(this.fragmentSrc,ci.defaultFragmentPrecision,Sd())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return bd}static get defaultFragmentSrc(){return vd}static from(t,e,i){const s=t+e;let r=Ao[s];return r||(Ao[s]=r=new ci(t,e,i)),r}};let Ke=ci;Ke.defaultVertexPrecision=ke.HIGH;Ke.defaultFragmentPrecision=_t.apple.device?ke.HIGH:ke.MEDIUM;let Rd=0;class Qe{constructor(e,i,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Rd++,this.static=!!i,this.ubo=!!s,e instanceof de?(this.buffer=e,this.buffer.type=ht.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new de(new Float32Array(1)),this.buffer.type=ht.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,i,s){if(!this.ubo)this.uniforms[e]=new Qe(i,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,i,s){return new Qe(e,i,s)}static uboFrom(e,i){return new Qe(e,i??!0,!0)}}class lt{constructor(e,i){this.uniformBindCount=0,this.program=e,i?i instanceof Qe?this.uniformGroup=i:this.uniformGroup=new Qe(i):this.uniformGroup=new Qe({}),this.disposeRunner=new Je("disposeShader")}checkUniformExists(e,i){if(i.uniforms[e])return!0;for(const s in i.uniforms){const r=i.uniforms[s];if(r.group&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,i,s){const r=Ke.from(e,i);return new lt(r,s)}}class Md{constructor(e,i){if(this.vertexSrc=e,this.fragTemplate=i,this.programCache={},this.defaultGroupCache={},!i.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!i.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const s=new Int32Array(e);for(let n=0;n<e;n++)s[n]=n;this.defaultGroupCache[e]=Qe.from({uSamplers:s},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${e}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Ke(this.vertexSrc,r)}const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new ce,default:this.defaultGroupCache[e]};return new lt(this.programCache[e],i)}generateSampleSrc(e){let i="";i+=`
`,i+=`
`;for(let s=0;s<e;s++)s>0&&(i+=`
else `),s<e-1&&(i+=`if(vTextureId < ${s}.5)`),i+=`
{`,i+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,i+=`
}`;return i+=`
`,i+=`
`,i}}class jn{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function Dd(){return!_t.apple.device}function Bd(t){let e=!0;const i=L.ADAPTER.getNavigator();if(_t.tablet||_t.phone){if(_t.apple.device){const s=i.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(e=!1)}if(_t.android.device){const s=i.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(e=!1)}}return e?t:4}class Er{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var Od=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Fd=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const $e=class extends Er{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Gc,this.vertexSize=6,this.state=xt.for2d(),this.size=$e.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Bd(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Dd(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return te("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Fd}static get defaultFragmentTemplate(){return Od}setShaderGenerator({vertex:t=$e.defaultVertexSrc,fragment:e=$e.defaultFragmentTemplate}={}){this.shaderGenerator=new Md(t,e)}contextChange(){const t=this.renderer.gl;L.PREFER_ENV===Zt.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),$e.defaultMaxTextures),this.maxTextures=od(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=$e,i=this.size/4,s=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new zn);for(;e.length<s;)e.push(new jn);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,i=$e._textureArrayPool,s=this.renderer.batch,r=this._tempBoundTextures,n=this.renderer.textureGC.count;let a=++q._globalBatch,o=0,c=i[0],h=0;s.copyBoundTextures(r,e);for(let l=0;l<this._bufferSize;++l){const f=t[l];t[l]=null,f._batchEnabled!==a&&(c.count>=e&&(s.boundArray(c,r,a,e),this.buildDrawCalls(c,h,l),h=l,c=i[++o],++a),f._batchEnabled=a,f.touched=n,c.elements[c.count++]=f)}c.count>0&&(s.boundArray(c,r,a,e),this.buildDrawCalls(c,h,this._bufferSize),++o,++a);for(let l=0;l<r.length;l++)r[l]=null;q._globalBatch=a}buildDrawCalls(t,e,i){const{_bufferedElements:s,_attributeBuffer:r,_indexBuffer:n,vertexSize:a}=this,o=$e._drawCallPool;let c=this._dcIndex,h=this._aIndex,l=this._iIndex,f=o[c];f.start=this._iIndex,f.texArray=t;for(let u=e;u<i;++u){const p=s[u],m=p._texture.baseTexture,b=Fc[m.alphaMode?1:0][p.blendMode];s[u]=null,e<u&&f.blend!==b&&(f.size=l-f.start,e=u,f=o[++c],f.texArray=t,f.start=l),this.packInterleavedGeometry(p,r,n,h,l),h+=p.vertexData.length/2*a,l+=p.indices.length,f.blend=b}e<i&&(f.size=l-f.start,++c),this._dcIndex=c,this._aIndex=h,this._iIndex=l}bindAndClearTexArray(t){const e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;$e.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:i}=this.renderer,s=$e._drawCallPool;let r=null;for(let n=0;n<t;n++){const{texArray:a,type:o,size:c,start:h,blend:l}=s[n];r!==a&&(r=a,this.bindAndClearTexArray(a)),this.state.blendMode=l,i.set(this.state),e.drawElements(o,c,e.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),$e.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=ar(Math.ceil(t/8)),i=So(e),s=e*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let r=this._aBuffers[s];return r||(this._aBuffers[s]=r=new $n(s*this.vertexSize*4)),r}getIndexBuffer(t){const e=ar(Math.ceil(t/12)),i=So(e),s=e*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let r=this._iBuffers[i];return r||(this._iBuffers[i]=r=new Uint16Array(s)),r}packInterleavedGeometry(t,e,i,s,r){const{uint32View:n,float32View:a}=e,o=s/this.vertexSize,c=t.uvs,h=t.indices,l=t.vertexData,f=t._texture.baseTexture._batchLocation,u=Math.min(t.worldAlpha,1),p=ne.shared.setValue(t._tintRGB).toPremultiplied(u,t._texture.baseTexture.alphaMode>0);for(let m=0;m<l.length;m+=2)a[s++]=l[m],a[s++]=l[m+1],a[s++]=c[m],a[s++]=c[m+1],n[s++]=p,a[s++]=f;for(let m=0;m<h.length;m++)i[r++]=o+h[m]}};let je=$e;je.defaultBatchSize=4096;je.extension={name:"batch",type:N.RendererPlugin};je._drawCallPool=[];je._textureArrayPool=[];V.add(je);var Ld=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Nd=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Hi=class extends lt{constructor(t,e,i){const s=Ke.from(t||Hi.defaultVertexSrc,e||Hi.defaultFragmentSrc);super(s,i),this.padding=0,this.resolution=Hi.defaultResolution,this.multisample=Hi.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new xt}apply(t,e,i,s,r){t.applyFilter(this,e,i,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return Nd}static get defaultFragmentSrc(){return Ld}};let Se=Hi;Se.defaultResolution=1;Se.defaultMultisample=me.NONE;class Tr{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new ne(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:i,background:s,backgroundAlpha:r}=e,n=s??i;n!==void 0&&(this.color=n),this.alpha=r}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Tr.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};Tr.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"background"};V.add(Tr);class Kc{constructor(e){this.renderer=e,this.emptyRenderer=new Er(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,i){const{boundTextures:s}=this.renderer.texture;for(let r=i-1;r>=0;--r)e[r]=s[r]||null,e[r]&&(e[r]._batchLocation=r)}boundArray(e,i,s,r){const{elements:n,ids:a,count:o}=e;let c=0;for(let h=0;h<o;h++){const l=n[h],f=l._batchLocation;if(f>=0&&f<r&&i[f]===l){a[h]=f;continue}for(;c<r;){const u=i[c];if(u&&u._batchEnabled===s&&u._batchLocation===c){c++;continue}a[h]=c,l._batchLocation=c,i[c]=l;break}}}destroy(){this.renderer=null}}Kc.extension={type:N.RendererSystem,name:"batch"};V.add(Kc);let Fo=0;class wr{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Fo++}init(e){if(e.context)this.initFromContext(e.context);else{const i=this.renderer.background.alpha<1,s=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:i,premultipliedAlpha:s,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Fo++,this.renderer.runners.contextChange.emit(e);const i=this.renderer.view;i.addEventListener!==void 0&&(i.addEventListener("webglcontextlost",this.handleContextLost,!1),i.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const i=this.createContext(this.renderer.view,e);this.initFromContext(i)}createContext(e,i){let s;if(L.PREFER_ENV>=Zt.WEBGL2&&(s=e.getContext("webgl2",i)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=e.getContext("webgl",i)||e.getContext("experimental-webgl",i),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,i={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,i,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,i,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const i=e.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),i&&!i.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=s||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}wr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};wr.extension={type:N.RendererSystem,name:"context"};V.add(wr);class kd extends cs{upload(e,i,s){const r=e.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===et.UNPACK);const n=i.realWidth,a=i.realHeight;return s.width===n&&s.height===a?r.texSubImage2D(i.target,0,0,0,n,a,i.format,s.type,this.data):(s.width=n,s.height=a,r.texImage2D(i.target,0,s.internalFormat,n,a,0,i.format,s.type,this.data)),!0}}class Yn{constructor(e,i){this.width=Math.round(e||100),this.height=Math.round(i||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Je("disposeFramebuffer"),this.multisample=me.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,i){return this.colorTextures[e]=i||new q(null,{scaleMode:De.NEAREST,resolution:1,mipmap:ut.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new q(new kd(null,{width:this.width,height:this.height}),{scaleMode:De.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:ut.OFF,format:F.DEPTH_COMPONENT,type:z.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,i){if(e=Math.round(e),i=Math.round(i),!(e===this.width&&i===this.height)){this.width=e,this.height=i,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const r=this.colorTextures[s],n=r.resolution;r.setSize(e/n,i/n)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(e/s,i/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Zc extends q{constructor(e={}){if(typeof e=="number"){const i=arguments[0],s=arguments[1],r=arguments[2],n=arguments[3];e={width:i,height:s,scaleMode:r,resolution:n}}e.width=e.width||100,e.height=e.height||100,e.multisample??(e.multisample=me.NONE),super(null,e),this.mipmap=ut.OFF,this.valid=!0,this._clear=new ne([0,0,0,0]),this.framebuffer=new Yn(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(e,i){this.framebuffer.resize(e*this.resolution,i*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Bt extends ss{constructor(e){const i=e,s=i.naturalWidth||i.videoWidth||i.width,r=i.naturalHeight||i.videoHeight||i.height;super(s,r),this.source=e,this.noSubImage=!1}static crossOrigin(e,i,s){s===void 0&&!i.startsWith("data:")?e.crossOrigin=rd(i):s!==!1&&(e.crossOrigin=typeof s=="string"?s:"anonymous")}upload(e,i,s,r){const n=e.gl,a=i.realWidth,o=i.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===et.UNPACK),!this.noSubImage&&i.target===n.TEXTURE_2D&&s.width===a&&s.height===o?n.texSubImage2D(n.TEXTURE_2D,0,0,0,i.format,s.type,r):(s.width=a,s.height=o,n.texImage2D(i.target,0,s.internalFormat,i.format,s.type,r)),!0}update(){if(this.destroyed)return;const e=this.source,i=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;this.resize(i,s),super.update()}dispose(){this.source=null}}class Jc extends Bt{constructor(e,i){if(i=i||{},typeof e=="string"){const s=new Image;Bt.crossOrigin(s,e,i.crossorigin),s.src=e,e=s}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(i.createBitmap??L.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this.bitmap=null,this._load=null,i.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((i,s)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?i(this.process()):i(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=a=>{s(a),this.onError.emit(a)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const i=globalThis.createImageBitmap,s=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:s?"cors":"no-cors"}).then(r=>r.blob()).then(r=>i(r,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===et.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,i,s){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,i,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,i,s,this.bitmap),!this.preserveBitmap){let r=!0;const n=i._glTextures;for(const a in n){const o=n[a];if(o!==s&&o.dirtyId!==i.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Qc{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,i,s){const r=i.width,n=i.height;if(s){const a=e.width/2/r,o=e.height/2/n,c=e.x/r+a,h=e.y/n+o;s=he.add(s,he.NW),this.x0=c+a*he.uX(s),this.y0=h+o*he.uY(s),s=he.add(s,2),this.x1=c+a*he.uX(s),this.y1=h+o*he.uY(s),s=he.add(s,2),this.x2=c+a*he.uX(s),this.y2=h+o*he.uY(s),s=he.add(s,2),this.x3=c+a*he.uX(s),this.y3=h+o*he.uY(s)}else this.x0=e.x/r,this.y0=e.y/n,this.x1=(e.x+e.width)/r,this.y1=e.y/n,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/n,this.x3=e.x/r,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const Lo=new Qc;function Rs(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class G extends as{constructor(e,i,s,r,n,a,o){if(super(),this.noFrame=!1,i||(this.noFrame=!0,i=new K(0,0,1,1)),e instanceof G&&(e=e.baseTexture),this.baseTexture=e,this._frame=i,this.trim=r,this.valid=!1,this._uvs=Lo,this.uvMatrix=null,this.orig=s||i,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new ie(a.x,a.y):new ie(0,0),this.defaultBorders=o,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=i:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:i}=this.baseTexture;i!=null&&i.url&&nt[i.url]&&G.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,G.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const e=this._frame.clone(),i=this._frame===this.orig?e:this.orig.clone(),s=new G(this.baseTexture,!this.noFrame&&e,i,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(s._frame=e),s}updateUvs(){this._uvs===Lo&&(this._uvs=new Qc),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,i={},s=L.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let n=null;if(r)n=e;else if(e instanceof q){if(!e.cacheId){const o=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e.cacheId=`${o}-${qt()}`,q.addToCache(e,e.cacheId)}n=e.cacheId}else{if(!e._pixiId){const o=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e._pixiId=`${o}_${qt()}`}n=e._pixiId}let a=nt[n];if(r&&s&&!a)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!a&&!(e instanceof q)?(i.resolution||(i.resolution=Mt(e)),a=new G(new q(e,i)),a.baseTexture.cacheId=n,q.addToCache(a.baseTexture,n),G.addToCache(a,n)):!a&&e instanceof q&&(a=new G(e),G.addToCache(a,n)),a}static fromURL(e,i){const s=Object.assign({autoLoad:!1},i==null?void 0:i.resourceOptions),r=G.from(e,Object.assign({resourceOptions:s},i),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(e,i,s,r){return new G(q.fromBuffer(e,i,s,r))}static fromLoader(e,i,s,r){const n=new q(e,Object.assign({scaleMode:q.defaultOptions.scaleMode,resolution:Mt(i)},r)),{resource:a}=n;a instanceof Jc&&(a.url=i);const o=new G(n);return s||(s=i),q.addToCache(o.baseTexture,s),G.addToCache(o,s),s!==i&&(q.addToCache(o.baseTexture,i),G.addToCache(o,i)),o.baseTexture.valid?Promise.resolve(o):new Promise(c=>{o.baseTexture.once("loaded",()=>c(o))})}static addToCache(e,i){i&&(e.textureCacheIds.includes(i)||e.textureCacheIds.push(i),nt[i]&&nt[i]!==e&&console.warn(`Texture added to the cache with an id [${i}] that already had an entry`),nt[i]=e)}static removeFromCache(e){if(typeof e=="string"){const i=nt[e];if(i){const s=i.textureCacheIds.indexOf(e);return s>-1&&i.textureCacheIds.splice(s,1),delete nt[e],i}}else if(e!=null&&e.textureCacheIds){for(let i=0;i<e.textureCacheIds.length;++i)nt[e.textureCacheIds[i]]===e&&delete nt[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:i,y:s,width:r,height:n}=e,a=i+r>this.baseTexture.width,o=s+n>this.baseTexture.height;if(a||o){const c=a&&o?"and":"or",h=`X: ${i} + ${r} = ${i+r} > ${this.baseTexture.width}`,l=`Y: ${s} + ${n} = ${s+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${c} ${l}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return G._EMPTY||(G._EMPTY=new G(new q),Rs(G._EMPTY),Rs(G._EMPTY.baseTexture)),G._EMPTY}static get WHITE(){if(!G._WHITE){const e=L.ADAPTER.createCanvas(16,16),i=e.getContext("2d");e.width=16,e.height=16,i.fillStyle="white",i.fillRect(0,0,16,16),G._WHITE=new G(q.from(e)),Rs(G._WHITE),Rs(G._WHITE.baseTexture)}return G._WHITE}}class Jt extends G{constructor(e,i){super(e,i),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,i,s=!0){const r=this.baseTexture.resolution,n=Math.round(e*r)/r,a=Math.round(i*r)/r;this.valid=n>0&&a>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=a,s&&this.baseTexture.resize(n,a),this.updateUvs()}setResolution(e){const{baseTexture:i}=this;i.resolution!==e&&(i.setResolution(e),this.resize(i.width,i.height,!1))}static create(e){return new Jt(new Zc(e))}}class eh{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,i,s=me.NONE){const r=new Zc(Object.assign({width:e,height:i,resolution:1,multisample:s},this.textureOptions));return new Jt(r)}getOptimalTexture(e,i,s=1,r=me.NONE){let n;e=Math.ceil(e*s-1e-6),i=Math.ceil(i*s-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||i!==this._pixelsHeight?(e=ar(e),i=ar(i),n=((e&65535)<<16|i&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let a=this.texturePool[n].pop();return a||(a=this.createTexture(e,i,r)),a.filterPoolKey=n,a.setResolution(s),a}getFilterTexture(e,i,s){const r=this.getOptimalTexture(e.width,e.height,i||e.resolution,s||me.NONE);return r.filterFrame=e.filterFrame,r}returnTexture(e){const i=e.filterPoolKey;e.filterFrame=null,this.texturePool[i].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const i in this.texturePool){const s=this.texturePool[i];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const i in this.texturePool){if(!(Number(i)<0))continue;const s=this.texturePool[i];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0);this.texturePool[i]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}eh.SCREEN_KEY=-1;class Ud extends Dt{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class th extends Dt{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new de(this.vertices),this.uvBuffer=new de(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,i){let s=0,r=0;return this.uvs[0]=s,this.uvs[1]=r,this.uvs[2]=s+i.width/e.width,this.uvs[3]=r,this.uvs[4]=s+i.width/e.width,this.uvs[5]=r+i.height/e.height,this.uvs[6]=s,this.uvs[7]=r+i.height/e.height,s=i.x,r=i.y,this.vertices[0]=s,this.vertices[1]=r,this.vertices[2]=s+i.width,this.vertices[3]=r,this.vertices[4]=s+i.width,this.vertices[5]=r+i.height,this.vertices[6]=s,this.vertices[7]=r+i.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Gd{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=me.NONE,this.sourceFrame=new K,this.destinationFrame=new K,this.bindingSourceFrame=new K,this.bindingDestinationFrame=new K,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Ms=[new ie,new ie,new ie,new ie],cn=new ce;class ih{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new eh,this.statePool=[],this.quad=new Ud,this.quadUv=new th,this.tempRect=new K,this.activeState={},this.globalUniforms=new Qe({outputFrame:new K,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,i){const s=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Gd,a=this.renderer.renderTexture;let o=i[0].resolution,c=i[0].multisample,h=i[0].padding,l=i[0].autoFit,f=i[0].legacy??!0;for(let m=1;m<i.length;m++){const b=i[m];o=Math.min(o,b.resolution),c=Math.min(c,b.multisample),h=this.useMaxPadding?Math.max(h,b.padding):h+b.padding,l=l&&b.autoFit,f=f||(b.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),r.push(n),n.resolution=o,n.multisample=c,n.legacy=f,n.target=e,n.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),n.sourceFrame.pad(h);const u=this.tempRect.copyFrom(a.sourceFrame);s.projection.transform&&this.transformAABB(cn.copyFrom(s.projection.transform).invert(),u),l?(n.sourceFrame.fit(u),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(u)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,a.current?a.current.resolution:s.resolution,a.sourceFrame,a.destinationFrame,s.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,o,c),n.filters=i,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=n.sourceFrame.width,p.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(a.sourceFrame),n.bindingDestinationFrame.copyFrom(a.destinationFrame),n.transform=s.projection.transform,s.projection.transform=null,a.bind(n.renderTexture,n.sourceFrame,p),s.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,i=e.pop(),s=i.filters;this.activeState=i;const r=this.globalUniforms.uniforms;r.outputFrame=i.sourceFrame,r.resolution=i.resolution;const n=r.inputSize,a=r.inputPixel,o=r.inputClamp;if(n[0]=i.destinationFrame.width,n[1]=i.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],a[0]=Math.round(n[0]*i.resolution),a[1]=Math.round(n[1]*i.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=i.sourceFrame.width*n[2]-.5*a[2],o[3]=i.sourceFrame.height*n[3]-.5*a[3],i.legacy){const h=r.filterArea;h[0]=i.destinationFrame.width,h[1]=i.destinationFrame.height,h[2]=i.sourceFrame.x,h[3]=i.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const c=e[e.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,i.renderTexture,c.renderTexture,at.BLEND,i),this.returnFilterTexture(i.renderTexture);else{let h=i.renderTexture,l=this.getOptimalFilterTexture(h.width,h.height,i.resolution);l.filterFrame=h.filterFrame;let f=0;for(f=0;f<s.length-1;++f){f===1&&i.multisample>1&&(l=this.getOptimalFilterTexture(h.width,h.height,i.resolution),l.filterFrame=h.filterFrame),s[f].apply(this,h,l,at.CLEAR,i);const u=h;h=l,l=u}s[f].apply(this,h,c.renderTexture,at.BLEND,i),f>1&&i.multisample>1&&this.returnFilterTexture(i.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(l)}i.clear(),this.statePool.push(i)}bindAndClear(e,i=at.CLEAR){const{renderTexture:s,state:r}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e!=null&&e.filterFrame){const a=this.tempRect;a.x=0,a.y=0,a.width=e.filterFrame.width,a.height=e.filterFrame.height,s.bind(e,e.filterFrame,a)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=r.stateId&1||this.forceClear;(i===at.CLEAR||i===at.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,i,s,r){const n=this.renderer;n.state.set(e.state),this.bindAndClear(s,r),e.uniforms.uSampler=i,e.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(i._frame,i.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(ct.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(ct.TRIANGLE_STRIP))}calculateSpriteMatrix(e,i){const{sourceFrame:s,destinationFrame:r}=this.activeState,{orig:n}=i._texture,a=e.set(r.width,0,0,r.height,s.x,s.y),o=i.worldTransform.copyTo(ce.TEMP_MATRIX);return o.invert(),a.prepend(o),a.scale(1/n.width,1/n.height),a.translate(i.anchor.x,i.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,i,s=1,r=me.NONE){return this.texturePool.getOptimalTexture(e,i,s,r)}getFilterTexture(e,i,s){if(typeof e=="number"){const n=e;e=i,i=n}e=e||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(e.width,e.height,i||e.resolution,s||me.NONE);return r.filterFrame=e.filterFrame,r}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,i){const s=Ms[0],r=Ms[1],n=Ms[2],a=Ms[3];s.set(i.left,i.top),r.set(i.left,i.bottom),n.set(i.right,i.top),a.set(i.right,i.bottom),e.apply(s,s),e.apply(r,r),e.apply(n,n),e.apply(a,a);const o=Math.min(s.x,r.x,n.x,a.x),c=Math.min(s.y,r.y,n.y,a.y),h=Math.max(s.x,r.x,n.x,a.x),l=Math.max(s.y,r.y,n.y,a.y);i.x=o,i.y=c,i.width=h-o,i.height=l-c}roundFrame(e,i,s,r,n){if(!(e.width<=0||e.height<=0||s.width<=0||s.height<=0)){if(n){const{a,b:o,c,d:h}=n;if((Math.abs(o)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(h)>1e-4))return}n=n?cn.copyFrom(n):cn.identity(),n.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.transformAABB(n,e),e.ceil(i),this.transformAABB(n.invert(),e)}}}ih.extension={type:N.RendererSystem,name:"filter"};V.add(ih);class Hd{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=me.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Xd=new K;class sh{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Yn(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new K,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let i=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;L.PREFER_ENV===Zt.WEBGL_LEGACY&&(i=null,s=null),i?e.drawBuffers=r=>i.drawBuffersWEBGL(r):(this.hasMRT=!1,e.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,i,s=0){const{gl:r}=this;if(e){const n=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==s&&(e.dirtyId++,e.dirtyFormat++,n.mipLevel=s),n.dirtyId!==e.dirtyId&&(n.dirtyId=e.dirtyId,n.dirtyFormat!==e.dirtyFormat?(n.dirtyFormat=e.dirtyFormat,n.dirtySize=e.dirtySize,this.updateFramebuffer(e,s)):n.dirtySize!==e.dirtySize&&(n.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let a=0;a<e.colorTextures.length;a++){const o=e.colorTextures[a];this.renderer.texture.unbind(o.parentTextureArray||o)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),i){const a=i.width>>s,o=i.height>>s,c=a/i.width;this.setViewport(i.x*c,i.y*c,a,o)}else{const a=e.width>>s,o=e.height>>s;this.setViewport(0,0,a,o)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),i?this.setViewport(i.x,i.y,i.width,i.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,i,s,r){const n=this.viewport;e=Math.round(e),i=Math.round(i),s=Math.round(s),r=Math.round(r),(n.width!==s||n.height!==r||n.x!==e||n.y!==i)&&(n.x=e,n.y=i,n.width=s,n.height=r,this.gl.viewport(e,i,s,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,i,s,r,n=Sn.COLOR|Sn.DEPTH){const{gl:a}=this;a.clearColor(e,i,s,r),a.clear(n)}initFramebuffer(e){const{gl:i}=this,s=new Hd(i.createFramebuffer());return s.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(e),e.disposeRunner.add(this),s}resizeFramebuffer(e){const{gl:i}=this,s=e.glFramebuffers[this.CONTEXT_UID];s.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,i.DEPTH24_STENCIL8,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e.width,e.height));const r=e.colorTextures;let n=r.length;i.drawBuffers||(n=Math.min(n,1));for(let a=0;a<n;a++){const o=r[a],c=o.parentTextureArray||o;this.renderer.texture.bind(c,0),a===0&&s.msaaBuffer&&(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,i){const{gl:s}=this,r=e.glFramebuffers[this.CONTEXT_UID],n=e.colorTextures;let a=n.length;s.drawBuffers||(a=Math.min(a,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||s.createRenderbuffer():r.msaaBuffer&&(s.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const o=[];for(let c=0;c<a;c++){const h=n[c],l=h.parentTextureArray||h;this.renderer.texture.bind(l,0),c===0&&r.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,r.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+c,h.target,l._glTextures[this.CONTEXT_UID].texture,i),o.push(s.COLOR_ATTACHMENT0+c))}if(o.length>1&&s.drawBuffers(o),e.depthTexture&&this.writeDepthTexture){const h=e.depthTexture;this.renderer.texture.bind(h,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,i)}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,e.width,e.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,e.width,e.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r.stencil)):r.stencil&&(s.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:i}=this;let s=me.NONE;if(e<=1||i===null)return s;for(let r=0;r<i.length;r++)if(i[r]<=e){s=i[r];break}return s===1&&(s=me.NONE),s}blit(e,i,s){const{current:r,renderer:n,gl:a,CONTEXT_UID:o}=this;if(n.context.webGLVersion!==2||!r)return;const c=r.glFramebuffers[o];if(!c)return;if(!e){if(!c.msaaBuffer)return;const l=r.colorTextures[0];if(!l)return;c.blitFramebuffer||(c.blitFramebuffer=new Yn(r.width,r.height),c.blitFramebuffer.addColorTexture(0,l)),e=c.blitFramebuffer,e.colorTextures[0]!==l&&(e.colorTextures[0]=l,e.dirtyId++,e.dirtyFormat++),(e.width!==r.width||e.height!==r.height)&&(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}i||(i=Xd,i.width=r.width,i.height=r.height),s||(s=i);const h=i.width===s.width&&i.height===s.height;this.bind(e),a.bindFramebuffer(a.READ_FRAMEBUFFER,c.framebuffer),a.blitFramebuffer(i.left,i.top,i.right,i.bottom,s.left,s.top,s.right,s.bottom,a.COLOR_BUFFER_BIT,h?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,i){const s=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!s)return;delete e.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),i||(r.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&r.deleteRenderbuffer(s.msaaBuffer),s.stencil&&r.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&this.disposeFramebuffer(s.blitFramebuffer,i)}disposeAll(e){const i=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<i.length;s++)this.disposeFramebuffer(i[s],e)}forceStencil(){const e=this.current;if(!e)return;const i=e.glFramebuffers[this.CONTEXT_UID];if(!i||i.stencil)return;e.stencil=!0;const s=e.width,r=e.height,n=this.gl,a=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,a),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,s,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,s,r),i.stencil=a,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new K}destroy(){this.renderer=null}}sh.extension={type:N.RendererSystem,name:"framebuffer"};V.add(sh);const hn={5126:4,5123:2,5121:1};class rh{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,i=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,i.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;L.PREFER_ENV===Zt.WEBGL_LEGACY&&(s=null),s?(e.createVertexArray=()=>s.createVertexArrayOES(),e.bindVertexArray=r=>s.bindVertexArrayOES(r),e.deleteVertexArray=r=>s.deleteVertexArrayOES(r)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(i.webGLVersion!==2){const s=e.getExtension("ANGLE_instanced_arrays");s?(e.vertexAttribDivisor=(r,n)=>s.vertexAttribDivisorANGLE(r,n),e.drawElementsInstanced=(r,n,a,o,c)=>s.drawElementsInstancedANGLE(r,n,a,o,c),e.drawArraysInstanced=(r,n,a,o)=>s.drawArraysInstancedANGLE(r,n,a,o)):this.hasInstance=!1}this.canUseUInt32ElementIndex=i.webGLVersion===2||!!i.extensions.uint32ElementIndex}bind(e,i){i=i||this.renderer.shader.shader;const{gl:s}=this;let r=e.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const a=r[i.program.id]||this.initGeometryVao(e,i,n);this._activeGeometry=e,this._activeVao!==a&&(this._activeVao=a,this.hasVao?s.bindVertexArray(a):this.activateVao(e,i.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,i=this.renderer.buffer;for(let s=0;s<e.buffers.length;s++){const r=e.buffers[s];i.update(r)}}checkCompatibility(e,i){const s=e.attributes,r=i.attributeData;for(const n in r)if(!s[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(e,i){const s=e.attributes,r=i.attributeData,n=["g",e.id];for(const a in s)r[a]&&n.push(a,r[a].location);return n.join("-")}initGeometryVao(e,i,s=!0){const r=this.gl,n=this.CONTEXT_UID,a=this.renderer.buffer,o=i.program;o.glPrograms[n]||this.renderer.shader.generateProgram(i),this.checkCompatibility(e,o);const c=this.getSignature(e,o),h=e.glVertexArrayObjects[this.CONTEXT_UID];let l=h[c];if(l)return h[o.id]=l,l;const f=e.buffers,u=e.attributes,p={},m={};for(const b in f)p[b]=0,m[b]=0;for(const b in u)!u[b].size&&o.attributeData[b]?u[b].size=o.attributeData[b].size:u[b].size||console.warn(`PIXI Geometry attribute '${b}' size cannot be determined (likely the bound shader does not have the attribute)`),p[u[b].buffer]+=u[b].size*hn[u[b].type];for(const b in u){const _=u[b],T=_.size;_.stride===void 0&&(p[_.buffer]===T*hn[_.type]?_.stride=0:_.stride=p[_.buffer]),_.start===void 0&&(_.start=m[_.buffer],m[_.buffer]+=T*hn[_.type])}l=r.createVertexArray(),r.bindVertexArray(l);for(let b=0;b<f.length;b++){const _=f[b];a.bind(_),s&&_._glBuffers[n].refCount++}return this.activateVao(e,o),h[o.id]=l,h[c]=l,r.bindVertexArray(null),a.unbind(ht.ARRAY_BUFFER),l}disposeGeometry(e,i){var o;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const s=e.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=e.buffers,a=(o=this.renderer)==null?void 0:o.buffer;if(e.disposeRunner.remove(this),!!s){if(a)for(let c=0;c<n.length;c++){const h=n[c]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!i&&a.dispose(n[c],i))}if(!i){for(const c in s)if(c[0]==="g"){const h=s[c];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const i=Object.keys(this.managedGeometries);for(let s=0;s<i.length;s++)this.disposeGeometry(this.managedGeometries[i[s]],e)}activateVao(e,i){const s=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,a=e.buffers,o=e.attributes;e.indexBuffer&&n.bind(e.indexBuffer);let c=null;for(const h in o){const l=o[h],f=a[l.buffer],u=f._glBuffers[r];if(i.attributeData[h]){c!==u&&(n.bind(f),c=u);const p=i.attributeData[h].location;if(s.enableVertexAttribArray(p),s.vertexAttribPointer(p,l.size,l.type||s.FLOAT,l.normalized,l.stride,l.start),l.instance)if(this.hasInstance)s.vertexAttribDivisor(p,l.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,i,s,r){const{gl:n}=this,a=this._activeGeometry;if(a.indexBuffer){const o=a.indexBuffer.data.BYTES_PER_ELEMENT,c=o===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?a.instanced?n.drawElementsInstanced(e,i||a.indexBuffer.data.length,c,(s||0)*o,r||1):n.drawElements(e,i||a.indexBuffer.data.length,c,(s||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?n.drawArraysInstanced(e,s,i||a.getSize(),r||1):n.drawArrays(e,s,i||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}rh.extension={type:N.RendererSystem,name:"geometry"};V.add(rh);const No=new ce;class nh{constructor(e,i){this._texture=e,this.mapCoord=new ce,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof i>"u"?.5:i,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,i){i===void 0&&(i=e);const s=this.mapCoord;for(let r=0;r<e.length;r+=2){const n=e[r],a=e[r+1];i[r]=n*s.a+a*s.c+s.tx,i[r+1]=n*s.b+a*s.d+s.ty}return i}update(e){const i=this._texture;if(!i||!i.valid||!e&&this._textureID===i._updateID)return!1;this._textureID=i._updateID,this._updateID++;const s=i._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=i.orig,n=i.trim;n&&(No.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(No));const a=i.baseTexture,o=this.uClampFrame,c=this.clampMargin/a.resolution,h=this.clampOffset;return o[0]=(i._frame.x+c+h)/a.width,o[1]=(i._frame.y+c+h)/a.height,o[2]=(i._frame.x+i._frame.width-c+h)/a.width,o[3]=(i._frame.y+i._frame.height-c+h)/a.height,this.uClampOffset[0]=h/a.realWidth,this.uClampOffset[1]=h/a.realHeight,this.isSimple=i._frame.width===a.width&&i._frame.height===a.height&&i.rotate===0,!0}}var $d=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Vd=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class zd extends Se{constructor(e,i,s){let r=null;typeof e!="string"&&i===void 0&&s===void 0&&(r=e,e=void 0,i=void 0,s=void 0),super(e||Vd,i||$d,s),this.maskSprite=r,this.maskMatrix=new ce}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,i,s,r){const n=this._maskSprite,a=n._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new nh(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,e.applyFilter(this,i,s,r))}}class Wd{constructor(e=null){this.type=ye.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Se.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ye.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class ah{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,i){let s=i;if(!s.isMaskData){const n=this.maskDataPool.pop()||new Wd;n.pooled=!0,n.maskObject=i,s=n}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(r),s._colorMask=r?r._colorMask:15,s.autoDetect&&this.detect(s),s._target=e,s.type!==ye.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case ye.SCISSOR:this.renderer.scissor.push(s);break;case ye.STENCIL:this.renderer.stencil.push(s);break;case ye.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case ye.COLOR:this.pushColorMask(s);break}s.type===ye.SPRITE&&this.maskStack.push(s)}pop(e){const i=this.maskStack.pop();if(!(!i||i._target!==e)){if(i.enabled)switch(i.type){case ye.SCISSOR:this.renderer.scissor.pop(i);break;case ye.STENCIL:this.renderer.stencil.pop(i.maskObject);break;case ye.SPRITE:this.popSpriteMask(i);break;case ye.COLOR:this.popColorMask(i);break}if(i.reset(),i.pooled&&this.maskDataPool.push(i),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===ye.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(e){const i=e.maskObject;i?i.isSprite?e.type=ye.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=ye.SCISSOR:e.type=ye.STENCIL:e.type=ye.COLOR}pushSpriteMask(e){const{maskObject:i}=e,s=e._target;let r=e._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new zd]));const n=this.renderer,a=n.renderTexture;let o,c;if(a.current){const l=a.current;o=e.resolution||l.resolution,c=e.multisample??l.multisample}else o=e.resolution||n.resolution,c=e.multisample??n.multisample;r[0].resolution=o,r[0].multisample=c,r[0].maskSprite=i;const h=s.filterArea;s.filterArea=i.getBounds(!0),n.filter.push(s,r),s.filterArea=h,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const i=e._colorMask,s=e._colorMask=i&e.colorMask;s!==i&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(e){const i=e._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==i&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}ah.extension={type:N.RendererSystem,name:"mask"};V.add(ah);class oh{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:i}=this.renderer,s=this.getStackLength();this.maskStack=e;const r=this.getStackLength();r!==s&&(r===0?i.disable(this.glConst):(i.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const ko=new ce,Uo=[],Ys=class extends oh{constructor(t){super(t),this.glConst=L.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:i}=t,{renderer:s}=this,r=s.renderTexture,n=i.getBounds(!0,Uo.pop()??new K);this.roundFrameToPixels(n,r.current?r.current.resolution:s.resolution,r.sourceFrame,r.destinationFrame,s.projection.transform),e&&n.fit(e),t._scissorRectLocal=n}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:i,c:s,d:r}=t;return(Math.abs(i)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||Ys.isMatrixRotated(e.worldTransform)||Ys.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,s,r){Ys.isMatrixRotated(r)||(r=r?ko.copyFrom(r):ko.identity(),r.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.renderer.filter.transformAABB(r,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Uo.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};let ch=Ys;ch.extension={type:N.RendererSystem,name:"scissor"};V.add(ch);class hh extends oh{constructor(e){super(e),this.glConst=L.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const i=e.maskObject,{gl:s}=this.renderer,r=e._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),e._stencilCounter++;const n=e._colorMask;n!==0&&(e._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,r,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,n!==0&&(e._colorMask=n,s.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(e){const i=this.renderer.gl;if(this.getStackLength()===0)i.disable(i.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=s?s._colorMask:15;r!==0&&(s._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilOp(i.KEEP,i.KEEP,i.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(s._colorMask=r,i.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}hh.extension={type:N.RendererSystem,name:"stencil"};V.add(hh);class lh{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const i in e)this.plugins[i]=new e[i](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}lh.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"_plugin"};V.add(lh);class fh{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ce,this.transform=null}update(e,i,s,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=i||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(e,i,s,r){const n=this.projectionMatrix,a=r?-1:1;n.identity(),n.a=1/i.width*2,n.d=a*(1/i.height*2),n.tx=-1-i.x*n.a,n.ty=-a-i.y*n.d}setTransform(e){}destroy(){this.renderer=null}}fh.extension={type:N.RendererSystem,name:"projection"};V.add(fh);const jd=new Sa;class uh{constructor(e){this.renderer=e,this._tempMatrix=new ce}generateTexture(e,i){const{region:s,...r}=i||{},n=s||e.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const a=Jt.create({width:n.width,height:n.height,...r});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const o=e.transform;return e.transform=jd,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=o,a}destroy(){}}uh.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"textureGenerator"};V.add(uh);const Ft=new K,Ni=new K;class dh{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new K,this.destinationFrame=new K,this.viewportFrame=new K}contextChange(){var i;const e=(i=this.renderer)==null?void 0:i.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,i,s){const r=this.renderer;this.current=e;let n,a,o;e?(n=e.baseTexture,o=n.resolution,i||(Ft.width=e.frame.width,Ft.height=e.frame.height,i=Ft),s||(Ni.x=e.frame.x,Ni.y=e.frame.y,Ni.width=i.width,Ni.height=i.height,s=Ni),a=n.framebuffer):(o=r.resolution,i||(Ft.width=r._view.screen.width,Ft.height=r._view.screen.height,i=Ft),s||(s=Ft,s.width=i.width,s.height=i.height));const c=this.viewportFrame;c.x=s.x*o,c.y=s.y*o,c.width=s.width*o,c.height=s.height*o,e||(c.y=r.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(a,c),this.renderer.projection.update(s,i,o,!a),e?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(i),this.destinationFrame.copyFrom(s)}clear(e,i){const s=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=ne.shared.setValue(e||s);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const n=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,o=n.width!==a.width||n.height!==a.height;if(o){let{x:c,y:h,width:l,height:f}=this.viewportFrame;c=Math.round(c),h=Math.round(h),l=Math.round(l),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(c,h,l,f)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,i),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}dh.extension={type:N.RendererSystem,name:"renderTexture"};V.add(dh);class Yd{constructor(e,i){this.program=e,this.uniformData=i,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function qd(t,e){const i={},s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<s;r++){const n=e.getActiveAttrib(t,r);if(n.name.startsWith("gl_"))continue;const a=qc(e,n.type),o={type:a,name:n.name,size:Yc(a),location:e.getAttribLocation(t,n.name)};i[n.name]=o}return i}function Kd(t,e){const i={},s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<s;r++){const n=e.getActiveUniform(t,r),a=n.name.replace(/\[.*?\]$/,""),o=!!n.name.match(/\[.*?\]$/),c=qc(e,n.type);i[a]={name:a,index:r,type:c,size:n.size,isArray:o,value:Wc(c,n.size)}}return i}function Zd(t,e){var c;const i=Mo(t,t.VERTEX_SHADER,e.vertexSrc),s=Mo(t,t.FRAGMENT_SHADER,e.fragmentSrc),r=t.createProgram();t.attachShader(r,i),t.attachShader(r,s);const n=(c=e.extra)==null?void 0:c.transformFeedbackVaryings;if(n&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||Ad(t,r,i,s),e.attributeData=qd(r,t),e.uniformData=Kd(r,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const h=Object.keys(e.attributeData);h.sort((l,f)=>l>f?1:-1);for(let l=0;l<h.length;l++)e.attributeData[h[l]].location=l,t.bindAttribLocation(r,l,h[l]);t.linkProgram(r)}t.deleteShader(i),t.deleteShader(s);const a={};for(const h in e.uniformData){const l=e.uniformData[h];a[h]={location:t.getUniformLocation(r,h),value:Wc(l.type,l.size)}}return new Yd(r,a)}function Jd(t,e,i,s,r){i.buffer.update(r)}const Qd={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},ph={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function ep(t){const e=t.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let i=0,s=0,r=0;for(let n=0;n<e.length;n++){const a=e[n];if(i=ph[a.data.type],a.data.size>1&&(i=Math.max(i,16)*a.data.size),a.dataLen=i,s%i!==0&&s<16){const o=s%i%16;s+=o,r+=o}s+i>16?(r=Math.ceil(r/16)*16,a.offset=r,r+=i,s=i):(a.offset=r,s+=i,r+=i)}return r=Math.ceil(r/16)*16,{uboElements:e,size:r}}function tp(t,e){const i=[];for(const s in t)e[s]&&i.push(e[s]);return i.sort((s,r)=>s.index-r.index),i}function ip(t,e){if(!t.autoManage)return{size:0,syncFunc:Jd};const i=tp(t.uniforms,e),{uboElements:s,size:r}=ep(i),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<s.length;a++){const o=s[a],c=t.uniforms[o.data.name],h=o.data.name;let l=!1;for(let f=0;f<bi.length;f++){const u=bi[f];if(u.codeUbo&&u.test(o.data,c)){n.push(`offset = ${o.offset/4};`,bi[f].codeUbo(o.data.name,c)),l=!0;break}}if(!l)if(o.data.size>1){const f=Yc(o.data.type),u=Math.max(ph[o.data.type]/16,1),p=f/u,m=(4-p%4)%4;n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${o.offset/4};

                t = 0;

                for(var i=0; i < ${o.data.size*u}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const f=Qd[o.data.type];n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${o.offset/4};
                ${f};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let sp=0;const Ds={textureCount:0,uboCount:0};class mh{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=sp++}systemCheck(){if(!Pd())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,i){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const s=e.program,r=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==s&&(this.program=s,this.gl.useProgram(r.program)),i||(Ds.textureCount=0,Ds.uboCount=0,this.syncUniformGroup(e.uniformGroup,Ds)),r}setUniforms(e){const i=this.shader.program,s=i.glPrograms[this.renderer.CONTEXT_UID];i.syncUniforms(s.uniformData,e,this.renderer)}syncUniformGroup(e,i){const s=this.getGlProgram();(!e.static||e.dirtyId!==s.uniformDirtyGroups[e.id])&&(s.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,s,i))}syncUniforms(e,i,s){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(i.uniformData,e.uniforms,this.renderer,s)}createSyncGroups(e){const i=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[i]||(this.cache[i]=Td(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[i],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,i){const s=this.getGlProgram();if(!e.static||e.dirtyId!==0||!s.uniformGroups[e.id]){e.dirtyId=0;const r=s.uniformGroups[e.id]||this.createSyncBufferGroup(e,s,i);e.buffer.update(),r(s.uniformData,e.uniforms,this.renderer,Ds,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,s.uniformBufferBindings[i])}createSyncBufferGroup(e,i,s){const{gl:r}=this.renderer;this.renderer.buffer.bind(e.buffer);const n=this.gl.getUniformBlockIndex(i.program,s);i.uniformBufferBindings[s]=this.shader.uniformBindCount,r.uniformBlockBinding(i.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(e,this.shader.program.uniformData,"ubo");let o=this._uboCache[a];if(o||(o=this._uboCache[a]=ip(e,this.shader.program.uniformData)),e.autoManage){const c=new Float32Array(o.size/4);e.buffer.update(c)}return i.uniformGroups[e.id]=o.syncFunc,i.uniformGroups[e.id]}getSignature(e,i,s){const r=e.uniforms,n=[`${s}-`];for(const a in r)n.push(a),i[a]&&n.push(i[a].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const i=this.gl,s=e.program,r=Zd(i,s);return s.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}mh.extension={type:N.RendererSystem,name:"shader"};V.add(mh);class Sr{constructor(e){this.renderer=e}run(e){const{renderer:i}=this;i.runners.init.emit(i.options),e.hello&&console.log(`PixiJS 7.2.4 - ${i.rendererLogId} - https://pixijs.com`),i.resize(i.screen.width,i.screen.height)}destroy(){}}Sr.defaultOptions={hello:!1};Sr.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"startup"};V.add(Sr);function rp(t,e=[]){return e[Y.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.ADD]=[t.ONE,t.ONE],e[Y.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.NONE]=[0,0],e[Y.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Y.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Y.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Y.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Y.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Y.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Y.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Y.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Y.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Y.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Y.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const np=0,ap=1,op=2,cp=3,hp=4,lp=5,qn=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Y.NONE,this._blendEq=!1,this.map=[],this.map[np]=this.setBlend,this.map[ap]=this.setOffset,this.map[op]=this.setCullFace,this.map[cp]=this.setDepthTest,this.map[hp]=this.setFrontFace,this.map[lp]=this.setDepthMask,this.checks=[],this.defaultState=new xt,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=rp(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(qn.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(qn.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};let gh=qn;gh.extension={type:N.RendererSystem,name:"state"};V.add(gh);class fp extends as{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const i=(e.priority??[]).filter(r=>e.systems[r]),s=[...i,...Object.keys(e.systems).filter(r=>!i.includes(r))];for(const r of s)this.addSystem(e.systems[r],r)}addRunners(...e){e.forEach(i=>{this.runners[i]=new Je(i)})}addSystem(e,i){const s=new e(this);if(this[i])throw new Error(`Whoops! The name "${i}" is already in use`);this[i]=s,this._systemsHash[i]=s;for(const r in this.runners)this.runners[r].add(s);return this}emitWithCustomOptions(e,i){const s=Object.keys(this._systemsHash);e.items.forEach(r=>{const n=s.find(a=>this._systemsHash[a]===r);r[e.name](i[n])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const qs=class{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=qs.defaultMaxIdle,this.checkCountMax=qs.defaultCheckCountMax,this.mode=qs.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==pa.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let i=!1;for(let s=0;s<e.length;s++){const r=e[s];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(t.destroyTexture(r,!0),e[s]=null,i=!0)}if(i){let s=0;for(let r=0;r<e.length;r++)e[r]!==null&&(e[s++]=e[r]);e.length=s}}unload(t){const e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};let Ye=qs;Ye.defaultMode=pa.AUTO;Ye.defaultMaxIdle=60*60;Ye.defaultCheckCountMax=60*10;Ye.extension={type:N.RendererSystem,name:"textureGC"};V.add(Ye);class ln{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=z.UNSIGNED_BYTE,this.internalFormat=F.RGBA,this.samplerType=0}}function up(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[z.UNSIGNED_BYTE]:{[F.RGBA]:t.RGBA8,[F.RGB]:t.RGB8,[F.RG]:t.RG8,[F.RED]:t.R8,[F.RGBA_INTEGER]:t.RGBA8UI,[F.RGB_INTEGER]:t.RGB8UI,[F.RG_INTEGER]:t.RG8UI,[F.RED_INTEGER]:t.R8UI,[F.ALPHA]:t.ALPHA,[F.LUMINANCE]:t.LUMINANCE,[F.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[z.BYTE]:{[F.RGBA]:t.RGBA8_SNORM,[F.RGB]:t.RGB8_SNORM,[F.RG]:t.RG8_SNORM,[F.RED]:t.R8_SNORM,[F.RGBA_INTEGER]:t.RGBA8I,[F.RGB_INTEGER]:t.RGB8I,[F.RG_INTEGER]:t.RG8I,[F.RED_INTEGER]:t.R8I},[z.UNSIGNED_SHORT]:{[F.RGBA_INTEGER]:t.RGBA16UI,[F.RGB_INTEGER]:t.RGB16UI,[F.RG_INTEGER]:t.RG16UI,[F.RED_INTEGER]:t.R16UI,[F.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[z.SHORT]:{[F.RGBA_INTEGER]:t.RGBA16I,[F.RGB_INTEGER]:t.RGB16I,[F.RG_INTEGER]:t.RG16I,[F.RED_INTEGER]:t.R16I},[z.UNSIGNED_INT]:{[F.RGBA_INTEGER]:t.RGBA32UI,[F.RGB_INTEGER]:t.RGB32UI,[F.RG_INTEGER]:t.RG32UI,[F.RED_INTEGER]:t.R32UI,[F.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[z.INT]:{[F.RGBA_INTEGER]:t.RGBA32I,[F.RGB_INTEGER]:t.RGB32I,[F.RG_INTEGER]:t.RG32I,[F.RED_INTEGER]:t.R32I},[z.FLOAT]:{[F.RGBA]:t.RGBA32F,[F.RGB]:t.RGB32F,[F.RG]:t.RG32F,[F.RED]:t.R32F,[F.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[z.HALF_FLOAT]:{[F.RGBA]:t.RGBA16F,[F.RGB]:t.RGB16F,[F.RG]:t.RG16F,[F.RED]:t.R16F},[z.UNSIGNED_SHORT_5_6_5]:{[F.RGB]:t.RGB565},[z.UNSIGNED_SHORT_4_4_4_4]:{[F.RGBA]:t.RGBA4},[z.UNSIGNED_SHORT_5_5_5_1]:{[F.RGBA]:t.RGB5_A1},[z.UNSIGNED_INT_2_10_10_10_REV]:{[F.RGBA]:t.RGB10_A2,[F.RGBA_INTEGER]:t.RGB10_A2UI},[z.UNSIGNED_INT_10F_11F_11F_REV]:{[F.RGB]:t.R11F_G11F_B10F},[z.UNSIGNED_INT_5_9_9_9_REV]:{[F.RGB]:t.RGB9_E5},[z.UNSIGNED_INT_24_8]:{[F.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[z.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[F.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[z.UNSIGNED_BYTE]:{[F.RGBA]:t.RGBA,[F.RGB]:t.RGB,[F.ALPHA]:t.ALPHA,[F.LUMINANCE]:t.LUMINANCE,[F.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[z.UNSIGNED_SHORT_5_6_5]:{[F.RGB]:t.RGB},[z.UNSIGNED_SHORT_4_4_4_4]:{[F.RGBA]:t.RGBA},[z.UNSIGNED_SHORT_5_5_5_1]:{[F.RGBA]:t.RGBA}},e}class yh{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new q,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=up(e);const i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=i;for(let r=0;r<i;r++)this.boundTextures[r]=null;this.emptyTextures={};const s=new ln(e.createTexture());e.bindTexture(e.TEXTURE_2D,s.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=s,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new ln(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(e,i=0){const{gl:s}=this;if(e=e==null?void 0:e.castToBaseTexture(),e!=null&&e.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[i]!==e&&(this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),s.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[i]=e}else this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[i]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:i,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<s.length;r++)s[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<s.length;r++)s[r]===e&&(this.currentLocation!==r&&(i.activeTexture(i.TEXTURE0+r),this.currentLocation=r),i.bindTexture(e.target,this.emptyTextures[e.target].texture),s[r]=null)}ensureSamplerType(e){const{boundTextures:i,hasIntegerTextures:s,CONTEXT_UID:r}=this;if(s)for(let n=e-1;n>=0;--n){const a=i[n];a&&a._glTextures[r].samplerType!==An.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(e){const i=new ln(this.gl.createTexture());return i.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=i,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),i}initTextureType(e,i){var s;i.internalFormat=((s=this.internalFormats[e.type])==null?void 0:s[e.format])??e.format,this.webGLVersion===2&&e.type===z.HALF_FLOAT?i.type=this.gl.HALF_FLOAT:i.type=e.type}updateTexture(e){var r;const i=e._glTextures[this.CONTEXT_UID];if(!i)return;const s=this.renderer;if(this.initTextureType(e,i),(r=e.resource)!=null&&r.upload(s,e,i))i.samplerType!==An.FLOAT&&(this.hasIntegerTextures=!0);else{const n=e.realWidth,a=e.realHeight,o=s.gl;(i.width!==n||i.height!==a||i.dirtyId<0)&&(i.width=n,i.height=a,o.texImage2D(e.target,0,i.internalFormat,n,a,0,e.format,i.type,null))}e.dirtyStyleId!==i.dirtyStyleId&&this.updateTextureStyle(e),i.dirtyId=e.dirtyId}destroyTexture(e,i){const{gl:s}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),s.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!i)){const r=this.managedTextures.indexOf(e);r!==-1&&_i(this.managedTextures,r,1)}}updateTextureStyle(e){var s;const i=e._glTextures[this.CONTEXT_UID];i&&((e.mipmap===ut.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?i.mipmap=!1:i.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?i.wrapMode=Rt.CLAMP:i.wrapMode=e.wrapMode,(s=e.resource)!=null&&s.style(this.renderer,e,i)||this.setStyle(e,i),i.dirtyStyleId=e.dirtyStyleId)}setStyle(e,i){const s=this.gl;if(i.mipmap&&e.mipmap!==ut.ON_MANUAL&&s.generateMipmap(e.target),s.texParameteri(e.target,s.TEXTURE_WRAP_S,i.wrapMode),s.texParameteri(e.target,s.TEXTURE_WRAP_T,i.wrapMode),i.mipmap){s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===De.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===De.LINEAR){const n=Math.min(e.anisotropicLevel,s.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===De.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(e.target,s.TEXTURE_MAG_FILTER,e.scaleMode===De.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}yh.extension={type:N.RendererSystem,name:"texture"};V.add(yh);class _h{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:i,CONTEXT_UID:s}=this,r=e._glTransformFeedbacks[s]||this.createGLTransformFeedback(e);i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,i){const{gl:s,renderer:r}=this;i&&r.shader.bind(i),s.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:i,renderer:s,CONTEXT_UID:r}=this,n=i.createTransformFeedback();e._glTransformFeedbacks[r]=n,i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,n);for(let a=0;a<e.buffers.length;a++){const o=e.buffers[a];o&&(s.buffer.update(o),o._glBuffers[r].refCount++,i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,a,o._glBuffers[r].buffer||null))}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),n}disposeTransformFeedback(e,i){const s=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let a=0;a<e.buffers.length;a++){const o=e.buffers[a];if(!o)continue;const c=o._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!i&&n.dispose(o,i))}s&&(i||r.deleteTransformFeedback(s),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}_h.extension={type:N.RendererSystem,name:"transformFeedback"};V.add(_h);class Ar{constructor(e){this.renderer=e}init(e){this.screen=new K(0,0,e.width,e.height),this.element=e.view||L.ADAPTER.createCanvas(),this.resolution=e.resolution||L.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,i){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(i*this.resolution);const s=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=s,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",s,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var i;e&&((i=this.element.parentNode)==null||i.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Ar.defaultOptions={width:800,height:600,resolution:L.RESOLUTION,autoDensity:!1};Ar.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"_view"};V.add(Ar);L.PREFER_ENV=Zt.WEBGL2;L.STRICT_TEXTURE_CACHE=!1;L.RENDER_OPTIONS={...wr.defaultOptions,...Tr.defaultOptions,...Ar.defaultOptions,...Sr.defaultOptions};Object.defineProperties(L,{WRAP_MODE:{get(){return q.defaultOptions.wrapMode},set(t){te("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),q.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return q.defaultOptions.scaleMode},set(t){te("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),q.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return q.defaultOptions.mipmap},set(t){te("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),q.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return q.defaultOptions.anisotropicLevel},set(t){te("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),q.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return te("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Se.defaultResolution},set(t){Se.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return te("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Se.defaultMultisample},set(t){Se.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return je.defaultMaxTextures},set(t){te("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),je.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return je.defaultBatchSize},set(t){te("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),je.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return je.canUploadSameBuffer},set(t){te("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),je.canUploadSameBuffer=t}},GC_MODE:{get(){return Ye.defaultMode},set(t){te("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Ye.defaultMode=t}},GC_MAX_IDLE:{get(){return Ye.defaultMaxIdle},set(t){te("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Ye.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return Ye.defaultCheckCountMax},set(t){te("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Ye.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Ke.defaultVertexPrecision},set(t){te("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ke.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Ke.defaultFragmentPrecision},set(t){te("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ke.defaultFragmentPrecision=t}}});var Kt=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Kt||{});class fn{constructor(e,i=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=i,this.priority=s,this.once=r}match(e,i=null){return this.fn===e&&this.context===i}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const i=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),i}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const i=this.next;return this.next=e?null:i,this.previous=null,i}}const Oe=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new fn(null,null,1/0),this.deltaMS=1/Oe.targetFPMS,this.elapsedMS=1/Oe.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=Kt.NORMAL){return this._addListener(new fn(t,e,i))}addOnce(t,e,i=Kt.NORMAL){return this._addListener(new fn(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Oe.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Oe.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Oe._shared){const t=Oe._shared=new Oe;t.autoStart=!0,t._protected=!0}return Oe._shared}static get system(){if(!Oe._system){const t=Oe._system=new Oe;t.autoStart=!0,t._protected=!0}return Oe._system}};let Ce=Oe;Ce.targetFPMS=.06;Object.defineProperties(L,{TARGET_FPMS:{get(){return Ce.targetFPMS},set(t){te("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ce.targetFPMS=t}}});class vh{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,Kt.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Ce.shared:new Ce,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}vh.extension=N.Application;V.add(vh);const bh=[];V.handleByList(N.Renderer,bh);function dp(t){for(const e of bh)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var pp=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,mp=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const gp=pp,xh=mp;class Eh{constructor(e){this.renderer=e}contextChange(e){let i;if(this.renderer.context.webGLVersion===1){const s=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,s)}else{const s=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,s)}i>=me.HIGH?this.multisample=me.HIGH:i>=me.MEDIUM?this.multisample=me.MEDIUM:i>=me.LOW?this.multisample=me.LOW:this.multisample=me.NONE}destroy(){}}Eh.extension={type:N.RendererSystem,name:"_multisample"};V.add(Eh);class yp{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Th{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:i,CONTEXT_UID:s}=this,r=e._glBuffers[s]||this.createGLBuffer(e);i.bindBuffer(e.type,r.buffer)}unbind(e){const{gl:i}=this;i.bindBuffer(e,null)}bindBufferBase(e,i){const{gl:s,CONTEXT_UID:r}=this;if(this.boundBufferBases[i]!==e){const n=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[i]=e,s.bindBufferBase(s.UNIFORM_BUFFER,i,n.buffer)}}bindBufferRange(e,i,s){const{gl:r,CONTEXT_UID:n}=this;s=s||0;const a=e._glBuffers[n]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,i||0,a.buffer,s*256,256)}update(e){const{gl:i,CONTEXT_UID:s}=this,r=e._glBuffers[s]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,i.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)i.bufferSubData(e.type,0,e.data);else{const n=e.static?i.STATIC_DRAW:i.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,i.bufferData(e.type,e.data,n)}}dispose(e,i){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const s=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),s&&(i||r.deleteBuffer(s.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const i=Object.keys(this.managedBuffers);for(let s=0;s<i.length;s++)this.dispose(this.managedBuffers[i[s]],e)}createGLBuffer(e){const{CONTEXT_UID:i,gl:s}=this;return e._glBuffers[i]=new yp(s.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[i]}}Th.extension={type:N.RendererSystem,name:"buffer"};V.add(Th);class wh{constructor(e){this.renderer=e}render(e,i){const s=this.renderer;let r,n,a,o;if(i&&(r=i.renderTexture,n=i.clear,a=i.transform,o=i.skipUpdateTransform),this.renderingToScreen=!r,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=a,!s.context.isLost){if(r||(this.lastObjectRendered=e),!o){const c=e.enableTempParent();e.updateTransform(),e.disableTempParent(c)}s.renderTexture.bind(r),s.batch.currentRenderer.start(),(n??s.background.clearBeforeRender)&&s.renderTexture.clear(),e.render(s),s.batch.currentRenderer.flush(),r&&(i.blit&&s.framebuffer.blit(),r.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}wh.extension={type:N.RendererSystem,name:"objectRenderer"};V.add(wh);const Kn=class extends fp{constructor(t){super(),this.type=fc.WEBGL,t=Object.assign({},L.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Qe({projectionMatrix:new ce},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Kn.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(te("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=Kn.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:Gu()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return te("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return te("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return te("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return te("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};let Pi=Kn;Pi.extension={type:N.Renderer,priority:1};Pi.__plugins={};Pi.__systems={};V.handleByMap(N.RendererPlugin,Pi.__plugins);V.handleByMap(N.RendererSystem,Pi.__systems);V.add(Pi);class Sh extends ss{constructor(e,i){const{width:s,height:r}=i||{};super(s,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<e;n++){const a=new q;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,i){for(let s=0;s<this.length;s++)e[s]&&(e[s].castToBaseTexture?this.addBaseTextureAt(e[s].castToBaseTexture(),s):e[s]instanceof ss?this.addResourceAt(e[s],s):this.addResourceAt(Uc(e[s],i),s))}dispose(){for(let e=0,i=this.length;e<i;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,i){if(!this.items[i])throw new Error(`Index ${i} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[i].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=e,this.items[i].on("update",e.update,e)}unbind(e){super.unbind(e);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",e.update,e)}load(){if(this._load)return this._load;const i=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(i).then(()=>{const{realWidth:s,realHeight:r}=this.items[0];return this.resize(s,r),Promise.resolve(this)}),this._load}}class _p extends Sh{constructor(e,i){const{width:s,height:r}=i||{};let n,a;Array.isArray(e)?(n=e,a=e.length):a=e,super(a,{width:s,height:r}),n&&this.initFromArray(n,i)}addBaseTextureAt(e,i){if(e.resource)this.addResourceAt(e.resource,i);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=pi.TEXTURE_2D_ARRAY}upload(e,i,s){const{length:r,itemDirtyIds:n,items:a}=this,{gl:o}=e;s.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,r,0,i.format,s.type,null);for(let c=0;c<r;c++){const h=a[c];n[c]<h.dirtyId&&(n[c]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,c,h.resource.width,h.resource.height,1,i.format,s.type,h.resource.source))}return!0}}class vp extends Bt{constructor(e){super(e)}static test(e){const{OffscreenCanvas:i}=globalThis;return i&&e instanceof i?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const Xi=class extends Sh{constructor(t,e){const{width:i,height:s,autoLoad:r,linkBaseTexture:n}=e||{};if(t&&t.length!==Xi.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:s});for(let a=0;a<Xi.SIDES;a++)this.items[a].target=pi.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=n!==!1,t&&this.initFromArray(t,e),r!==!1&&this.load()}bind(t){super.bind(t),t.target=pi.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=pi.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){const s=this.itemDirtyIds;for(let r=0;r<Xi.SIDES;r++){const n=this.items[r];(s[r]<n.dirtyId||i.dirtyId<e.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(t,n,i),s[r]=n.dirtyId):s[r]<-1&&(t.gl.texImage2D(n.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),s[r]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Xi.SIDES}};let Ah=Xi;Ah.SIDES=6;class di extends Bt{constructor(e,i){i=i||{};let s,r;typeof e=="string"?(s=di.EMPTY,r=e):(s=e,r=null),super(s),this.url=r,this.crossOrigin=i.crossOrigin??!0,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this._load=null,i.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,i)=>{if(this.url===null){e(this);return}try{const s=await L.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await s.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===et.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),e(this)}catch(s){if(this.destroyed)return;i(s),this.onError.emit(s)}}),this._load)}upload(e,i,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),super.upload(e,i,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return di._EMPTY=di._EMPTY??L.ADAPTER.createCanvas(0,0),di._EMPTY}}const Ks=class extends Bt{constructor(t,e){e=e||{},super(L.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},Ks.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;Bt.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,r=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/i*e,r=this._overrideHeight||this._overrideWidth/e*i),s=Math.round(s),r=Math.round(r);const n=this.source;n.width=s,n.height=r,n._pixiId=`canvas_${qt()}`,n.getContext("2d").drawImage(t,0,0,e,i,0,0,s,r),this._resolve(),this._resolve=null}}static getSize(t){const e=Ks.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&Ks.SVG_XML.test(t)}};let rs=Ks;rs.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;rs.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Zn=class extends Bt{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);const s=t[0].src||t[0];Bt.crossOrigin(i,s,e.crossorigin);for(let r=0;r<t.length;++r){const n=document.createElement("source");let{src:a,mime:o}=t[r];a=a||t[r];const c=a.split("?").shift().toLowerCase(),h=c.slice(c.lastIndexOf(".")+1);o=o||Zn.MIME_TYPES[h]||`video/${h}`,n.src=a,n.type=o,i.appendChild(n)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){const e=Ce.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(e=>{this.valid?e(this):(this._resolve=e,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ce.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Ce.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(Ce.shared.remove(this.update,this),this._isConnectedToTicker=!1);const t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ce.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ce.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Zn.TYPES.includes(e)}};let Aa=Zn;Aa.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Aa.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Vn.push(di,Jc,vp,Aa,rs,cs,Ah,_p);class hr{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?K.EMPTY:(e=e||new K(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,i){const{a:s,b:r,c:n,d:a,tx:o,ty:c}=e,h=s*i.x+n*i.y+o,l=r*i.x+a*i.y+c;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)}addQuad(e){let i=this.minX,s=this.minY,r=this.maxX,n=this.maxY,a=e[0],o=e[1];i=a<i?a:i,s=o<s?o:s,r=a>r?a:r,n=o>n?o:n,a=e[2],o=e[3],i=a<i?a:i,s=o<s?o:s,r=a>r?a:r,n=o>n?o:n,a=e[4],o=e[5],i=a<i?a:i,s=o<s?o:s,r=a>r?a:r,n=o>n?o:n,a=e[6],o=e[7],i=a<i?a:i,s=o<s?o:s,r=a>r?a:r,n=o>n?o:n,this.minX=i,this.minY=s,this.maxX=r,this.maxY=n}addFrame(e,i,s,r,n){this.addFrameMatrix(e.worldTransform,i,s,r,n)}addFrameMatrix(e,i,s,r,n){const a=e.a,o=e.b,c=e.c,h=e.d,l=e.tx,f=e.ty;let u=this.minX,p=this.minY,m=this.maxX,b=this.maxY,_=a*i+c*s+l,T=o*i+h*s+f;u=_<u?_:u,p=T<p?T:p,m=_>m?_:m,b=T>b?T:b,_=a*r+c*s+l,T=o*r+h*s+f,u=_<u?_:u,p=T<p?T:p,m=_>m?_:m,b=T>b?T:b,_=a*i+c*n+l,T=o*i+h*n+f,u=_<u?_:u,p=T<p?T:p,m=_>m?_:m,b=T>b?T:b,_=a*r+c*n+l,T=o*r+h*n+f,u=_<u?_:u,p=T<p?T:p,m=_>m?_:m,b=T>b?T:b,this.minX=u,this.minY=p,this.maxX=m,this.maxY=b}addVertexData(e,i,s){let r=this.minX,n=this.minY,a=this.maxX,o=this.maxY;for(let c=i;c<s;c+=2){const h=e[c],l=e[c+1];r=h<r?h:r,n=l<n?l:n,a=h>a?h:a,o=l>o?l:o}this.minX=r,this.minY=n,this.maxX=a,this.maxY=o}addVertices(e,i,s,r){this.addVerticesMatrix(e.worldTransform,i,s,r)}addVerticesMatrix(e,i,s,r,n=0,a=n){const o=e.a,c=e.b,h=e.c,l=e.d,f=e.tx,u=e.ty;let p=this.minX,m=this.minY,b=this.maxX,_=this.maxY;for(let T=s;T<r;T+=2){const g=i[T],d=i[T+1],v=o*g+h*d+f,w=l*d+c*g+u;p=Math.min(p,v-n),b=Math.max(b,v+n),m=Math.min(m,w-a),_=Math.max(_,w+a)}this.minX=p,this.minY=m,this.maxX=b,this.maxY=_}addBounds(e){const i=this.minX,s=this.minY,r=this.maxX,n=this.maxY;this.minX=e.minX<i?e.minX:i,this.minY=e.minY<s?e.minY:s,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>n?e.maxY:n}addBoundsMask(e,i){const s=e.minX>i.minX?e.minX:i.minX,r=e.minY>i.minY?e.minY:i.minY,n=e.maxX<i.maxX?e.maxX:i.maxX,a=e.maxY<i.maxY?e.maxY:i.maxY;if(s<=n&&r<=a){const o=this.minX,c=this.minY,h=this.maxX,l=this.maxY;this.minX=s<o?s:o,this.minY=r<c?r:c,this.maxX=n>h?n:h,this.maxY=a>l?a:l}}addBoundsMatrix(e,i){this.addFrameMatrix(i,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,i){const s=e.minX>i.x?e.minX:i.x,r=e.minY>i.y?e.minY:i.y,n=e.maxX<i.x+i.width?e.maxX:i.x+i.width,a=e.maxY<i.y+i.height?e.maxY:i.y+i.height;if(s<=n&&r<=a){const o=this.minX,c=this.minY,h=this.maxX,l=this.maxY;this.minX=s<o?s:o,this.minY=r<c?r:c,this.maxX=n>h?n:h,this.maxY=a>l?a:l}}pad(e=0,i=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=i,this.maxY+=i)}addFramePad(e,i,s,r,n,a){e-=n,i-=a,s+=n,r+=a,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<i?this.minY:i,this.maxY=this.maxY>r?this.maxY:r}}class fe extends as{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Sa,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new hr,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const i=Object.keys(e);for(let s=0;s<i.length;++s){const r=i[s];Object.defineProperty(fe.prototype,r,Object.getOwnPropertyDescriptor(e,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,i){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),i||(this._boundsRect||(this._boundsRect=new K),i=this._boundsRect),this._bounds.getRectangle(i)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new K),e=this._localBoundsRect),this._localBounds||(this._localBounds=new hr);const i=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const a=this.getBounds(!1,e);return this.parent=s,this.transform=i,this._bounds=r,this._bounds.updateID+=this._boundsID-n,a}toGlobal(e,i,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,i)}toLocal(e,i,s,r){return i&&(e=i.toGlobal(e,s,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,s)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,i=0,s=1,r=1,n=0,a=0,o=0,c=0,h=0){return this.position.x=e,this.position.y=i,this.scale.x=s||1,this.scale.y=r||1,this.rotation=n,this.skew.x=a,this.skew.y=o,this.pivot.x=c,this.pivot.y=h,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new bp),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*pd}set angle(e){this.transform.rotation=e*md}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount--,i._maskRefCount===0&&(i.renderable=!0,i.isMask=!1))}if(this._mask=e,this._mask){const i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount===0&&(i.renderable=!1,i.isMask=!0),i._maskRefCount++)}}}}class bp extends fe{constructor(){super(...arguments),this.sortDirty=null}}fe.prototype.displayObjectUpdateTransform=fe.prototype.updateTransform;const xp=new ce;function Ep(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const Jn=class extends fe{constructor(){super(),this.children=[],this.sortableChildren=Jn.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),s=this.getChildIndex(e);this.children[i]=e,this.children[s]=t,this.onChildrenChange(i<s?i:s)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(t);_i(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,_i(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,_i(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=t,s=e,r=s-i;let n;if(r>0&&r<=s){n=this.children.splice(i,r);for(let a=0;a<n.length;++a)n[a].parent=null,n[a].transform&&(n[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let a=0;a<n.length;++a)n[a].emit("removed",this),this.emit("childRemoved",n[a],this,a);return n}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){const s=this.children[e];s._lastSortedIndex=e,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(Ep),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const i=this.children[t];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const i=super.getLocalBounds(t);if(!e)for(let s=0,r=this.children.length;s<r;++s){const n=this.children[s];n.visible&&n.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,s;this.cullArea?(i=this.cullArea,s=this.worldTransform):this._render!==Jn.prototype._render&&(i=this.getBounds(!0));const r=t.projection.transform;if(r&&(s?(s=xp.copyFrom(s),s.prepend(r)):s=r),i&&e.intersects(i,s))this._render(t);else if(this.cullArea)return;for(let n=0,a=this.children.length;n<a;++n){const o=this.children[n],c=o.cullable;o.cullable=c||!this.cullArea,o.render(t),o.cullable=c}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let i=0,s=this.children.length;i<s;++i)this.children[i].render(t)}}renderAdvanced(t){var r,n,a;const e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let o=0;o<e.length;o++)e[o].enabled&&this._enabledFilters.push(e[o])}const s=e&&((r=this._enabledFilters)==null?void 0:r.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==ye.NONE));if(s&&t.batch.flush(),e&&((n=this._enabledFilters)!=null&&n.length)&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let o=0,c=this.children.length;o<c;++o)this.children[o].render(t)}s&&t.batch.flush(),i&&t.mask.pop(this),e&&((a=this._enabledFilters)!=null&&a.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,i=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<i.length;++s)i[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};let Le=Jn;Le.defaultSortableChildren=!1;Le.prototype.containerUpdateTransform=Le.prototype.updateTransform;Object.defineProperties(L,{SORTABLE_CHILDREN:{get(){return Le.defaultSortableChildren},set(t){te("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Le.defaultSortableChildren=t}}});const ki=new ie,Tp=new Uint16Array([0,1,2,0,2,3]);class Et extends Le{constructor(e){super(),this._anchor=new It(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new ne(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=Y.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||G.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Tp,this.pluginName="batch",this.isSprite=!0,this._roundPixels=L.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Pt(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Pt(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const i=this.transform.worldTransform,s=i.a,r=i.b,n=i.c,a=i.d,o=i.tx,c=i.ty,h=this.vertexData,l=e.trim,f=e.orig,u=this._anchor;let p=0,m=0,b=0,_=0;if(l?(m=l.x-u._x*f.width,p=m+l.width,_=l.y-u._y*f.height,b=_+l.height):(m=-u._x*f.width,p=m+f.width,_=-u._y*f.height,b=_+f.height),h[0]=s*m+n*_+o,h[1]=a*_+r*m+c,h[2]=s*p+n*_+o,h[3]=a*_+r*p+c,h[4]=s*p+n*b+o,h[5]=a*b+r*p+c,h[6]=s*m+n*b+o,h[7]=a*b+r*m+c,this._roundPixels){const T=L.RESOLUTION;for(let g=0;g<h.length;++g)h[g]=Math.round(h[g]*T)/T}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,i=this.vertexTrimmedData,s=e.orig,r=this._anchor,n=this.transform.worldTransform,a=n.a,o=n.b,c=n.c,h=n.d,l=n.tx,f=n.ty,u=-r._x*s.width,p=u+s.width,m=-r._y*s.height,b=m+s.height;i[0]=a*u+c*m+l,i[1]=h*m+o*u+f,i[2]=a*p+c*m+l,i[3]=h*m+o*p+f,i[4]=a*p+c*b+l,i[5]=h*b+o*p+f,i[6]=a*u+c*b+l,i[7]=h*b+o*u+f}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,i=this._texture.orig;!e||e.width===i.width&&e.height===i.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new hr),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new K),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,ki);const i=this._texture.orig.width,s=this._texture.orig.height,r=-i*this.anchor.x;let n=0;return ki.x>=r&&ki.x<r+i&&(n=-s*this.anchor.y,ki.y>=n&&ki.y<n+s)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const s=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!s)}this._texture=null}static from(e,i){const s=e instanceof G?e:G.from(e,i);return new Et(s)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const i=Pt(this.scale.x)||1;this.scale.x=i*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const i=Pt(this.scale.y)||1;this.scale.y=i*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||G.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const Ch=new ce;fe.prototype._cacheAsBitmap=!1;fe.prototype._cacheData=null;fe.prototype._cacheAsBitmapResolution=null;fe.prototype._cacheAsBitmapMultisample=null;class wp{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(fe.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new wp),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});fe.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))};fe.prototype._initCachedDisplayObject=function(e){var u,p;if((u=this._cacheData)!=null&&u.sprite)return;const i=this.alpha;this.alpha=1,e.batch.flush();const s=this.getLocalBounds(null,!0).clone();if((p=this.filters)!=null&&p.length){const m=this.filters[0].padding;s.pad(m)}s.ceil(L.RESOLUTION);const r=e.renderTexture.current,n=e.renderTexture.sourceFrame.clone(),a=e.renderTexture.destinationFrame.clone(),o=e.projection.transform,c=Jt.create({width:s.width,height:s.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:this.cacheAsBitmapMultisample??e.multisample}),h=`cacheAsBitmap_${qt()}`;this._cacheData.textureCacheId=h,q.addToCache(c.baseTexture,h),G.addToCache(c,h);const l=this.transform.localTransform.copyTo(Ch).invert().translate(-s.x,-s.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:c,clear:!0,transform:l,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=o,e.renderTexture.bind(r,n,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const f=new Et(c);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(s.x/s.width),f.anchor.y=-(s.y/s.height),f.alpha=i,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)};fe.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))};fe.prototype._initCachedDisplayObjectCanvas=function(e){var l;if((l=this._cacheData)!=null&&l.sprite)return;const i=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;const r=e.canvasContext.activeContext,n=e._projTransform;i.ceil(L.RESOLUTION);const a=Jt.create({width:i.width,height:i.height}),o=`cacheAsBitmap_${qt()}`;this._cacheData.textureCacheId=o,q.addToCache(a.baseTexture,o),G.addToCache(a,o);const c=Ch;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=i.x,c.ty-=i.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:a,clear:!0,transform:c,skipUpdateTransform:!1}),e.canvasContext.activeContext=r,e._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const h=new Et(a);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(i.x/i.width),h.anchor.y=-(i.y/i.height),h.alpha=s,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};fe.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};fe.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};fe.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,q.removeFromCache(this._cacheData.textureCacheId),G.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};fe.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)};fe.prototype.name=null;Le.prototype.getChildByName=function(e,i){for(let s=0,r=this.children.length;s<r;s++)if(this.children[s].name===e)return this.children[s];if(i)for(let s=0,r=this.children.length;s<r;s++){const n=this.children[s];if(!n.getChildByName)continue;const a=n.getChildByName(e,!0);if(a)return a}return null};fe.prototype.getGlobalPosition=function(e=new ie,i=!1){return this.parent?this.parent.toGlobal(this.position,e,i):(e.x=this.position.x,e.y=this.position.y),e};var Sp=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class Ap extends Se{constructor(e=1){super(gp,Sp,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const Cp={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Pp=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Ip(t){const e=Cp[t],i=e.length;let s=Pp,r="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let a;for(let o=0;o<t;o++){let c=n.replace("%index%",o.toString());a=o,o>=i&&(a=t-o-1),c=c.replace("%value%",e[a].toString()),r+=c,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",t.toString()),s}const Rp=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Mp(t,e){const i=Math.ceil(t/2);let s=Rp,r="",n;e?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<t;a++){let o=n.replace("%index%",a.toString());o=o.replace("%sampleIndex%",`${a-(i-1)}.0`),r+=o,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",t.toString()),s}class Qn extends Se{constructor(e,i=8,s=4,r=Se.defaultResolution,n=5){const a=Mp(n,e),o=Ip(n);super(a,o),this.horizontal=e,this.resolution=r,this._quality=0,this.quality=s,this.blur=i}apply(e,i,s,r){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/i.width):this.uniforms.strength=1/s.height*(s.height/i.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/i.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/i.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,i,s,r);else{const n=e.getFilterTexture(),a=e.renderer;let o=i,c=n;this.state.blend=!1,e.applyFilter(this,o,c,at.CLEAR);for(let h=1;h<this.passes-1;h++){e.bindAndClear(o,at.BLIT),this.uniforms.uSampler=c;const l=c;c=o,o=l,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,c,s,r),e.returnFilterTexture(n)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class Dp extends Se{constructor(e=8,i=4,s=Se.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Qn(!0,e,i,s,r),this.blurYFilter=new Qn(!1,e,i,s,r),this.resolution=s,this.quality=i,this.blur=e,this.repeatEdgePixels=!1}apply(e,i,s,r){const n=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(n&&a){const o=e.getFilterTexture();this.blurXFilter.apply(e,i,o,at.CLEAR),this.blurYFilter.apply(e,o,s,r),e.returnFilterTexture(o)}else a?this.blurYFilter.apply(e,i,s,r):this.blurXFilter.apply(e,i,s,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var Bp=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ea extends Se{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(xh,Bp,e),this.alpha=1}_loadMatrix(e,i=!1){let s=e;i&&(this._multiply(s,this.uniforms.m,e),s=this._colorMatrix(s)),this.uniforms.m=s}_multiply(e,i,s){return e[0]=i[0]*s[0]+i[1]*s[5]+i[2]*s[10]+i[3]*s[15],e[1]=i[0]*s[1]+i[1]*s[6]+i[2]*s[11]+i[3]*s[16],e[2]=i[0]*s[2]+i[1]*s[7]+i[2]*s[12]+i[3]*s[17],e[3]=i[0]*s[3]+i[1]*s[8]+i[2]*s[13]+i[3]*s[18],e[4]=i[0]*s[4]+i[1]*s[9]+i[2]*s[14]+i[3]*s[19]+i[4],e[5]=i[5]*s[0]+i[6]*s[5]+i[7]*s[10]+i[8]*s[15],e[6]=i[5]*s[1]+i[6]*s[6]+i[7]*s[11]+i[8]*s[16],e[7]=i[5]*s[2]+i[6]*s[7]+i[7]*s[12]+i[8]*s[17],e[8]=i[5]*s[3]+i[6]*s[8]+i[7]*s[13]+i[8]*s[18],e[9]=i[5]*s[4]+i[6]*s[9]+i[7]*s[14]+i[8]*s[19]+i[9],e[10]=i[10]*s[0]+i[11]*s[5]+i[12]*s[10]+i[13]*s[15],e[11]=i[10]*s[1]+i[11]*s[6]+i[12]*s[11]+i[13]*s[16],e[12]=i[10]*s[2]+i[11]*s[7]+i[12]*s[12]+i[13]*s[17],e[13]=i[10]*s[3]+i[11]*s[8]+i[12]*s[13]+i[13]*s[18],e[14]=i[10]*s[4]+i[11]*s[9]+i[12]*s[14]+i[13]*s[19]+i[14],e[15]=i[15]*s[0]+i[16]*s[5]+i[17]*s[10]+i[18]*s[15],e[16]=i[15]*s[1]+i[16]*s[6]+i[17]*s[11]+i[18]*s[16],e[17]=i[15]*s[2]+i[16]*s[7]+i[17]*s[12]+i[18]*s[17],e[18]=i[15]*s[3]+i[16]*s[8]+i[17]*s[13]+i[18]*s[18],e[19]=i[15]*s[4]+i[16]*s[9]+i[17]*s[14]+i[18]*s[19]+i[19],e}_colorMatrix(e){const i=new Float32Array(e);return i[4]/=255,i[9]/=255,i[14]/=255,i[19]/=255,i}brightness(e,i){const s=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(s,i)}tint(e,i){const[s,r,n]=ne.shared.setValue(e).toArray(),a=[s,0,0,0,0,0,r,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(a,i)}greyscale(e,i){const s=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(s,i)}blackAndWhite(e){const i=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(i,e)}hue(e,i){e=(e||0)/180*Math.PI;const s=Math.cos(e),r=Math.sin(e),n=Math.sqrt,a=1/3,o=n(a),c=s+(1-s)*a,h=a*(1-s)-o*r,l=a*(1-s)+o*r,f=a*(1-s)+o*r,u=s+a*(1-s),p=a*(1-s)-o*r,m=a*(1-s)-o*r,b=a*(1-s)+o*r,_=s+a*(1-s),T=[c,h,l,0,0,f,u,p,0,0,m,b,_,0,0,0,0,0,1,0];this._loadMatrix(T,i)}contrast(e,i){const s=(e||0)+1,r=-.5*(s-1),n=[s,0,0,0,r,0,s,0,0,r,0,0,s,0,r,0,0,0,1,0];this._loadMatrix(n,i)}saturate(e=0,i){const s=e*2/3+1,r=(s-1)*-.5,n=[s,r,r,0,0,r,s,r,0,0,r,r,s,0,0,0,0,0,1,0];this._loadMatrix(n,i)}desaturate(){this.saturate(-1)}negative(e){const i=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(i,e)}sepia(e){const i=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(i,e)}technicolor(e){const i=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(i,e)}polaroid(e){const i=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(i,e)}toBGR(e){const i=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(i,e)}kodachrome(e){const i=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(i,e)}browni(e){const i=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(i,e)}vintage(e){const i=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(i,e)}colorTone(e,i,s,r,n){e=e||.2,i=i||.15,s=s||16770432,r=r||3375104;const a=ne.shared,[o,c,h]=a.setValue(s).toArray(),[l,f,u]=a.setValue(r).toArray(),p=[.3,.59,.11,0,0,o,c,h,e,0,l,f,u,i,0,o-l,c-f,h-u,0,0];this._loadMatrix(p,n)}night(e,i){e=e||.1;const s=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(s,i)}predator(e,i){const s=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(s,i)}lsd(e){const i=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(i,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}ea.prototype.grayscale=ea.prototype.greyscale;var Op=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,Fp=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class Lp extends Se{constructor(e,i){const s=new ce;e.renderable=!1,super(Fp,Op,{mapSampler:e._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=s,i==null&&(i=20),this.scale=new ie(i,i)}apply(e,i,s,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,a=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);a!==0&&o!==0&&(this.uniforms.rotation[0]=n.a/a,this.uniforms.rotation[1]=n.b/a,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),e.applyFilter(this,i,s,r)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var Np=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,kp=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Up extends Se{constructor(){super(kp,Np)}}var Gp=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class Hp extends Se{constructor(e=.5,i=Math.random()){super(xh,Gp,{uNoise:0,uSeed:0}),this.noise=e,this.seed=i}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Go={AlphaFilter:Ap,BlurFilter:Dp,BlurFilterPass:Qn,ColorMatrixFilter:ea,DisplacementFilter:Lp,FXAAFilter:Up,NoiseFilter:Hp};Object.entries(Go).forEach(([t,e])=>{Object.defineProperty(Go,t,{get(){return te("7.1.0",`filters.${t} has moved to ${t}`),e}})});class Xp{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Ce.system.add(this.tickerUpdate,this,Kt.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Ce.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const At=new Xp;class hs{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=hs.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ie,this.page=new ie,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,i,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,i,s,r,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class lr extends hs{constructor(){super(...arguments),this.client=new ie,this.movement=new ie,this.offset=new ie,this.global=new ie,this.screen=new ie}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,i,s){return e.worldTransform.applyInverse(s||this.global,i)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,i,s,r,n,a,o,c,h,l,f,u,p,m,b){throw new Error("Method not implemented.")}}class Ve extends lr{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class wi extends lr{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}wi.DOM_DELTA_PIXEL=0;wi.DOM_DELTA_LINE=1;wi.DOM_DELTA_PAGE=2;const $p=2048,Vp=new ie,un=new ie;class zp{constructor(e){this.dispatch=new as,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,i){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:i,priority:0}),this.mappingTable[e].sort((s,r)=>s.priority-r.priority)}dispatchEvent(e,i){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,i),this.dispatch.emit(i||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const i=this.mappingTable[e.type];if(i)for(let s=0,r=i.length;s<r;s++)i[s].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,i){At.pauseUpdate=!0;const r=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",n=this[r](this.rootTarget,this.rootTarget.eventMode,Vp.set(e,i),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(e,i){if(!e.target)return;const s=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let r=0,n=s.length-1;r<n;r++)if(e.currentTarget=s[r],this.notifyTarget(e,i),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,i),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let r=s.length-2;r>=0;r--)if(e.currentTarget=s[r],this.notifyTarget(e,i),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,i,s=this._allInteractiveElements){if(s.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const r=Array.isArray(i)?i:[i];for(let n=s.length-1;n>=0;n--)r.forEach(a=>{e.currentTarget=s[n],this.notifyTarget(e,a)})}propagationPath(e){const i=[e];for(let s=0;s<$p&&e!==this.rootTarget;s++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");i.push(e.parent),e=e.parent}return i.reverse(),i}hitTestMoveRecursive(e,i,s,r,n,a=!1){let o=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||i==="dynamic")&&(At.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let f=l.length-1;f>=0;f--){const u=l[f],p=this.hitTestMoveRecursive(u,this._isInteractive(i)?i:u.eventMode,s,r,n,a||n(e,s));if(p){if(p.length>0&&!p[p.length-1].parent)continue;const m=e.isInteractive();(p.length>0||m)&&(m&&this._allInteractiveElements.push(e),p.push(e)),this._hitElements.length===0&&(this._hitElements=p),o=!0}}}const c=this._isInteractive(i),h=e.isInteractive();return h&&h&&this._allInteractiveElements.push(e),a||this._hitElements.length>0?null:o?this._hitElements:c&&!n(e,s)&&r(e,s)?h?[e]:[]:null}hitTestRecursive(e,i,s,r,n){if(this._interactivePrune(e)||n(e,s))return null;if((e.eventMode==="dynamic"||i==="dynamic")&&(At.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let h=c.length-1;h>=0;h--){const l=c[h],f=this.hitTestRecursive(l,this._isInteractive(i)?i:l.eventMode,s,r,n);if(f){if(f.length>0&&!f[f.length-1].parent)continue;const u=e.isInteractive();return(f.length>0||u)&&f.push(e),f}}}const a=this._isInteractive(i),o=e.isInteractive();return a&&r(e,s)?o?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,i){var s;if(e.hitArea&&(e.worldTransform.applyInverse(i,un),!e.hitArea.contains(un.x,un.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!((s=r.containsPoint)!=null&&s.call(r,i)))return!0}return!1}hitTestFn(e,i){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(i):!1}notifyTarget(e,i){var n,a;i=i??e.type;const s=`on${i}`;(a=(n=e.currentTarget)[s])==null||a.call(n,e);const r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${i}capture`:i;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,i)}mapPointerDown(e){if(!(e instanceof Ve)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerdown"),i.pointerType==="touch")this.dispatchEvent(i,"touchstart");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const r=i.button===2;this.dispatchEvent(i,r?"rightdown":"mousedown")}const s=this.trackingData(e.pointerId);s.pressTargetsByButton[e.button]=i.composedPath(),this.freeEvent(i)}mapPointerMove(e){var c,h;if(!(e instanceof Ve)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const i=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const s=i.pointerType==="mouse"||i.pointerType==="pen",r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.overTargets);if(((c=r.overTargets)==null?void 0:c.length)>0&&n!==i.target){const l=e.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(e,l,n);if(this.dispatchEvent(f,"pointerout"),s&&this.dispatchEvent(f,"mouseout"),!i.composedPath().includes(n)){const u=this.createPointerEvent(e,"pointerleave",n);for(u.eventPhase=u.AT_TARGET;u.target&&!i.composedPath().includes(u.target);)u.currentTarget=u.target,this.notifyTarget(u),s&&this.notifyTarget(u,"mouseleave"),u.target=u.target.parent;this.freeEvent(u)}this.freeEvent(f)}if(n!==i.target){const l=e.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(i,l);this.dispatchEvent(f,"pointerover"),s&&this.dispatchEvent(f,"mouseover");let u=n==null?void 0:n.parent;for(;u&&u!==this.rootTarget.parent&&u!==i.target;)u=u.parent;if(!u||u===this.rootTarget.parent){const m=this.clonePointerEvent(i,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==n&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),s&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(f)}const a=[],o=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(i,"pointermove"),o&&a.push("globalpointermove"),i.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(i,"touchmove"),o&&a.push("globaltouchmove")),s&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(i,"mousemove"),o&&a.push("globalmousemove"),this.cursor=(h=i.target)==null?void 0:h.cursor),a.length>0&&this.all(i,a),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=i.composedPath(),this.freeEvent(i)}mapPointerOver(e){var a;if(!(e instanceof Ve)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(e.pointerId),s=this.createPointerEvent(e),r=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(a=s.target)==null?void 0:a.cursor);const n=this.clonePointerEvent(s,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),r&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;i.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(n)}mapPointerOut(e){if(!(e instanceof Ve)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(e.pointerId);if(i.overTargets){const s=e.pointerType==="mouse"||e.pointerType==="pen",r=this.findMountedTarget(i.overTargets),n=this.createPointerEvent(e,"pointerout",r);this.dispatchEvent(n),s&&this.dispatchEvent(n,"mouseout");const a=this.createPointerEvent(e,"pointerleave",r);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),s&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;i.overTargets=null,this.freeEvent(n),this.freeEvent(a)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Ve)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=performance.now(),s=this.createPointerEvent(e);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const o=s.button===2;this.dispatchEvent(s,o?"rightup":"mouseup")}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]);let a=n;if(n&&!s.composedPath().includes(n)){let o=n;for(;o&&!s.composedPath().includes(o);){if(s.currentTarget=o,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const c=s.button===2;this.notifyTarget(s,c?"rightupoutside":"mouseupoutside")}o=o.parent}delete r.pressTargetsByButton[e.button],a=o}if(a){const o=this.clonePointerEvent(s,"click");o.target=a,o.path=null,r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:o.target,timeStamp:i});const c=r.clicksByButton[e.button];if(c.target===o.target&&i-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=o.target,c.timeStamp=i,o.detail=c.clickCount,o.pointerType==="mouse"){const h=o.button===2;this.dispatchEvent(o,h?"rightclick":"click")}else o.pointerType==="touch"&&this.dispatchEvent(o,"tap");this.dispatchEvent(o,"pointertap"),this.freeEvent(o)}this.freeEvent(s)}mapPointerUpOutside(e){if(!(e instanceof Ve)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]),r=this.createPointerEvent(e);if(s){let n=s;for(;n;)r.currentTarget=n,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete i.pressTargetsByButton[e.button]}this.freeEvent(r)}mapWheel(e){if(!(e instanceof wi)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const i=this.createWheelEvent(e);this.dispatchEvent(i),this.freeEvent(i)}findMountedTarget(e){if(!e)return null;let i=e[0];for(let s=1;s<e.length&&e[s].parent===i;s++)i=e[s];return i}createPointerEvent(e,i,s){const r=this.allocateEvent(Ve);return this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=s??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof i=="string"&&(r.type=i),r}createWheelEvent(e){const i=this.allocateEvent(wi);return this.copyWheelData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=this.hitTest(i.global.x,i.global.y),i}clonePointerEvent(e,i){const s=this.allocateEvent(Ve);return s.nativeEvent=e.nativeEvent,s.originalEvent=e.originalEvent,this.copyPointerData(e,s),this.copyMouseData(e,s),this.copyData(e,s),s.target=e.target,s.path=e.composedPath().slice(),s.type=i??s.type,s}copyWheelData(e,i){i.deltaMode=e.deltaMode,i.deltaX=e.deltaX,i.deltaY=e.deltaY,i.deltaZ=e.deltaZ}copyPointerData(e,i){e instanceof Ve&&i instanceof Ve&&(i.pointerId=e.pointerId,i.width=e.width,i.height=e.height,i.isPrimary=e.isPrimary,i.pointerType=e.pointerType,i.pressure=e.pressure,i.tangentialPressure=e.tangentialPressure,i.tiltX=e.tiltX,i.tiltY=e.tiltY,i.twist=e.twist)}copyMouseData(e,i){e instanceof lr&&i instanceof lr&&(i.altKey=e.altKey,i.button=e.button,i.buttons=e.buttons,i.client.copyFrom(e.client),i.ctrlKey=e.ctrlKey,i.metaKey=e.metaKey,i.movement.copyFrom(e.movement),i.screen.copyFrom(e.screen),i.shiftKey=e.shiftKey,i.global.copyFrom(e.global))}copyData(e,i){i.isTrusted=e.isTrusted,i.srcElement=e.srcElement,i.timeStamp=performance.now(),i.type=e.type,i.detail=e.detail,i.view=e.view,i.which=e.which,i.layer.copyFrom(e.layer),i.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const i=this.eventPool.get(e).pop()||new e(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=null,i.target=null,i}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const i=e.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),this.eventPool.get(i).push(e)}notifyListeners(e,i){const s=e.currentTarget._events[i];if(s&&e.currentTarget.isInteractive())if("fn"in s)s.once&&e.currentTarget.removeListener(i,s.fn,void 0,!0),s.fn.call(s.context,e);else for(let r=0,n=s.length;r<n&&!e.propagationImmediatelyStopped;r++)s[r].once&&e.currentTarget.removeListener(i,s[r].fn,void 0,!0),s[r].fn.call(s[r].context,e)}}const Wp=1,jp={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},ta=class{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new zp(null),At.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ve(null),this.rootWheelEvent=new wi(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...ta.defaultEventFeatures},{set:(e,i,s)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),e[i]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:i}=this.renderer;this.setTargetElement(e),this.resolution=i,ta._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.domElement.style,i);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,s=e.length;i<s;i++){const r=e[i],n=this.bootstrapEvent(this.rootPointerEvent,r);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;At.pointerMoved();const e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){const r=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const i=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let r=0,n=s.length;r<n;r++){const a=this.bootstrapEvent(this.rootPointerEvent,s[r]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;const e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){const r=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,At.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;At.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;At.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,i){let s;this.domElement.parentElement?s=this.domElement.getBoundingClientRect():s={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const r=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*r,t.y=(i-s.top)*(this.domElement.height/s.height)*r}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,s=t.changedTouches.length;i<s;i++){const r=t.changedTouches[i];typeof r.button>"u"&&(r.button=0),typeof r.buttons>"u"&&(r.buttons=1),typeof r.isPrimary>"u"&&(r.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof r.width>"u"&&(r.width=r.radiusX||1),typeof r.height>"u"&&(r.height=r.radiusY||1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="touch"),typeof r.pointerId>"u"&&(r.pointerId=r.identifier||0),typeof r.pressure>"u"&&(r.pressure=r.force||.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),typeof r.layerX>"u"&&(r.layerX=r.offsetX=r.clientX),typeof r.layerY>"u"&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=Wp),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=jp[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};let ns=ta;ns.extension={name:"events",type:[N.RendererSystem,N.CanvasRendererSystem]};ns.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};V.add(ns);function Ho(t){return t==="dynamic"||t==="static"}const Yp={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Ho(ns.defaultEventMode)},set interactive(t){te("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??ns.defaultEventMode},set eventMode(t){this._internalInteractive=Ho(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,i){const s=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,r=typeof e=="function"?void 0:e;t=s?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.on(t,e,r)},removeEventListener(t,e,i){const s=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,r=typeof e=="function"?void 0:e;t=s?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,r)},dispatchEvent(t){if(!(t instanceof hs))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};fe.mixin(Yp);const qp={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};fe.mixin(qp);const Kp=9,Bs=100,Zp=0,Jp=0,Xo=2,$o=1,Qp=-1e3,e0=-1e3,t0=2;class Ph{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(_t.tablet||_t.phone)&&this.createTouchHook();const i=document.createElement("div");i.style.width=`${Bs}px`,i.style.height=`${Bs}px`,i.style.position="absolute",i.style.top=`${Zp}px`,i.style.left=`${Jp}px`,i.style.zIndex=Xo.toString(),this.div=i,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${$o}px`,e.style.height=`${$o}px`,e.style.position="absolute",e.style.top=`${Qp}px`,e.style.left=`${e0}px`,e.style.zIndex=t0.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const i=e.children;if(i)for(let s=0;s<i.length;s++)this.updateAccessibleObjects(i[s])}update(){const e=performance.now();if(_t.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:i,y:s,width:r,height:n}=this.renderer.view.getBoundingClientRect(),{width:a,height:o,resolution:c}=this.renderer,h=r/a*c,l=n/o*c;let f=this.div;f.style.left=`${i}px`,f.style.top=`${s}px`,f.style.width=`${a}px`,f.style.height=`${o}px`;for(let u=0;u<this.children.length;u++){const p=this.children[u];if(p.renderId!==this.renderId)p._accessibleActive=!1,_i(this.children,u,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,u--;else{f=p._accessibleDiv;let m=p.hitArea;const b=p.worldTransform;p.hitArea?(f.style.left=`${(b.tx+m.x*b.a)*h}px`,f.style.top=`${(b.ty+m.y*b.d)*l}px`,f.style.width=`${m.width*b.a*h}px`,f.style.height=`${m.height*b.d*l}px`):(m=p.getBounds(),this.capHitArea(m),f.style.left=`${m.x*h}px`,f.style.top=`${m.y*l}px`,f.style.width=`${m.width*h}px`,f.style.height=`${m.height*l}px`,f.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(f.title=p.accessibleTitle),f.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&f.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==f.title||p.tabIndex!==f.tabIndex)&&(f.title=p.accessibleTitle,f.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(f))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:i,height:s}=this.renderer;e.x+e.width>i&&(e.width=i-e.x),e.y+e.height>s&&(e.height=s-e.y)}addChild(e){let i=this.pool.pop();i||(i=document.createElement("button"),i.style.width=`${Bs}px`,i.style.height=`${Bs}px`,i.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",i.style.position="absolute",i.style.zIndex=Xo.toString(),i.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?i.setAttribute("aria-live","off"):i.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?i.setAttribute("aria-relevant","additions"):i.setAttribute("aria-relevant","text"),i.addEventListener("click",this._onClick.bind(this)),i.addEventListener("focus",this._onFocus.bind(this)),i.addEventListener("focusout",this._onFocusOut.bind(this))),i.style.pointerEvents=e.accessiblePointerEvents,i.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?i.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(i.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&i.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(i),e._accessibleActive=!0,e._accessibleDiv=i,i.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,i){const{displayObject:s}=e.target,r=this.renderer.events.rootBoundary,n=Object.assign(new hs(r),{target:s});r.rootTarget=this.renderer.lastObjectRendered,i.forEach(a=>r.dispatchEvent(n,a))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===Kp&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Ph.extension={name:"accessibility",type:[N.RendererPlugin,N.CanvasRendererPlugin]};V.add(Ph);const ia=class{constructor(t){this.stage=new Le,t=Object.assign({forceCanvas:!1},t),this.renderer=dp(t),ia._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(t,e){const i=ia._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};let Ca=ia;Ca._plugins=[];V.handleByList(N.Application,Ca._plugins);class Ih{static init(e){Object.defineProperty(this,"resizeTo",{set(i){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let i,s;if(this._resizeTo===globalThis.window)i=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;i=r,s=n}this.renderer.resize(i,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Ih.extension=N.Application;V.add(Ih);const Vo={loader:N.LoadParser,resolver:N.ResolveParser,cache:N.CacheParser,detection:N.DetectionParser};V.handle(N.Asset,t=>{const e=t.ref;Object.entries(Vo).filter(([i])=>!!e[i]).forEach(([i,s])=>V.add(Object.assign(e[i],{extension:e[i].extension??s})))},t=>{const e=t.ref;Object.keys(Vo).filter(i=>!!e[i]).forEach(i=>V.remove(e[i]))});class i0{constructor(e,i=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=i}add(e){e.forEach(i=>{this._assetList.push(i)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],i=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<i;s++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function ls(t,e){if(Array.isArray(e)){for(const i of e)if(t.startsWith(`data:${i}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Qt(t,e){const i=t.split("?")[0],s=Ie.extname(i).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const vt=(t,e)=>(Array.isArray(t)||(t=[t]),e?t.map(i=>typeof i=="string"?e(i):i):t),sa=(t,e)=>{const i=e.split("?")[1];return i&&(t+=`?${i}`),t};function Rh(t,e,i,s,r){const n=e[i];for(let a=0;a<n.length;a++){const o=n[a];i<e.length-1?Rh(t.replace(s[i],o),e,i+1,s,r):r.push(t.replace(s[i],o))}}function s0(t){const e=/\{(.*?)\}/g,i=t.match(e),s=[];if(i){const r=[];i.forEach(n=>{const a=n.substring(1,n.length-1).split(",");r.push(a)}),Rh(t,r,0,i,s)}else s.push(t);return s}const fr=t=>!Array.isArray(t);class r0{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const i=this._cache.get(e);return i||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),i}set(e,i){const s=vt(e);let r;for(let o=0;o<this.parsers.length;o++){const c=this.parsers[o];if(c.test(i)){r=c.getCacheableAssets(s,i);break}}r||(r={},s.forEach(o=>{r[o]=i}));const n=Object.keys(r),a={cacheKeys:n,keys:s};if(s.forEach(o=>{this._cacheMap.set(o,a)}),n.forEach(o=>{this._cache.has(o)&&this._cache.get(o)!==i&&console.warn("[Cache] already has key:",o),this._cache.set(o,r[o])}),i instanceof G){const o=i;s.forEach(c=>{o.baseTexture!==G.EMPTY.baseTexture&&q.addToCache(o.baseTexture,c),G.addToCache(o,c)})}}remove(e){if(this._cacheMap.get(e),!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const i=this._cacheMap.get(e);i.cacheKeys.forEach(r=>{this._cache.delete(r)}),i.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Ui=new r0;class n0{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,i,s)=>(this._parsersValidated=!1,e[i]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,i){const s={promise:null,parser:null};return s.promise=(async()=>{var a,o;let r=null,n=null;if(i.loadParser&&(n=this._parserHash[i.loadParser],n||console.warn(`[Assets] specified load parser "${i.loadParser}" not found while loading ${e}`)),!n){for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];if(h.load&&((a=h.test)!=null&&a.call(h,e,i,this))){n=h;break}}if(!n)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(e,i,this),s.parser=n;for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];h.parse&&h.parse&&await((o=h.testParse)==null?void 0:o.call(h,r,i,this))&&(r=await h.parse(r,i,this)||r,s.parser=h)}return r})(),s}async load(e,i){this._parsersValidated||this._validateParsers();let s=0;const r={},n=fr(e),a=vt(e,h=>({src:h})),o=a.length,c=a.map(async h=>{const l=Ie.toAbsolute(h.src);if(!r[h.src])try{this.promiseCache[l]||(this.promiseCache[l]=this._getLoadPromiseAndParser(l,h)),r[h.src]=await this.promiseCache[l].promise,i&&i(++s/o)}catch(f){throw delete this.promiseCache[l],delete r[h.src],new Error(`[Loader.load] Failed to load ${l}.
${f}`)}});return await Promise.all(c),n?r[a[0].src]:r}async unload(e){const s=vt(e,r=>({src:r})).map(async r=>{var o,c;const n=Ie.toAbsolute(r.src),a=this.promiseCache[n];if(a){const h=await a.promise;(c=(o=a.parser)==null?void 0:o.unload)==null||c.call(o,h,r,this),delete this.promiseCache[n]}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,i)=>(e[i.name]&&console.warn(`[Assets] loadParser name conflict "${i.name}"`),{...e,[i.name]:i}),{})}}var dt=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(dt||{});const a0=".json",o0="application/json",c0={extension:{type:N.LoadParser,priority:dt.Low},name:"loadJson",test(t){return ls(t,o0)||Qt(t,a0)},async load(t){return await(await L.ADAPTER.fetch(t)).json()}};V.add(c0);const h0=".txt",l0="text/plain",f0={name:"loadTxt",extension:{type:N.LoadParser,priority:dt.Low},test(t){return ls(t,l0)||Qt(t,h0)},async load(t){return await(await L.ADAPTER.fetch(t)).text()}};V.add(f0);const u0=["normal","bold","100","200","300","400","500","600","700","800","900"],d0=[".ttf",".otf",".woff",".woff2"],p0=["font/ttf","font/otf","font/woff","font/woff2"],m0=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function g0(t){const e=Ie.extname(t),r=Ie.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=r.length>0;for(const o of r)if(!o.match(m0)){n=!1;break}let a=r.join(" ");return n||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const y0={extension:{type:N.LoadParser,priority:dt.Low},name:"loadWebFont",test(t){return ls(t,p0)||Qt(t,d0)},async load(t,e){var s,r,n;const i=L.ADAPTER.getFontFaceSet();if(i){const a=[],o=((s=e.data)==null?void 0:s.family)??g0(t),c=((n=(r=e.data)==null?void 0:r.weights)==null?void 0:n.filter(l=>u0.includes(l)))??["normal"],h=e.data??{};for(let l=0;l<c.length;l++){const f=c[l],u=new FontFace(o,`url(${encodeURI(t)})`,{...h,weight:f});await u.load(),i.add(u),a.push(u)}return a.length===1?a[0]:a}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>L.ADAPTER.getFontFaceSet().delete(e))}};V.add(y0);let zo=0,dn;const _0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",v0={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${_0}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},b0={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let pn;class x0{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const i=URL.createObjectURL(new Blob([v0.code],{type:"application/javascript"})),s=new Worker(i);s.addEventListener("message",r=>{s.terminate(),URL.revokeObjectURL(i),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){dn===void 0&&(dn=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<dn&&(pn||(pn=URL.createObjectURL(new Blob([b0.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(pn),e.addEventListener("message",i=>{this.complete(i.data),this.returnWorker(i.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,i){await this._initWorkers();const s=new Promise((r,n)=>{this.queue.push({id:e,arguments:i,resolve:r,reject:n})});return this.next(),s}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const i=this.queue.pop(),s=i.id;this.resolveHash[zo]={resolve:i.resolve,reject:i.reject},e.postMessage({data:i.arguments,uuid:zo++,id:s})}}const Wo=new x0;function Cr(t,e,i){const s=new G(t);return s.baseTexture.on("dispose",()=>{delete e.promiseCache[i]}),s}const E0=[".jpeg",".jpg",".png",".webp",".avif"],T0=["image/jpeg","image/png","image/webp","image/avif"];async function w0(t){const e=await L.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const i=await e.blob();return await createImageBitmap(i)}const Pr={name:"loadTextures",extension:{type:N.LoadParser,priority:dt.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return ls(t,T0)||Qt(t,E0)},async load(t,e,i){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Wo.isImageBitmapSupported()?s=await Wo.loadImageBitmap(t):s=await w0(t):s=await new Promise(n=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=t,s.complete?n(s):s.onload=()=>{n(s)}});const r=new q(s,{resolution:Mt(t),...e.data});return r.resource.src=t,Cr(r,i,t)},unload(t){t.destroy(!0)}};V.add(Pr);const S0=".svg",A0="image/svg+xml",C0={extension:{type:N.LoadParser,priority:dt.High},name:"loadSVG",test(t){return ls(t,A0)||Qt(t,S0)},async testParse(t){return rs.test(t)},async parse(t,e,i){var a;const s=new rs(t,(a=e==null?void 0:e.data)==null?void 0:a.resourceOptions);await s.load();const r=new q(s,{resolution:Mt(t),...e==null?void 0:e.data});return r.resource.src=t,Cr(r,i,t)},async load(t,e){return(await L.ADAPTER.fetch(t)).text()},unload:Pr.unload};V.add(C0);class P0{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,i)=>`${e}${this._bundleIdConnector}${i}`,extractAssetIdFromBundle:(e,i)=>i.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(i=>{this._preferredOrder.push(i),i.priority||(i.priority=Object.keys(i.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const i=e;this._defaultSearchParams=Object.keys(i).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(i[s])}`).join("&")}}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(i=>{this.addBundle(i.name,i.assets)})}addBundle(e,i){const s=[];Array.isArray(i)?i.forEach(r=>{if(typeof r.name=="string"){const n=this._createBundleAssetId(e,r.name);s.push(n),this.add([r.name,n],r.srcs,r.data)}else{const n=r.name.map(a=>this._createBundleAssetId(e,a));n.forEach(a=>{s.push(a)}),this.add([...r.name,...n],r.srcs)}}):Object.keys(i).forEach(r=>{s.push(this._createBundleAssetId(e,r)),this.add([r,this._createBundleAssetId(e,r)],i[r])}),this._bundles[e]=s}add(e,i,s){const r=vt(e);r.forEach(a=>{this.hasKey(a)&&console.warn(`[Resolver] already has key: ${a} overwriting`)}),Array.isArray(i)||(typeof i=="string"?i=s0(i):i=[i]);const n=i.map(a=>{let o=a;if(typeof a=="string"){let c=!1;for(let h=0;h<this._parsers.length;h++){const l=this._parsers[h];if(l.test(a)){o=l.parse(a),c=!0;break}}c||(o={src:a})}return o.format||(o.format=o.src.split(".").pop()),o.alias||(o.alias=r),(this._basePath||this._rootPath)&&(o.src=Ie.toAbsolute(o.src,this._basePath,this._rootPath)),o.src=this._appendDefaultSearchParams(o.src),o.data=o.data??s,o});r.forEach(a=>{this._assetMap[a]=n})}resolveBundle(e){const i=fr(e);e=vt(e);const s={};return e.forEach(r=>{const n=this._bundles[r];if(n){const a=this.resolve(n),o={};for(const c in a){const h=a[c];o[this._extractAssetIdFromBundle(r,c)]=h}s[r]=o}}),i?s[e[0]]:s}resolveUrl(e){const i=this.resolve(e);if(typeof e!="string"){const s={};for(const r in i)s[r]=i[r].src;return s}return i.src}resolve(e){const i=fr(e);e=vt(e);const s={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const a=this._getPreferredOrder(n),o=n[0];a==null||a.priority.forEach(c=>{a.params[c].forEach(h=>{const l=n.filter(f=>f[c]?f[c]===h:!1);l.length&&(n=l)})}),this._resolverHash[r]=n[0]??o}else{let n=r;(this._basePath||this._rootPath)&&(n=Ie.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[r]={src:n}}s[r]=this._resolverHash[r]}),i?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let i=0;i<e.length;i++){const s=e[0],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const i=/\?/.test(e)?"&":"?";return`${e}${i}${this._defaultSearchParams}`}}class I0{constructor(){this._detections=[],this._initialized=!1,this.resolver=new P0,this.loader=new n0,this.cache=Ui,this._backgroundLoader=new i0(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var n,a,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let c=e.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const i=((n=e.texturePreference)==null?void 0:n.resolution)??1,s=typeof i=="number"?[i]:i;let r=[];if((a=e.texturePreference)!=null&&a.format){const c=(o=e.texturePreference)==null?void 0:o.format;r=typeof c=="string"?[c]:c;for(const h of this._detections)await h.test()||(r=await h.remove(r))}else for(const c of this._detections)await c.test()&&(r=await c.add(r));this.resolver.prefer({params:{format:r,resolution:s}}),e.preferences&&this.setPreferences(e.preferences)}add(e,i,s){this.resolver.add(e,i,s)}async load(e,i){this._initialized||await this.init();const s=fr(e),r=vt(e).map(o=>typeof o!="string"?(this.resolver.add(o.src,o),o.src):(this.resolver.hasKey(o)||this.resolver.add(o,o),o)),n=this.resolver.resolve(r),a=await this._mapLoadToResolve(n,i);return s?a[r[0]]:a}addBundle(e,i){this.resolver.addBundle(e,i)}async loadBundle(e,i){this._initialized||await this.init();let s=!1;typeof e=="string"&&(s=!0,e=[e]);const r=this.resolver.resolveBundle(e),n={},a=Object.keys(r);let o=0,c=0;const h=()=>{i==null||i(++o/c)},l=a.map(f=>{const u=r[f];return c+=Object.keys(u).length,this._mapLoadToResolve(u,h).then(p=>{n[f]=p})});return await Promise.all(l),s?n[e[0]]:n}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const i=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(i))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const i=this.resolver.resolveBundle(e);Object.values(i).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Ui.get(e);const i={};for(let s=0;s<e.length;s++)i[s]=Ui.get(e[s]);return i}async _mapLoadToResolve(e,i){const s=Object.values(e),r=Object.keys(e);this._backgroundLoader.active=!1;const n=await this.loader.load(s,i);this._backgroundLoader.active=!0;const a={};return s.forEach((o,c)=>{const h=n[o.src],l=[o.src];o.alias&&l.push(...o.alias),a[r[c]]=h,Ui.set(l,h)}),a}async unload(e){this._initialized||await this.init();const i=vt(e).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(i);await this._unloadFromResolved(s)}async unloadBundle(e){this._initialized||await this.init(),e=vt(e);const i=this.resolver.resolveBundle(e),s=Object.keys(i).map(r=>this._unloadFromResolved(i[r]));await Promise.all(s)}async _unloadFromResolved(e){const i=Object.values(e);i.forEach(s=>{Ui.remove(s.src)}),await this.loader.unload(i)}get detections(){return this._detections}get preferWorkers(){return Pr.config.preferWorkers}set preferWorkers(e){te("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(i=>{i.config&&Object.keys(i.config).filter(s=>s in e).forEach(s=>{i.config[s]=e[s]})})}}const Os=new I0;V.handleByList(N.LoadParser,Os.loader.parsers).handleByList(N.ResolveParser,Os.resolver.parsers).handleByList(N.CacheParser,Os.cache.parsers).handleByList(N.DetectionParser,Os.detections);const R0={extension:N.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof G),getCacheableAssets:(t,e)=>{const i={};return t.forEach(s=>{e.forEach((r,n)=>{i[s+(n===0?"":n+1)]=r})}),i}};V.add(R0);const M0={extension:{type:N.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",e=await L.ADAPTER.fetch(t).then(i=>i.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};V.add(M0);const D0={extension:{type:N.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",e=await L.ADAPTER.fetch(t).then(i=>i.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};V.add(D0);const jo=["png","jpg","jpeg"],B0={extension:{type:N.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...jo],remove:async t=>t.filter(e=>!jo.includes(e))};V.add(B0);const O0={extension:N.ResolveParser,test:Pr.test,parse:t=>{var e;return{resolution:parseFloat(((e=L.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:t.split(".").pop(),src:t}}};V.add(O0);var Fe=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(Fe||{});const ur={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let gt,hi;function Yo(){hi={s3tc:gt.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:gt.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:gt.getExtension("WEBGL_compressed_texture_etc"),etc1:gt.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:gt.getExtension("WEBGL_compressed_texture_pvrtc")||gt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:gt.getExtension("WEBGL_compressed_texture_atc"),astc:gt.getExtension("WEBGL_compressed_texture_astc")}}const F0={extension:{type:N.DetectionParser,priority:2},test:async()=>{const e=L.ADAPTER.createCanvas().getContext("webgl");return e?(gt=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{hi||Yo();const e=[];for(const i in hi)hi[i]&&e.push(i);return[...e,...t]},remove:async t=>(hi||Yo(),t.filter(e=>!(e in hi)))};V.add(F0);class L0 extends cs{constructor(e,i={width:1,height:1,autoLoad:!0}){let s,r;typeof e=="string"?(s=e,r=new Uint8Array):(s=null,r=e),super(r,i),this.origin=s,this.buffer=r?new $n(r):null,this._load=null,this.loaded=!1,this.origin!==null&&i.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new $n(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class jt extends L0{constructor(e,i){super(e,i),this.format=i.format,this.levels=i.levels||1,this._width=i.width,this._height=i.height,this._extension=jt._formatToExtension(this.format),(i.levelBuffers||this.buffer)&&(this._levelBuffers=i.levelBuffers||jt._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,i,s){const r=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let a=0,o=this.levels;a<o;a++){const{levelID:c,levelWidth:h,levelHeight:l,levelBuffer:f}=this._levelBuffers[a];r.compressedTexImage2D(r.TEXTURE_2D,c,this.format,h,l,0,f)}return!0}onBlobLoaded(){this._levelBuffers=jt._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,i,s,r,n,a,o){const c=new Array(s);let h=e.byteOffset,l=a,f=o,u=l+r-1&~(r-1),p=f+n-1&~(n-1),m=u*p*ur[i];for(let b=0;b<s;b++)c[b]={levelID:b,levelWidth:s>1?l:u,levelHeight:s>1?f:p,levelBuffer:new Uint8Array(e.buffer,h,m)},h+=m,l=l>>1||1,f=f>>1||1,u=l+r-1&~(r-1),p=f+n-1&~(n-1),m=u*p*ur[i];return c}}const mn=4,Fs=124,N0=32,qo=20,k0=542327876,Ls={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},U0={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Ns={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},G0=1,H0=2,X0=4,$0=64,V0=512,z0=131072,W0=827611204,j0=861165636,Y0=894720068,q0=808540228,K0=4,Z0={[W0]:Fe.COMPRESSED_RGBA_S3TC_DXT1_EXT,[j0]:Fe.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Y0]:Fe.COMPRESSED_RGBA_S3TC_DXT5_EXT},J0={70:Fe.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Fe.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Fe.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Fe.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Fe.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Fe.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Fe.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Fe.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Fe.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Q0(t){const e=new Uint32Array(t);if(e[0]!==k0)throw new Error("Invalid DDS file magic word");const s=new Uint32Array(t,0,Fs/Uint32Array.BYTES_PER_ELEMENT),r=s[Ls.HEIGHT],n=s[Ls.WIDTH],a=s[Ls.MIPMAP_COUNT],o=new Uint32Array(t,Ls.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,N0/Uint32Array.BYTES_PER_ELEMENT),c=o[G0];if(c&X0){const h=o[U0.FOURCC];if(h!==q0){const d=Z0[h],v=mn+Fs,w=new Uint8Array(t,v);return[new jt(w,{format:d,width:n,height:r,levels:a})]}const l=mn+Fs,f=new Uint32Array(e.buffer,l,qo/Uint32Array.BYTES_PER_ELEMENT),u=f[Ns.DXGI_FORMAT],p=f[Ns.RESOURCE_DIMENSION],m=f[Ns.MISC_FLAG],b=f[Ns.ARRAY_SIZE],_=J0[u];if(_===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${u}`);if(m===K0)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const T=new Array,g=mn+Fs+qo;if(b===1)T.push(new Uint8Array(t,g));else{const d=ur[_];let v=0,w=n,P=r;for(let I=0;I<a;I++){const E=Math.max(1,w+3&-4),x=Math.max(1,P+3&-4),y=E*x*d;v+=y,w=w>>>1,P=P>>>1}let R=g;for(let I=0;I<b;I++)T.push(new Uint8Array(t,R,v)),R+=v}return T.map(d=>new jt(d,{format:_,width:n,height:r,levels:a}))}throw c&$0?new Error("DDSParser does not support uncompressed texture data."):c&V0?new Error("DDSParser does not supported YUV uncompressed texture data."):c&z0?new Error("DDSParser does not support single-channel (lumninance) texture data!"):c&H0?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Ko=[171,75,84,88,32,49,49,187,13,10,26,10],em=67305985,Xe={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},ra=64,Zo={[z.UNSIGNED_BYTE]:1,[z.UNSIGNED_SHORT]:2,[z.INT]:4,[z.UNSIGNED_INT]:4,[z.FLOAT]:4,[z.HALF_FLOAT]:8},tm={[F.RGBA]:4,[F.RGB]:3,[F.RG]:2,[F.RED]:1,[F.LUMINANCE]:1,[F.LUMINANCE_ALPHA]:2,[F.ALPHA]:1},im={[z.UNSIGNED_SHORT_4_4_4_4]:2,[z.UNSIGNED_SHORT_5_5_5_1]:2,[z.UNSIGNED_SHORT_5_6_5]:2};function sm(t,e,i=!1){const s=new DataView(e);if(!rm(t,s))return null;const r=s.getUint32(Xe.ENDIANNESS,!0)===em,n=s.getUint32(Xe.GL_TYPE,r),a=s.getUint32(Xe.GL_FORMAT,r),o=s.getUint32(Xe.GL_INTERNAL_FORMAT,r),c=s.getUint32(Xe.PIXEL_WIDTH,r),h=s.getUint32(Xe.PIXEL_HEIGHT,r)||1,l=s.getUint32(Xe.PIXEL_DEPTH,r)||1,f=s.getUint32(Xe.NUMBER_OF_ARRAY_ELEMENTS,r)||1,u=s.getUint32(Xe.NUMBER_OF_FACES,r),p=s.getUint32(Xe.NUMBER_OF_MIPMAP_LEVELS,r),m=s.getUint32(Xe.BYTES_OF_KEY_VALUE_DATA,r);if(h===0||l!==1)throw new Error("Only 2D textures are supported");if(u!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(f!==1)throw new Error("WebGL does not support array textures");const b=4,_=4,T=c+3&-4,g=h+3&-4,d=new Array(f);let v=c*h;n===0&&(v=T*g);let w;if(n!==0?Zo[n]?w=Zo[n]*tm[a]:w=im[n]:w=ur[o],w===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const P=i?am(s,m,r):null;let I=v*w,E=c,x=h,y=T,C=g,S=ra+m;for(let A=0;A<p;A++){const B=s.getUint32(S,r);let M=S+4;for(let O=0;O<f;O++){let H=d[O];H||(H=d[O]=new Array(p)),H[A]={levelID:A,levelWidth:p>1||n!==0?E:y,levelHeight:p>1||n!==0?x:C,levelBuffer:new Uint8Array(e,M,I)},M+=I}S+=B+4,S=S%4!==0?S+4-S%4:S,E=E>>1||1,x=x>>1||1,y=E+b-1&~(b-1),C=x+_-1&~(_-1),I=y*C*w}return n!==0?{uncompressed:d.map(A=>{let B=A[0].levelBuffer,M=!1;return n===z.FLOAT?B=new Float32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4):n===z.UNSIGNED_INT?(M=!0,B=new Uint32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)):n===z.INT&&(M=!0,B=new Int32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)),{resource:new cs(B,{width:A[0].levelWidth,height:A[0].levelHeight}),type:n,format:M?nm(a):a}}),kvData:P}:{compressed:d.map(A=>new jt(null,{format:o,width:c,height:h,levels:p,levelBuffers:A})),kvData:P}}function rm(t,e){for(let i=0;i<Ko.length;i++)if(e.getUint8(i)!==Ko[i])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function nm(t){switch(t){case F.RGBA:return F.RGBA_INTEGER;case F.RGB:return F.RGB_INTEGER;case F.RG:return F.RG_INTEGER;case F.RED:return F.RED_INTEGER;default:return t}}function am(t,e,i){const s=new Map;let r=0;for(;r<e;){const n=t.getUint32(ra+r,i),a=ra+r+4,o=3-(n+3)%4;if(n===0||n>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<n&&t.getUint8(a+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(t.buffer,a,c)),l=new DataView(t.buffer,a+c+1,n-c-1);s.set(h,l),r+=4+n+o}return s}const om={extension:{type:N.LoadParser,priority:dt.High},name:"loadDDS",test(t){return Qt(t,".dds")},async load(t,e,i){const r=await(await L.ADAPTER.fetch(t)).arrayBuffer(),a=Q0(r).map(o=>{const c=new q(o,{mipmap:ut.OFF,alphaMode:et.NO_PREMULTIPLIED_ALPHA,resolution:Mt(t),...e.data});return Cr(c,i,t)});return a.length===1?a[0]:a},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};V.add(om);const cm={extension:{type:N.LoadParser,priority:dt.High},name:"loadKTX",test(t){return Qt(t,".ktx")},async load(t,e,i){const r=await(await L.ADAPTER.fetch(t)).arrayBuffer(),{compressed:n,uncompressed:a,kvData:o}=sm(t,r),c=n??a,h={mipmap:ut.OFF,alphaMode:et.NO_PREMULTIPLIED_ALPHA,resolution:Mt(t),...e.data},l=c.map(f=>{c===a&&Object.assign(h,{type:f.type,format:f.format});const u=new q(f,h);return u.ktxKeyValueData=o,Cr(u,i,t)});return l.length===1?l[0]:l},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};V.add(cm);const hm={extension:N.ResolveParser,test:t=>{const i=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(i)},parse:t=>{var s,r;if(t.split("?")[0].split(".").pop()==="ktx"){const n=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(n.some(a=>t.endsWith(a)))return{resolution:parseFloat(((s=L.RETINA_PREFIX.exec(t))==null?void 0:s[1])??"1"),format:n.find(a=>t.endsWith(a)),src:t}}return{resolution:parseFloat(((r=L.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:t.split(".").pop(),src:t}}};V.add(hm);const lm=new K,fm=4,$i=class{constructor(t){this.renderer=t}async image(t,e,i){const s=new Image;return s.src=await this.base64(t,e,i),s}async base64(t,e,i){const s=this.canvas(t);if(s.toBlob!==void 0)return new Promise((r,n)=>{s.toBlob(a=>{if(!a){n(new Error("ICanvas.toBlob failed!"));return}const o=new FileReader;o.onload=()=>r(o.result),o.onerror=n,o.readAsDataURL(a)},e,i)});if(s.toDataURL!==void 0)return s.toDataURL(e,i);if(s.convertToBlob!==void 0){const r=await s.convertToBlob({type:e,quality:i});return new Promise((n,a)=>{const o=new FileReader;o.onload=()=>n(o.result),o.onerror=a,o.readAsDataURL(r)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:i,width:s,height:r,flipY:n}=this._rawPixels(t,e);n&&$i._flipY(i,s,r),$i._unpremultiplyAlpha(i);const a=new td(s,r,1),o=new ImageData(new Uint8ClampedArray(i.buffer),s,r);return a.context.putImageData(o,0,0),a.canvas}pixels(t,e){const{pixels:i,width:s,height:r,flipY:n}=this._rawPixels(t,e);return n&&$i._flipY(i,s,r),$i._unpremultiplyAlpha(i),i}_rawPixels(t,e){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let s,r=!1,n,a=!1;if(t&&(t instanceof Jt?n=t:(n=i.generateTexture(t,{resolution:i.resolution,multisample:i.multisample}),a=!0)),n){if(s=n.baseTexture.resolution,e=e??n.frame,r=!1,!a){i.renderTexture.bind(n);const f=n.framebuffer.glFramebuffers[i.CONTEXT_UID];f.blitFramebuffer&&i.framebuffer.bind(f.blitFramebuffer)}}else s=i.resolution,e||(e=lm,e.width=i.width/s,e.height=i.height/s),r=!0,i.renderTexture.bind();const o=Math.round(e.width*s),c=Math.round(e.height*s),h=new Uint8Array(fm*o*c),l=i.gl;return l.readPixels(Math.round(e.x*s),Math.round(e.y*s),o,c,l.RGBA,l.UNSIGNED_BYTE,h),a&&(n==null||n.destroy(!0)),{pixels:h,width:o,height:c,flipY:r}}destroy(){this.renderer=null}static _flipY(t,e,i){const s=e<<2,r=i>>1,n=new Uint8Array(s);for(let a=0;a<r;a++){const o=a*s,c=(i-a-1)*s;n.set(t.subarray(o,o+s)),t.copyWithin(o,c,c+s),t.set(n,c)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let i=0;i<e;i+=4){const s=t[i+3];if(s!==0){const r=255.001/s;t[i]=t[i]*r+.5,t[i+1]=t[i+1]*r+.5,t[i+2]=t[i+2]*r+.5}}}};let Mh=$i;Mh.extension={name:"extract",type:N.RendererSystem};V.add(Mh);const dr={build(t){const e=t.points;let i,s,r,n,a,o;if(t.type===we.CIRC){const m=t.shape;i=m.x,s=m.y,a=o=m.radius,r=n=0}else if(t.type===we.ELIP){const m=t.shape;i=m.x,s=m.y,a=m.width,o=m.height,r=n=0}else{const m=t.shape,b=m.width/2,_=m.height/2;i=m.x+b,s=m.y+_,a=o=Math.max(0,Math.min(m.radius,Math.min(b,_))),r=b-a,n=_-o}if(!(a>=0&&o>=0&&r>=0&&n>=0)){e.length=0;return}const c=Math.ceil(2.3*Math.sqrt(a+o)),h=c*8+(r?4:0)+(n?4:0);if(e.length=h,h===0)return;if(c===0){e.length=8,e[0]=e[6]=i+r,e[1]=e[3]=s+n,e[2]=e[4]=i-r,e[5]=e[7]=s-n;return}let l=0,f=c*4+(r?2:0)+2,u=f,p=h;{const m=r+a,b=n,_=i+m,T=i-m,g=s+b;if(e[l++]=_,e[l++]=g,e[--f]=g,e[--f]=T,n){const d=s-b;e[u++]=T,e[u++]=d,e[--p]=d,e[--p]=_}}for(let m=1;m<c;m++){const b=Math.PI/2*(m/c),_=r+Math.cos(b)*a,T=n+Math.sin(b)*o,g=i+_,d=i-_,v=s+T,w=s-T;e[l++]=g,e[l++]=v,e[--f]=v,e[--f]=d,e[u++]=d,e[u++]=w,e[--p]=w,e[--p]=g}{const m=r,b=n+o,_=i+m,T=i-m,g=s+b,d=s-b;e[l++]=_,e[l++]=g,e[--p]=d,e[--p]=_,r&&(e[l++]=T,e[l++]=g,e[--p]=d,e[--p]=T)}},triangulate(t,e){const i=t.points,s=e.points,r=e.indices;if(i.length===0)return;let n=s.length/2;const a=n;let o,c;if(t.type!==we.RREC){const l=t.shape;o=l.x,c=l.y}else{const l=t.shape;o=l.x+l.width/2,c=l.y+l.height/2}const h=t.matrix;s.push(t.matrix?h.a*o+h.c*c+h.tx:o,t.matrix?h.b*o+h.d*c+h.ty:c),n++,s.push(i[0],i[1]);for(let l=2;l<i.length;l+=2)s.push(i[l],i[l+1]),r.push(n++,a,n);r.push(a+1,a,n)}};function Jo(t,e=!1){const i=t.length;if(i<6)return;let s=0;for(let r=0,n=t[i-2],a=t[i-1];r<i;r+=2){const o=t[r],c=t[r+1];s+=(o-n)*(c+a),n=o,a=c}if(!e&&s>0||e&&s<=0){const r=i/2;for(let n=r+r%2;n<i;n+=2){const a=i-n-2,o=i-n-1,c=n,h=n+1;[t[a],t[c]]=[t[c],t[a]],[t[o],t[h]]=[t[h],t[o]]}}}const Dh={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let i=t.points;const s=t.holes,r=e.points,n=e.indices;if(i.length>=6){Jo(i,!1);const a=[];for(let h=0;h<s.length;h++){const l=s[h];Jo(l.points,!0),a.push(i.length/2),i=i.concat(l.points)}const o=wl(i,a,2);if(!o)return;const c=r.length/2;for(let h=0;h<o.length;h+=3)n.push(o[h]+c),n.push(o[h+1]+c),n.push(o[h+2]+c);for(let h=0;h<i.length;h++)r.push(i[h])}}},um={build(t){const e=t.shape,i=e.x,s=e.y,r=e.width,n=e.height,a=t.points;a.length=0,r>=0&&n>=0&&a.push(i,s,i+r,s,i+r,s+n,i,s+n)},triangulate(t,e){const i=t.points,s=e.points;if(i.length===0)return;const r=s.length/2;s.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},dm={build(t){dr.build(t)},triangulate(t,e){dr.triangulate(t,e)}};var We=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(We||{}),Vt=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(Vt||{});const Si={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};class Qo{static curveTo(e,i,s,r,n,a){const o=a[a.length-2],h=a[a.length-1]-i,l=o-e,f=r-i,u=s-e,p=Math.abs(h*u-l*f);if(p<1e-8||n===0)return(a[a.length-2]!==e||a[a.length-1]!==i)&&a.push(e,i),null;const m=h*h+l*l,b=f*f+u*u,_=h*f+l*u,T=n*Math.sqrt(m)/p,g=n*Math.sqrt(b)/p,d=T*_/m,v=g*_/b,w=T*u+g*l,P=T*f+g*h,R=l*(g+d),I=h*(g+d),E=u*(T+v),x=f*(T+v),y=Math.atan2(I-P,R-w),C=Math.atan2(x-P,E-w);return{cx:w+e,cy:P+i,radius:n,startAngle:y,endAngle:C,anticlockwise:l*f>u*h}}static arc(e,i,s,r,n,a,o,c,h){const l=o-a,f=Si._segmentsCount(Math.abs(l)*n,Math.ceil(Math.abs(l)/cr)*40),u=l/(f*2),p=u*2,m=Math.cos(u),b=Math.sin(u),_=f-1,T=_%1/_;for(let g=0;g<=_;++g){const d=g+T*g,v=u+a+p*d,w=Math.cos(v),P=-Math.sin(v);h.push((m*w+b*P)*n+s,(m*-P+b*w)*n+r)}}}class pm{constructor(){this.reset()}begin(e,i,s){this.reset(),this.style=e,this.start=i,this.attribStart=s}end(e,i){this.attribSize=i-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Pa{static curveLength(e,i,s,r,n,a,o,c){let l=0,f=0,u=0,p=0,m=0,b=0,_=0,T=0,g=0,d=0,v=0,w=e,P=i;for(let R=1;R<=10;++R)f=R/10,u=f*f,p=u*f,m=1-f,b=m*m,_=b*m,T=_*e+3*b*f*s+3*m*u*n+p*o,g=_*i+3*b*f*r+3*m*u*a+p*c,d=w-T,v=P-g,w=T,P=g,l+=Math.sqrt(d*d+v*v);return l}static curveTo(e,i,s,r,n,a,o){const c=o[o.length-2],h=o[o.length-1];o.length-=2;const l=Si._segmentsCount(Pa.curveLength(c,h,e,i,s,r,n,a));let f=0,u=0,p=0,m=0,b=0;o.push(c,h);for(let _=1,T=0;_<=l;++_)T=_/l,f=1-T,u=f*f,p=u*f,m=T*T,b=m*T,o.push(p*c+3*u*T*e+3*f*m*s+b*n,p*h+3*u*T*i+3*f*m*r+b*a)}}function ec(t,e,i,s,r,n,a,o){const c=t-i*r,h=e-s*r,l=t+i*n,f=e+s*n;let u,p;a?(u=s,p=-i):(u=-s,p=i);const m=c+u,b=h+p,_=l+u,T=f+p;return o.push(m,b,_,T),2}function Lt(t,e,i,s,r,n,a,o){const c=i-t,h=s-e;let l=Math.atan2(c,h),f=Math.atan2(r-t,n-e);o&&l<f?l+=Math.PI*2:!o&&l>f&&(f+=Math.PI*2);let u=l;const p=f-l,m=Math.abs(p),b=Math.sqrt(c*c+h*h),_=(15*m*Math.sqrt(b)/Math.PI>>0)+1,T=p/_;if(u+=T,o){a.push(t,e,i,s);for(let g=1,d=u;g<_;g++,d+=T)a.push(t,e,t+Math.sin(d)*b,e+Math.cos(d)*b);a.push(t,e,r,n)}else{a.push(i,s,t,e);for(let g=1,d=u;g<_;g++,d+=T)a.push(t+Math.sin(d)*b,e+Math.cos(d)*b,t,e);a.push(r,n,t,e)}return _*2}function mm(t,e){const i=t.shape;let s=t.points||i.points.slice();const r=e.closePointEps;if(s.length===0)return;const n=t.lineStyle,a=new ie(s[0],s[1]),o=new ie(s[s.length-2],s[s.length-1]),c=i.type!==we.POLY||i.closeStroke,h=Math.abs(a.x-o.x)<r&&Math.abs(a.y-o.y)<r;if(c){s=s.slice(),h&&(s.pop(),s.pop(),o.set(s[s.length-2],s[s.length-1]));const O=(a.x+o.x)*.5,H=(o.y+a.y)*.5;s.unshift(O,H),s.push(O,H)}const l=e.points,f=s.length/2;let u=s.length;const p=l.length/2,m=n.width/2,b=m*m,_=n.miterLimit*n.miterLimit;let T=s[0],g=s[1],d=s[2],v=s[3],w=0,P=0,R=-(g-v),I=T-d,E=0,x=0,y=Math.sqrt(R*R+I*I);R/=y,I/=y,R*=m,I*=m;const C=n.alignment,S=(1-C)*2,A=C*2;c||(n.cap===Vt.ROUND?u+=Lt(T-R*(S-A)*.5,g-I*(S-A)*.5,T-R*S,g-I*S,T+R*A,g+I*A,l,!0)+2:n.cap===Vt.SQUARE&&(u+=ec(T,g,R,I,S,A,!0,l))),l.push(T-R*S,g-I*S,T+R*A,g+I*A);for(let O=1;O<f-1;++O){T=s[(O-1)*2],g=s[(O-1)*2+1],d=s[O*2],v=s[O*2+1],w=s[(O+1)*2],P=s[(O+1)*2+1],R=-(g-v),I=T-d,y=Math.sqrt(R*R+I*I),R/=y,I/=y,R*=m,I*=m,E=-(v-P),x=d-w,y=Math.sqrt(E*E+x*x),E/=y,x/=y,E*=m,x*=m;const H=d-T,j=g-v,D=d-w,k=P-v,X=H*D+j*k,Z=j*D-k*H,J=Z<0;if(Math.abs(Z)<.001*Math.abs(X)){l.push(d-R*S,v-I*S,d+R*A,v+I*A),X>=0&&(n.join===We.ROUND?u+=Lt(d,v,d-R*S,v-I*S,d-E*S,v-x*S,l,!1)+4:u+=2,l.push(d-E*A,v-x*A,d+E*S,v+x*S));continue}const ae=(-R+T)*(-I+v)-(-R+d)*(-I+g),se=(-E+w)*(-x+v)-(-E+d)*(-x+P),ue=(H*se-D*ae)/Z,_e=(k*ae-j*se)/Z,Be=(ue-d)*(ue-d)+(_e-v)*(_e-v),Ee=d+(ue-d)*S,oe=v+(_e-v)*S,pe=d-(ue-d)*A,ge=v-(_e-v)*A,tt=Math.min(H*H+j*j,D*D+k*k),it=J?S:A,Bi=tt+it*it*b,el=Be<=Bi;let gs=n.join;if(gs===We.MITER&&Be/b>_&&(gs=We.BEVEL),el)switch(gs){case We.MITER:{l.push(Ee,oe,pe,ge);break}case We.BEVEL:{J?l.push(Ee,oe,d+R*A,v+I*A,Ee,oe,d+E*A,v+x*A):l.push(d-R*S,v-I*S,pe,ge,d-E*S,v-x*S,pe,ge),u+=2;break}case We.ROUND:{J?(l.push(Ee,oe,d+R*A,v+I*A),u+=Lt(d,v,d+R*A,v+I*A,d+E*A,v+x*A,l,!0)+4,l.push(Ee,oe,d+E*A,v+x*A)):(l.push(d-R*S,v-I*S,pe,ge),u+=Lt(d,v,d-R*S,v-I*S,d-E*S,v-x*S,l,!1)+4,l.push(d-E*S,v-x*S,pe,ge));break}}else{switch(l.push(d-R*S,v-I*S,d+R*A,v+I*A),gs){case We.MITER:{J?l.push(pe,ge,pe,ge):l.push(Ee,oe,Ee,oe),u+=2;break}case We.ROUND:{J?u+=Lt(d,v,d+R*A,v+I*A,d+E*A,v+x*A,l,!0)+2:u+=Lt(d,v,d-R*S,v-I*S,d-E*S,v-x*S,l,!1)+2;break}}l.push(d-E*S,v-x*S,d+E*A,v+x*A),u+=2}}T=s[(f-2)*2],g=s[(f-2)*2+1],d=s[(f-1)*2],v=s[(f-1)*2+1],R=-(g-v),I=T-d,y=Math.sqrt(R*R+I*I),R/=y,I/=y,R*=m,I*=m,l.push(d-R*S,v-I*S,d+R*A,v+I*A),c||(n.cap===Vt.ROUND?u+=Lt(d-R*(S-A)*.5,v-I*(S-A)*.5,d-R*S,v-I*S,d+R*A,v+I*A,l,!1)+2:n.cap===Vt.SQUARE&&(u+=ec(d,v,R,I,S,A,!1,l)));const B=e.indices,M=Si.epsilon*Si.epsilon;for(let O=p;O<u+p-2;++O)T=l[O*2],g=l[O*2+1],d=l[(O+1)*2],v=l[(O+1)*2+1],w=l[(O+2)*2],P=l[(O+2)*2+1],!(Math.abs(T*(v-P)+d*(P-g)+w*(g-v))<M)&&B.push(O,O+1,O+2)}function gm(t,e){let i=0;const s=t.shape,r=t.points||s.points,n=s.type!==we.POLY||s.closeStroke;if(r.length===0)return;const a=e.points,o=e.indices,c=r.length/2,h=a.length/2;let l=h;for(a.push(r[0],r[1]),i=1;i<c;i++)a.push(r[i*2],r[i*2+1]),o.push(l,l+1),l++;n&&o.push(l,h)}function tc(t,e){t.lineStyle.native?gm(t,e):mm(t,e)}class Ia{static curveLength(e,i,s,r,n,a){const o=e-2*s+n,c=i-2*r+a,h=2*s-2*e,l=2*r-2*i,f=4*(o*o+c*c),u=4*(o*h+c*l),p=h*h+l*l,m=2*Math.sqrt(f+u+p),b=Math.sqrt(f),_=2*f*b,T=2*Math.sqrt(p),g=u/b;return(_*m+b*u*(m-T)+(4*p*f-u*u)*Math.log((2*b+g+m)/(g+T)))/(4*_)}static curveTo(e,i,s,r,n){const a=n[n.length-2],o=n[n.length-1],c=Si._segmentsCount(Ia.curveLength(a,o,e,i,s,r));let h=0,l=0;for(let f=1;f<=c;++f){const u=f/c;h=a+(e-a)*u,l=o+(i-o)*u,n.push(h+(e+(s-e)*u-h)*u,l+(i+(r-i)*u-l)*u)}}}const gn={[we.POLY]:Dh,[we.CIRC]:dr,[we.ELIP]:dr,[we.RECT]:um,[we.RREC]:dm},ic=[],ks=[];class pr{constructor(e,i=null,s=null,r=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=s,this.fillStyle=i,this.matrix=r,this.type=e.type}clone(){return new pr(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const si=new ie,Bh=class extends Gc{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new hr,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),ks.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),ic.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,s=null){const r=new pr(t,e,i,s);return this.graphicsData.push(r),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const i=new pr(t,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=s.lineStyle,s.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let i=0;i<e.length;++i){const s=e[i];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,si):si.copyFrom(t),s.shape.contains(si.x,si.y))){let r=!1;if(s.holes){for(let n=0;n<s.holes.length;n++)if(s.holes[n].shape.contains(si.x,si.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let i=null,s=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],s=i.style);for(let o=this.shapeIndex;o<e.length;o++){this.shapeIndex++;const c=e[o],h=c.fillStyle,l=c.lineStyle;gn[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(h.visible||l.visible)&&this.processHoles(c.holes);for(let u=0;u<2;u++){const p=u===0?h:l;if(!p.visible)continue;const m=p.texture.baseTexture,b=this.indices.length,_=this.points.length/2;m.wrapMode=Rt.REPEAT,u===0?this.processFill(c):this.processLine(c);const T=this.points.length/2-_;T!==0&&(i&&!this._compareStyles(s,p)&&(i.end(b,_),i=null),i||(i=ic.pop()||new pm,i.begin(p,b,_),this.batches.push(i),s=p),this.addUvs(this.points,t,p.texture,_,T,p.matrix))}}const r=this.indices.length,n=this.points.length/2;if(i&&i.end(r,n),this.batches.length===0){this.batchable=!0;return}const a=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const i=this.graphicsData[t],s=i.fillStyle,r=i.lineStyle;if(s&&!s.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,i=t.length;e<i;e++){const s=t[e];for(let r=0;r<s.size;r++){const n=s.start+r;this.indicesUint16[n]=this.indicesUint16[n]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<Bh.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++q._globalBatch;for(let l=0;l<this.drawCalls.length;l++)this.drawCalls[l].texArray.clear(),ks.push(this.drawCalls[l]);this.drawCalls.length=0;const e=this.colors,i=this.textureIds;let s=ks.pop();s||(s=new zn,s.texArray=new jn),s.texArray.count=0,s.start=0,s.size=0,s.type=ct.TRIANGLES;let r=0,n=null,a=0,o=!1,c=ct.TRIANGLES,h=0;this.drawCalls.push(s);for(let l=0;l<this.batches.length;l++){const f=this.batches[l],u=8,p=f.style,m=p.texture.baseTexture;o!==!!p.native&&(o=!!p.native,c=o?ct.LINES:ct.TRIANGLES,n=null,r=u,t++),n!==m&&(n=m,m._batchEnabled!==t&&(r===u&&(t++,r=0,s.size>0&&(s=ks.pop(),s||(s=new zn,s.texArray=new jn),this.drawCalls.push(s)),s.start=h,s.size=0,s.texArray.count=0,s.type=c),m.touched=1,m._batchEnabled=t,m._batchLocation=r,m.wrapMode=Rt.REPEAT,s.texArray.elements[s.texArray.count++]=m,r++)),s.size+=f.size,h+=f.size,a=m._batchLocation,this.addColors(e,p.color,p.alpha,f.attribSize,f.attribStart),this.addTextureIds(i,a,f.attribSize,f.attribStart)}q._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,i=this.colors,s=this.textureIds,r=new ArrayBuffer(t.length*3*4),n=new Float32Array(r),a=new Uint32Array(r);let o=0;for(let c=0;c<t.length/2;c++)n[o++]=t[c*2],n[o++]=t[c*2+1],n[o++]=e[c*2],n[o++]=e[c*2+1],a[o++]=i[c],n[o++]=s[c];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?Dh.triangulate(t,this):gn[t.type].triangulate(t,this)}processLine(t){tc(t,this);for(let e=0;e<t.holes.length;e++)tc(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const i=t[e];gn[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){const s=t[i*2],r=t[i*2+1];t[i*2]=e.a*s+e.c*r+e.tx,t[i*2+1]=e.b*s+e.d*r+e.ty}}addColors(t,e,i,s,r=0){const n=ne.shared.setValue(e).toLittleEndianNumber(),a=ne.shared.setValue(n).toPremultiplied(i);t.length=Math.max(t.length,r+s);for(let o=0;o<s;o++)t[r+o]=a}addTextureIds(t,e,i,s=0){t.length=Math.max(t.length,s+i);for(let r=0;r<i;r++)t[s+r]=e}addUvs(t,e,i,s,r,n=null){let a=0;const o=e.length,c=i.frame;for(;a<r;){let l=t[(s+a)*2],f=t[(s+a)*2+1];if(n){const u=n.a*l+n.c*f+n.tx;f=n.b*l+n.d*f+n.ty,l=u}a++,e.push(l/c.width,f/c.height)}const h=i.baseTexture;(c.width<h.width||c.height<h.height)&&this.adjustUvs(e,i,o,r)}adjustUvs(t,e,i,s){const r=e.baseTexture,n=1e-6,a=i+s*2,o=e.frame,c=o.width/r.width,h=o.height/r.height;let l=o.x/o.width,f=o.y/o.height,u=Math.floor(t[i]+n),p=Math.floor(t[i+1]+n);for(let m=i+2;m<a;m+=2)u=Math.min(u,Math.floor(t[m]+n)),p=Math.min(p,Math.floor(t[m+1]+n));l-=u,f-=p;for(let m=i;m<a;m+=2)t[m]=(t[m]+l)*c,t[m+1]=(t[m+1]+f)*h}};let Oh=Bh;Oh.BATCHABLE_SIZE=100;class Ir{constructor(){this.color=16777215,this.alpha=1,this.texture=G.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new Ir;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=G.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Ra extends Ir{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Vt.BUTT,this.join=We.MITER,this.miterLimit=10}clone(){const e=new Ra;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const yn={},Zs=class extends Le{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Ir,this._lineStyle=new Ra,this._matrix=null,this._holeMode=!1,this.state=xt.for2d(),this._geometry=t||new Oh,this._geometry.refCount++,this._transformID=-1,this._tintColor=new ne(16777215),this.blendMode=Y.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Zs(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i,s=.5,r=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:i,alignment:s,native:r}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:G.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Vt.BUTT,join:We.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new vi,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new vi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,s=i[i.length-2],r=i[i.length-1];return(s!==t||r!==e)&&i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,s){this._initCurve();const r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),Ia.curveTo(t,e,i,s,r),this}bezierCurveTo(t,e,i,s,r,n){return this._initCurve(),Pa.curveTo(t,e,i,s,r,n,this.currentPath.points),this}arcTo(t,e,i,s,r){this._initCurve(t,e);const n=this.currentPath.points,a=Qo.curveTo(t,e,i,s,r,n);if(a){const{cx:o,cy:c,radius:h,startAngle:l,endAngle:f,anticlockwise:u}=a;this.arc(o,c,h,l,f,u)}return this}arc(t,e,i,s,r,n=!1){if(s===r)return this;if(!n&&r<=s?r+=cr:n&&s<=r&&(s+=cr),r-s===0)return this;const o=t+Math.cos(s)*i,c=e+Math.sin(s)*i,h=this._geometry.closePointEps;let l=this.currentPath?this.currentPath.points:null;if(l){const f=Math.abs(l[l.length-2]-o),u=Math.abs(l[l.length-1]-c);f<h&&u<h||l.push(o,c)}else this.moveTo(o,c),l=this.currentPath.points;return Qo.arc(o,c,t,e,i,s,r,n,l),this}beginFill(t=0,e){return this.beginTextureFill({texture:G.WHITE,color:t,alpha:e})}normalizeColor(t){const e=ne.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:G.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,s){return this.drawShape(new K(t,e,i,s))}drawRoundedRect(t,e,i,s,r){return this.drawShape(new wa(t,e,i,s,r))}drawCircle(t,e,i){return this.drawShape(new gd(t,e,i))}drawEllipse(t,e,i,s){return this.drawShape(new yd(t,e,i,s))}drawPolygon(...t){let e,i=!0;const s=t[0];s.points?(i=s.closeStroke,e=s.points):Array.isArray(t[0])?e=t[0]:e=t;const r=new vi(e);return r.closeStroke=i,this.drawShape(r),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===we.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let s=0;s<i;s++){const r=t.batches[s],n=r.style.color,a=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),o=new Float32Array(t.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),c=new Uint16Array(t.indicesUint16.buffer,r.start*2,r.size),h={vertexData:a,blendMode:e,indices:c,uvs:o,_batchRGB:ne.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[s]=h}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){const s=this.batches[e];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}}_renderDirect(t){const e=this._resolveDirectShader(t),i=this._geometry,s=this.worldAlpha,r=e.uniforms,n=i.drawCalls;r.translationMatrix=this.transform.worldTransform,ne.shared.setValue(this._tintColor).premultiply(s).toArray(r.tint),t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(let a=0,o=n.length;a<o;a++)this._renderDrawCallDirect(t,i.drawCalls[a])}_renderDrawCallDirect(t,e){const{texArray:i,type:s,size:r,start:n}=e,a=i.count;for(let o=0;o<a;o++)t.texture.bind(i.elements[o],o);t.geometry.draw(s,r,n)}_resolveDirectShader(t){let e=this.shader;const i=this.pluginName;if(!e){if(!yn[i]){const{maxTextures:s}=t.plugins[i],r=new Int32Array(s);for(let o=0;o<s;o++)r[o]=o;const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new ce,default:Qe.from({uSamplers:r},!0)},a=t.plugins[i]._shader.program;yn[i]=new lt(a,n)}e=yn[i]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:i,maxX:s,maxY:r}=t.bounds;this._bounds.addFrame(this.transform,e,i,s,r)}containsPoint(t){return this.worldTransform.applyInverse(t,Zs._TEMP_POINT),this._geometry.containsPoint(Zs._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=ne.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,i=e.a,s=e.b,r=e.c,n=e.d,a=e.tx,o=e.ty,c=this._geometry.points,h=this.vertexData;let l=0;for(let f=0;f<c.length;f+=2){const u=c[f],p=c[f+1];h[l++]=i*u+r*p+a,h[l++]=n*p+s*u+o}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};let Rr=Zs;Rr.curves=Si;Rr._TEMP_POINT=new ie;class ym{constructor(e,i){this.uvBuffer=e,this.uvMatrix=i,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const i=this.uvBuffer.data;(!this.data||this.data.length!==i.length)&&(this.data=new Float32Array(i.length)),this.uvMatrix.multiplyUvs(i,this.data),this._updateID++}}const _n=new ie,sc=new vi,Fh=class extends Le{constructor(t,e,i,s=ct.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=i||xt.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=L.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===ct.TRIANGLES&&e.length<Fh.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)}calculateVertices(){const e=this.geometry.buffers[0],i=e.data,s=e._updateID;if(s===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==i.length&&(this.vertexData=new Float32Array(i.length));const r=this.transform.worldTransform,n=r.a,a=r.b,o=r.c,c=r.d,h=r.tx,l=r.ty,f=this.vertexData;for(let u=0;u<f.length/2;u++){const p=i[u*2],m=i[u*2+1];f[u*2]=n*p+o*m+h,f[u*2+1]=a*p+c*m+l}if(this._roundPixels){const u=L.RESOLUTION;for(let p=0;p<f.length;++p)f[p]=Math.round(f[p]*u)/u}this.vertexDirty=s}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new ym(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,_n);const e=this.geometry.getBuffer("aVertexPosition").data,i=sc.points,s=this.geometry.getIndex().data,r=s.length,n=this.drawMode===4?3:1;for(let a=0;a+2<r;a+=n){const o=s[a]*2,c=s[a+1]*2,h=s[a+2]*2;if(i[0]=e[o],i[1]=e[o+1],i[2]=e[c],i[3]=e[c+1],i[4]=e[h],i[5]=e[h+1],sc.contains(_n.x,_n.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let na=Fh;na.BATCHABLE_SIZE=100;class _m extends Dt{constructor(e,i,s){super();const r=new de(e),n=new de(i,!0),a=new de(s,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,z.FLOAT).addAttribute("aTextureCoord",n,2,!1,z.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var vm=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,bm=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class rc extends lt{constructor(e,i){const s={uSampler:e,alpha:1,uTextureMatrix:ce.IDENTITY,uColor:new Float32Array([1,1,1,1])};i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i),i.uniforms&&Object.assign(s,i.uniforms),super(i.program||Ke.from(bm,vm),s),this._colorDirty=!1,this.uvMatrix=new nh(e),this.batchable=i.program===void 0,this.pluginName=i.pluginName,this._tintColor=new ne(i.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=i.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const i=this.texture.baseTexture.alphaMode;ne.shared.setValue(this._tintColor).premultiply(this._alpha,i).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class nc{constructor(e,i,s){this.geometry=new Dt,this.indexBuffer=null,this.size=s,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let n=e[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||z.FLOAT,offset:n.offset},i[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let i=0;this.indexBuffer=new de(Qu(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){const o=this.dynamicProperties[a];o.offset=i,i+=o.size,this.dynamicStride+=o.size}const s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new de(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){const o=this.staticProperties[a];o.offset=r,r+=o.size,this.staticStride+=o.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new de(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){const o=this.dynamicProperties[a];e.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===z.UNSIGNED_BYTE,o.type,this.dynamicStride*4,o.offset*4)}for(let a=0;a<this.staticProperties.length;++a){const o=this.staticProperties[a];e.addAttribute(o.attributeName,this.staticBuffer,0,o.type===z.UNSIGNED_BYTE,o.type,this.staticStride*4,o.offset*4)}}uploadDynamic(e,i,s){for(let r=0;r<this.dynamicProperties.length;r++){const n=this.dynamicProperties[r];n.uploadFunction(e,i,s,n.type===z.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,i,s){for(let r=0;r<this.staticProperties.length;r++){const n=this.staticProperties[r];n.uploadFunction(e,i,s,n.type===z.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var xm=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Em=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Lh extends Er{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new ce,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:z.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=lt.from(Em,xm,{}),this.state=xt.for2d()}render(e){const i=e.children,s=e._maxSize,r=e._batchSize,n=this.renderer;let a=i.length;if(a===0)return;a>s&&!e.autoResize&&(a=s);let o=e._buffers;o||(o=e._buffers=this.generateBuffers(e));const c=i[0]._texture.baseTexture,h=c.alphaMode>0;this.state.blendMode=Lc(e.blendMode,h),n.state.set(this.state);const l=n.gl,f=e.worldTransform.copyTo(this.tempMatrix);f.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=f.toArray(!0),this.shader.uniforms.uColor=ne.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let u=!1;for(let p=0,m=0;p<a;p+=r,m+=1){let b=a-p;b>r&&(b=r),m>=o.length&&o.push(this._generateOneMoreBuffer(e));const _=o[m];_.uploadDynamic(i,p,b);const T=e._bufferUpdateIDs[m]||0;u=u||_._updateID<T,u&&(_._updateID=e._updateID,_.uploadStatic(i,p,b)),n.geometry.bind(_.geometry),l.drawElements(l.TRIANGLES,b*6,l.UNSIGNED_SHORT,0)}}generateBuffers(e){const i=[],s=e._maxSize,r=e._batchSize,n=e._properties;for(let a=0;a<s;a+=r)i.push(new nc(this.properties,n,r));return i}_generateOneMoreBuffer(e){const i=e._batchSize,s=e._properties;return new nc(this.properties,s,i)}uploadVertices(e,i,s,r,n,a){let o=0,c=0,h=0,l=0;for(let f=0;f<s;++f){const u=e[i+f],p=u._texture,m=u.scale.x,b=u.scale.y,_=p.trim,T=p.orig;_?(c=_.x-u.anchor.x*T.width,o=c+_.width,l=_.y-u.anchor.y*T.height,h=l+_.height):(o=T.width*(1-u.anchor.x),c=T.width*-u.anchor.x,h=T.height*(1-u.anchor.y),l=T.height*-u.anchor.y),r[a]=c*m,r[a+1]=l*b,r[a+n]=o*m,r[a+n+1]=l*b,r[a+n*2]=o*m,r[a+n*2+1]=h*b,r[a+n*3]=c*m,r[a+n*3+1]=h*b,a+=n*4}}uploadPosition(e,i,s,r,n,a){for(let o=0;o<s;o++){const c=e[i+o].position;r[a]=c.x,r[a+1]=c.y,r[a+n]=c.x,r[a+n+1]=c.y,r[a+n*2]=c.x,r[a+n*2+1]=c.y,r[a+n*3]=c.x,r[a+n*3+1]=c.y,a+=n*4}}uploadRotation(e,i,s,r,n,a){for(let o=0;o<s;o++){const c=e[i+o].rotation;r[a]=c,r[a+n]=c,r[a+n*2]=c,r[a+n*3]=c,a+=n*4}}uploadUvs(e,i,s,r,n,a){for(let o=0;o<s;++o){const c=e[i+o]._texture._uvs;c?(r[a]=c.x0,r[a+1]=c.y0,r[a+n]=c.x1,r[a+n+1]=c.y1,r[a+n*2]=c.x2,r[a+n*2+1]=c.y2,r[a+n*3]=c.x3,r[a+n*3+1]=c.y3,a+=n*4):(r[a]=0,r[a+1]=0,r[a+n]=0,r[a+n+1]=0,r[a+n*2]=0,r[a+n*2+1]=0,r[a+n*3]=0,r[a+n*3+1]=0,a+=n*4)}}uploadTint(e,i,s,r,n,a){for(let o=0;o<s;++o){const c=e[i+o],h=ne.shared.setValue(c._tintRGB).toPremultiplied(c.alpha,c.texture.baseTexture.alphaMode>0);r[a]=h,r[a+n]=h,r[a+n*2]=h,r[a+n*3]=h,a+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Lh.extension={name:"particle",type:N.RendererPlugin};V.add(Lh);var Mr=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(Mr||{});const Us={willReadFrequently:!0},$=class{static get experimentalLetterSpacingSupported(){let t=$._experimentalLetterSpacingSupported;if(t!==void 0){const e=L.ADAPTER.getCanvasRenderingContext2D().prototype;t=$._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,s,r,n,a,o,c){this.text=t,this.style=e,this.width=i,this.height=s,this.lines=r,this.lineWidths=n,this.lineHeight=a,this.maxLineWidth=o,this.fontProperties=c}static measureText(t,e,i,s=$._canvas){i=i??e.wordWrap;const r=e.toFontString(),n=$.measureFont(r);n.fontSize===0&&(n.fontSize=e.fontSize,n.ascent=e.fontSize);const a=s.getContext("2d",Us);a.font=r;const c=(i?$.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),h=new Array(c.length);let l=0;for(let m=0;m<c.length;m++){const b=$._measureText(c[m],e.letterSpacing,a);h[m]=b,l=Math.max(l,b)}let f=l+e.strokeThickness;e.dropShadow&&(f+=e.dropShadowDistance);const u=e.lineHeight||n.fontSize+e.strokeThickness;let p=Math.max(u,n.fontSize+e.strokeThickness*2)+(c.length-1)*(u+e.leading);return e.dropShadow&&(p+=e.dropShadowDistance),new $(t,e,f,p,c,h,u+e.leading,l,n)}static _measureText(t,e,i){let s=!1;$.experimentalLetterSpacingSupported&&($.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let r=i.measureText(t).width;return r>0&&(s?r-=e:r+=($.graphemeSegmenter(t).length-1)*e),r}static wordWrap(t,e,i=$._canvas){const s=i.getContext("2d",Us);let r=0,n="",a="";const o=Object.create(null),{letterSpacing:c,whiteSpace:h}=e,l=$.collapseSpaces(h),f=$.collapseNewlines(h);let u=!l;const p=e.wordWrapWidth+c,m=$.tokenize(t);for(let b=0;b<m.length;b++){let _=m[b];if($.isNewline(_)){if(!f){a+=$.addLine(n),u=!l,n="",r=0;continue}_=" "}if(l){const g=$.isBreakingSpace(_),d=$.isBreakingSpace(n[n.length-1]);if(g&&d)continue}const T=$.getFromCache(_,c,o,s);if(T>p)if(n!==""&&(a+=$.addLine(n),n="",r=0),$.canBreakWords(_,e.breakWords)){const g=$.wordWrapSplit(_);for(let d=0;d<g.length;d++){let v=g[d],w=v,P=1;for(;g[d+P];){const I=g[d+P];if(!$.canBreakChars(w,I,_,d,e.breakWords))v+=I;else break;w=I,P++}d+=P-1;const R=$.getFromCache(v,c,o,s);R+r>p&&(a+=$.addLine(n),u=!1,n="",r=0),n+=v,r+=R}}else{n.length>0&&(a+=$.addLine(n),n="",r=0);const g=b===m.length-1;a+=$.addLine(_,!g),u=!1,n="",r=0}else T+r>p&&(u=!1,a+=$.addLine(n),n="",r=0),(n.length>0||!$.isBreakingSpace(_)||u)&&(n+=_,r+=T)}return a+=$.addLine(n,!1),a}static addLine(t,e=!0){return t=$.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,i,s){let r=i[t];return typeof r!="number"&&(r=$._measureText(t,e,s)+e,i[t]=r),r}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!$.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:$._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:$._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){const r=t[s],n=t[s+1];if($.isBreakingSpace(r,n)||$.isNewline(r)){i!==""&&(e.push(i),i=""),e.push(r);continue}i+=r}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,s,r){return!0}static wordWrapSplit(t){return $.graphemeSegmenter(t)}static measureFont(t){if($._fonts[t])return $._fonts[t];const e={ascent:0,descent:0,fontSize:0},i=$._canvas,s=$._context;s.font=t;const r=$.METRICS_STRING+$.BASELINE_SYMBOL,n=Math.ceil(s.measureText(r).width);let a=Math.ceil(s.measureText($.BASELINE_SYMBOL).width);const o=Math.ceil($.HEIGHT_MULTIPLIER*a);if(a=a*$.BASELINE_MULTIPLIER|0,n===0||o===0)return $._fonts[t]=e,e;i.width=n,i.height=o,s.fillStyle="#f00",s.fillRect(0,0,n,o),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(r,0,a);const c=s.getImageData(0,0,n,o).data,h=c.length,l=n*4;let f=0,u=0,p=!1;for(f=0;f<a;++f){for(let m=0;m<l;m+=4)if(c[u+m]!==255){p=!0;break}if(!p)u+=l;else break}for(e.ascent=a-f,u=h-l,p=!1,f=o;f>a;--f){for(let m=0;m<l;m+=4)if(c[u+m]!==255){p=!0;break}if(!p)u-=l;else break}return e.descent=f-a,e.fontSize=e.ascent+e.descent,$._fonts[t]=e,e}static clearMetrics(t=""){t?delete $._fonts[t]:$._fonts={}}static get _canvas(){if(!$.__canvas){let t;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",Us);if(i!=null&&i.measureText)return $.__canvas=e,e;t=L.ADAPTER.createCanvas()}catch{t=L.ADAPTER.createCanvas()}t.width=t.height=10,$.__canvas=t}return $.__canvas}static get _context(){return $.__context||($.__context=$._canvas.getContext("2d",Us)),$.__context}};let Te=$;Te.METRICS_STRING="|q";Te.BASELINE_SYMBOL="M";Te.BASELINE_MULTIPLIER=1.4;Te.HEIGHT_MULTIPLIER=2;Te.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(i=>i.segment)}return t=>[...t]})();Te.experimentalLetterSpacing=!1;Te._fonts={};Te._newlines=[10,13];Te._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const Tm=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Vi=class{constructor(t){this.styleID=0,this.reset(),bn(this,t,t)}clone(){const t={};return bn(t,this,Vi.defaultStyle),new Vi(t)}reset(){bn(this,Vi.defaultStyle,Vi.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=vn(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=vn(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){wm(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=vn(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let s=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!Tm.includes(s)&&(s=`"${s}"`),e[i]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};let bt=Vi;bt.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Mr.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function vn(t){const e=ne.shared;return Array.isArray(t)?t.map(i=>e.setValue(i).toHex()):e.setValue(t).toHex()}function wm(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}function bn(t,e,i){for(const s in i)Array.isArray(e[s])?t[s]=e[s].slice():t[s]=e[s]}const Sm={texture:!0,children:!1,baseTexture:!0},aa=class extends Et{constructor(t,e,i){let s=!1;i||(i=L.ADAPTER.createCanvas(),s=!0),i.width=3,i.height=3;const r=G.from(i);r.orig=new K,r.trim=new K,super(r),this._ownCanvas=s,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=aa.defaultResolution??L.RESOLUTION,this._autoResolution=aa.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return Te.experimentalLetterSpacing}static set experimentalLetterSpacing(t){te("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Te.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const i=this.context,s=Te.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),r=s.width,n=s.height,a=s.lines,o=s.lineHeight,c=s.lineWidths,h=s.maxLineWidth,l=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;let f,u;const p=e.dropShadow?2:1;for(let m=0;m<p;++m){const b=e.dropShadow&&m===0,_=b?Math.ceil(Math.max(1,n)+e.padding*2):0,T=_*this._resolution;if(b){i.fillStyle="black",i.strokeStyle="black";const d=e.dropShadowColor,v=e.dropShadowBlur*this._resolution,w=e.dropShadowDistance*this._resolution;i.shadowColor=ne.shared.setValue(d).setAlpha(e.dropShadowAlpha).toRgbaString(),i.shadowBlur=v,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*w,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*w+T}else i.fillStyle=this._generateFillStyle(e,a,s),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let g=(o-l.fontSize)/2;o-l.fontSize<0&&(g=0);for(let d=0;d<a.length;d++)f=e.strokeThickness/2,u=e.strokeThickness/2+d*o+l.ascent+g,e.align==="right"?f+=h-c[d]:e.align==="center"&&(f+=(h-c[d])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[d],f+e.padding,u+e.padding-_,!0),e.fill&&this.drawLetterSpacing(a[d],f+e.padding,u+e.padding-_)}this.updateTexture()}drawLetterSpacing(t,e,i,s=!1){const n=this._style.letterSpacing;let a=!1;if(Te.experimentalLetterSpacingSupported&&(Te.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||a){s?this.context.strokeText(t,e,i):this.context.fillText(t,e,i);return}let o=e;const c=Te.graphemeSegmenter(t);let h=this.context.measureText(t).width,l=0;for(let f=0;f<c.length;++f){const u=c[f];s?this.context.strokeText(u,o,i):this.context.fillText(u,o,i);let p="";for(let m=f+1;m<c.length;++m)p+=c[m];l=this.context.measureText(p).width,o+=h-l+n,h=l}}updateTexture(){const t=this.canvas;if(this._style.trim){const n=sd(t);n.data&&(t.width=n.width,t.height=n.height,this.context.putImageData(n.data,0,0))}const e=this._texture,i=this._style,s=i.trim?0:i.padding,r=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),r.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,i){const s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let r;const n=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,o=this.canvas.width/this._resolution-n-a*2,c=this.canvas.height/this._resolution-n-a*2,h=s.slice(),l=t.fillGradientStops.slice();if(!l.length){const f=h.length+1;for(let u=1;u<f;++u)l.push(u/f)}if(h.unshift(s[0]),l.unshift(0),h.push(s[s.length-1]),l.push(1),t.fillGradientType===Mr.LINEAR_VERTICAL){r=this.context.createLinearGradient(o/2,a,o/2,c+a);const f=i.fontProperties.fontSize+t.strokeThickness;for(let u=0;u<e.length;u++){const p=i.lineHeight*(u-1)+f,m=i.lineHeight*u;let b=m;u>0&&p>m&&(b=(m+p)/2);const _=m+f,T=i.lineHeight*(u+1);let g=_;u+1<e.length&&T<_&&(g=(_+T)/2);const d=(g-b)/c;for(let v=0;v<h.length;v++){let w=0;typeof l[v]=="number"?w=l[v]:w=v/h.length;let P=Math.min(1,Math.max(0,b/c+w*d));P=Number(P.toFixed(5)),r.addColorStop(P,h[v])}}}else{r=this.context.createLinearGradient(a,c/2,o+a,c/2);const f=h.length+1;let u=1;for(let p=0;p<h.length;p++){let m;typeof l[p]=="number"?m=l[p]:m=u/f,r.addColorStop(m,h[p]),u++}}return r}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Sm,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=Pt(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=Pt(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof bt?this._style=t:this._style=new bt(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};let Ma=aa;Ma.defaultAutoResolution=!0;class Am{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Cm(t,e){var s;let i=!1;if((s=t==null?void 0:t._textures)!=null&&s.length){for(let r=0;r<t._textures.length;r++)if(t._textures[r]instanceof G){const n=t._textures[r].baseTexture;e.includes(n)||(e.push(n),i=!0)}}return i}function Pm(t,e){if(t.baseTexture instanceof q){const i=t.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function Im(t,e){if(t._texture&&t._texture instanceof G){const i=t._texture.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function Rm(t,e){return e instanceof Ma?(e.updateText(!0),!0):!1}function Mm(t,e){if(e instanceof bt){const i=e.toFontString();return Te.measureFont(i),!0}return!1}function Dm(t,e){if(t instanceof Ma){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const i=t._texture.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function Bm(t,e){return t instanceof bt?(e.includes(t)||e.push(t),!0):!1}const Nh=class{constructor(t){this.limiter=new Am(Nh.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Dm),this.registerFindHook(Bm),this.registerFindHook(Cm),this.registerFindHook(Pm),this.registerFindHook(Im),this.registerUploadHook(Rm),this.registerUploadHook(Mm)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,Ce.system.addOnce(this.tick,this,Kt.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let i=0,s=this.uploadHooks.length;i<s;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)Ce.system.addOnce(this.tick,this,Kt.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,i=t.length;e<i;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Le)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&Ce.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let mr=Nh;mr.uploadsPerFrame=4;Object.defineProperties(L,{UPLOADS_PER_FRAME:{get(){return mr.uploadsPerFrame},set(t){te("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),mr.uploadsPerFrame=t}}});function kh(t,e){return e instanceof q?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function Om(t,e){if(!(e instanceof Rr))return!1;const{geometry:i}=e;e.finishPoly(),i.updateBatches();const{batches:s}=i;for(let r=0;r<s.length;r++){const{texture:n}=s[r].style;n&&kh(t,n.baseTexture)}return i.batchable||t.geometry.bind(i,e._resolveDirectShader(t)),!0}function Fm(t,e){return t instanceof Rr?(e.push(t),!0):!1}class Uh extends mr{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(Fm),this.registerUploadHook(kh),this.registerUploadHook(Om)}}Uh.extension={name:"prepare",type:N.RendererSystem};V.add(Uh);var Lm=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,Nm=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,km=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,ac=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Um=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Gs=new ce;class Gh extends Er{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new th,this.state=xt.for2d()}contextChange(){const e=this.renderer,i={globals:e.globalUniforms};this.simpleShader=lt.from(ac,Um,i),this.shader=e.context.webGLVersion>1?lt.from(Nm,Lm,i):lt.from(ac,km,i)}render(e){const i=this.renderer,s=this.quad;let r=s.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y);const n=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0;r=s.uvs,r[0]=r[6]=-n,r[1]=r[3]=-a,r[2]=r[4]=1-n,r[5]=r[7]=1-a,s.invalidate();const o=e._texture,c=o.baseTexture,h=c.alphaMode>0,l=e.tileTransform.localTransform,f=e.uvMatrix;let u=c.isPowerOfTwo&&o.frame.width===c.width&&o.frame.height===c.height;u&&(c._glTextures[i.CONTEXT_UID]?u=c.wrapMode!==Rt.CLAMP:c.wrapMode===Rt.CLAMP&&(c.wrapMode=Rt.REPEAT));const p=u?this.simpleShader:this.shader,m=o.width,b=o.height,_=e._width,T=e._height;Gs.set(l.a*m/_,l.b*m/T,l.c*b/_,l.d*b/T,l.tx/_,l.ty/T),Gs.invert(),u?Gs.prepend(f.mapCoord):(p.uniforms.uMapCoord=f.mapCoord.toArray(!0),p.uniforms.uClampFrame=f.uClampFrame,p.uniforms.uClampOffset=f.uClampOffset),p.uniforms.uTransform=Gs.toArray(!0),p.uniforms.uColor=ne.shared.setValue(e.tint).premultiply(e.worldAlpha,h).toArray(p.uniforms.uColor),p.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),p.uniforms.uSampler=o,i.shader.bind(p),i.geometry.bind(s),this.state.blendMode=Lc(e.blendMode,h),i.state.set(this.state),i.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Gh.extension={name:"tilingSprite",type:N.RendererPlugin};V.add(Gh);const zi=class{constructor(t,e,i=null){this.linkedSheets=[],this._texture=t instanceof G?t:null,this.baseTexture=t instanceof q?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const s=this.baseTexture.resource;this.resolution=this._updateResolution(i||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let i=Mt(t,null);return i===null&&(i=parseFloat(e??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=zi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=zi.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const s=this._frameKeys[e],r=this._frames[s],n=r.frame;if(n){let a=null,o=null;const c=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,h=new K(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);r.rotated?a=new K(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):a=new K(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(o=new K(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[s]=new G(this.baseTexture,a,h,o,r.rotated?2:0,r.anchor,r.borders),G.addToCache(this.textures[s],s)}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const s=t[e][i];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*zi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*zi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let oa=zi;oa.BATCH_SIZE=1e3;const Gm=["jpg","png","jpeg","avif","webp"];function Hh(t,e,i){const s={};if(t.forEach(r=>{s[r]=e}),Object.keys(e.textures).forEach(r=>{s[r]=e.textures[r]}),!i){const r=Ie.dirname(t[0]);e.linkedSheets.forEach((n,a)=>{const o=Hh([`${r}/${e.data.meta.related_multi_packs[a]}`],n,!0);Object.assign(s,o)})}return s}const Hm={extension:N.Asset,cache:{test:t=>t instanceof oa,getCacheableAssets:(t,e)=>Hh(t,e,!1)},resolver:{test:t=>{const i=t.split("?")[0].split("."),s=i.pop(),r=i.pop();return s==="json"&&Gm.includes(r)},parse:t=>{var i;const e=t.split(".");return{resolution:parseFloat(((i=L.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:N.LoadParser,priority:dt.Normal},async testParse(t,e){return Ie.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,i){var h,l;let s=Ie.dirname(e.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let r=s+t.meta.image;r=sa(r,e.src);const a=(await i.load([r]))[r],o=new oa(a.baseTexture,t,e.src);await o.parse();const c=(h=t==null?void 0:t.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(c)){const f=[];for(const p of c){if(typeof p!="string")continue;let m=s+p;(l=e.data)!=null&&l.ignoreMultiPack||(m=sa(m,e.src),f.push(i.load({src:m,data:{ignoreMultiPack:!0}})))}const u=await Promise.all(f);o.linkedSheets=u,u.forEach(p=>{p.linkedSheets=[o].concat(o.linkedSheets.filter(m=>m!==p))})}return o},unload(t){t.destroy(!0)}}};V.add(Hm);class gr{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Js{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const i=e.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in i){const a=i[n].match(/^[a-z]+/gm)[0],o=i[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const h in o){const l=o[h].split("="),f=l[0],u=l[1].replace(/"/gm,""),p=parseFloat(u),m=isNaN(p)?u:p;c[f]=m}s[a].push(c)}const r=new gr;return s.info.forEach(n=>r.info.push({face:n.face,size:parseInt(n.size,10)})),s.common.forEach(n=>r.common.push({lineHeight:parseInt(n.lineHeight,10)})),s.page.forEach(n=>r.page.push({id:parseInt(n.id,10),file:n.file})),s.char.forEach(n=>r.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),s.kerning.forEach(n=>r.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),s.distanceField.forEach(n=>r.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),r}}class ca{static test(e){const i=e;return"getElementsByTagName"in i&&i.getElementsByTagName("page").length&&i.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const i=new gr,s=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),n=e.getElementsByTagName("page"),a=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning"),c=e.getElementsByTagName("distanceField");for(let h=0;h<s.length;h++)i.info.push({face:s[h].getAttribute("face"),size:parseInt(s[h].getAttribute("size"),10)});for(let h=0;h<r.length;h++)i.common.push({lineHeight:parseInt(r[h].getAttribute("lineHeight"),10)});for(let h=0;h<n.length;h++)i.page.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});for(let h=0;h<a.length;h++){const l=a[h];i.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(let h=0;h<o.length;h++)i.kerning.push({first:parseInt(o[h].getAttribute("first"),10),second:parseInt(o[h].getAttribute("second"),10),amount:parseInt(o[h].getAttribute("amount"),10)});for(let h=0;h<c.length;h++)i.distanceField.push({fieldType:c[h].getAttribute("fieldType"),distanceRange:parseInt(c[h].getAttribute("distanceRange"),10)});return i}}class ha{static test(e){return typeof e=="string"&&e.includes("<font>")?ca.test(L.ADAPTER.parseXML(e)):!1}static parse(e){return ca.parse(L.ADAPTER.parseXML(e))}}const xn=[Js,ca,ha];function Xm(t){for(let e=0;e<xn.length;e++)if(xn[e].test(t))return xn[e];return null}function $m(t,e,i,s,r,n){const a=i.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let o;const c=i.dropShadow?i.dropShadowDistance:0,h=i.padding||0,l=t.width/s-c-h*2,f=t.height/s-c-h*2,u=a.slice(),p=i.fillGradientStops.slice();if(!p.length){const m=u.length+1;for(let b=1;b<m;++b)p.push(b/m)}if(u.unshift(a[0]),p.unshift(0),u.push(a[a.length-1]),p.push(1),i.fillGradientType===Mr.LINEAR_VERTICAL){o=e.createLinearGradient(l/2,h,l/2,f+h);let m=0;const _=(n.fontProperties.fontSize+i.strokeThickness)/f;for(let T=0;T<r.length;T++){const g=n.lineHeight*T;for(let d=0;d<u.length;d++){let v=0;typeof p[d]=="number"?v=p[d]:v=d/u.length;const w=g/f+v*_;let P=Math.max(m,w);P=Math.min(P,1),o.addColorStop(P,u[d]),m=P}}}else{o=e.createLinearGradient(h,f/2,l+h,f/2);const m=u.length+1;let b=1;for(let _=0;_<u.length;_++){let T;typeof p[_]=="number"?T=p[_]:T=b/m,o.addColorStop(T,u[_]),b++}}return o}function Vm(t,e,i,s,r,n,a){const o=i.text,c=i.fontProperties;e.translate(s,r),e.scale(n,n);const h=a.strokeThickness/2,l=-(a.strokeThickness/2);if(e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=$m(t,e,a,n,[o],i),e.strokeStyle=a.stroke,a.dropShadow){const f=a.dropShadowColor,u=a.dropShadowBlur*n,p=a.dropShadowDistance*n;e.shadowColor=ne.shared.setValue(f).setAlpha(a.dropShadowAlpha).toRgbaString(),e.shadowBlur=u,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;a.stroke&&a.strokeThickness&&e.strokeText(o,h,l+i.lineHeight-c.descent),a.fill&&e.fillText(o,h,l+i.lineHeight-c.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Qs(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function Xh(t){return Array.from?Array.from(t):t.split("")}function zm(t){typeof t=="string"&&(t=[t]);const e=[];for(let i=0,s=t.length;i<s;i++){const r=t[i];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const n=r[0].charCodeAt(0),a=r[1].charCodeAt(0);if(a<n)throw new Error("[BitmapFont]: Invalid character range.");for(let o=n,c=a;o<=c;o++)e.push(String.fromCharCode(o))}else e.push(...Xh(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const ze=class{constructor(t,e,i){var h;const[s]=t.info,[r]=t.common,[n]=t.page,[a]=t.distanceField,o=Mt(n.file),c={};this._ownsTextures=i,this.font=s.face,this.size=s.size,this.lineHeight=r.lineHeight/o,this.chars={},this.pageTextures=c;for(let l=0;l<t.page.length;l++){const{id:f,file:u}=t.page[l];c[f]=e instanceof Array?e[l]:e[u],a!=null&&a.fieldType&&a.fieldType!=="none"&&(c[f].baseTexture.alphaMode=et.NO_PREMULTIPLIED_ALPHA,c[f].baseTexture.mipmap=ut.OFF)}for(let l=0;l<t.char.length;l++){const{id:f,page:u}=t.char[l];let{x:p,y:m,width:b,height:_,xoffset:T,yoffset:g,xadvance:d}=t.char[l];p/=o,m/=o,b/=o,_/=o,T/=o,g/=o,d/=o;const v=new K(p+c[u].frame.x/o,m+c[u].frame.y/o,b,_);this.chars[f]={xOffset:T,yOffset:g,xAdvance:d,kerning:{},texture:new G(c[u].baseTexture,v),page:u}}for(let l=0;l<t.kerning.length;l++){let{first:f,second:u,amount:p}=t.kerning[l];f/=o,u/=o,p/=o,this.chars[u]&&(this.chars[u].kerning[f]=p)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((h=a==null?void 0:a.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,i){let s;if(t instanceof gr)s=t;else{const n=Xm(t);if(!n)throw new Error("Unrecognized data format for font.");s=n.parse(t)}e instanceof G&&(e=[e]);const r=new ze(s,e,i);return ze.available[r.font]=r,r}static uninstall(t){const e=ze.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete ze.available[t]}static from(t,e,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:r,resolution:n,textureWidth:a,textureHeight:o,...c}=Object.assign({},ze.defaultOptions,i),h=zm(s),l=e instanceof bt?e:new bt(e),f=a,u=new gr;u.info[0]={face:l.fontFamily,size:l.fontSize},u.common[0]={lineHeight:l.fontSize};let p=0,m=0,b,_,T,g=0;const d=[];for(let w=0;w<h.length;w++){b||(b=L.ADAPTER.createCanvas(),b.width=a,b.height=o,_=b.getContext("2d"),T=new q(b,{resolution:n,...c}),d.push(new G(T)),u.page.push({id:d.length-1,file:""}));const P=h[w],R=Te.measureText(P,l,!1,b),I=R.width,E=Math.ceil(R.height),x=Math.ceil((l.fontStyle==="italic"?2:1)*I);if(m>=o-E*n){if(m===0)throw new Error(`[BitmapFont] textureHeight ${o}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${P}')`);--w,b=null,_=null,T=null,m=0,p=0,g=0;continue}if(g=Math.max(E+R.fontProperties.descent,g),x*n+p>=f){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${P}')`);--w,m+=g*n,m=Math.ceil(m),p=0,g=0;continue}Vm(b,_,R,p,m,n,l);const y=Qs(R.text);u.char.push({id:y,page:d.length-1,x:p/n,y:m/n,width:x,height:E,xoffset:0,yoffset:0,xadvance:I-(l.dropShadow?l.dropShadowDistance:0)-(l.stroke?l.strokeThickness:0)}),p+=(x+2*r)*n,p=Math.ceil(p)}for(let w=0,P=h.length;w<P;w++){const R=h[w];for(let I=0;I<P;I++){const E=h[I],x=_.measureText(R).width,y=_.measureText(E).width,S=_.measureText(R+E).width-(x+y);S&&u.kerning.push({first:Qs(R),second:Qs(E),amount:S})}}const v=new ze(u,d,!0);return ze.available[t]!==void 0&&ze.uninstall(t),ze.available[t]=v,v}};let Me=ze;Me.ALPHA=[["a","z"],["A","Z"]," "];Me.NUMERIC=[["0","9"]];Me.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Me.ASCII=[[" ","~"]];Me.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ze.ALPHANUMERIC};Me.available={};var Wm=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,jm=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const oc=[],cc=[],hc=[],$h=class extends Le{constructor(t,e={}){super();const{align:i,tint:s,maxWidth:r,letterSpacing:n,fontName:a,fontSize:o}=Object.assign({},$h.styleDefaults,e);if(!Me.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new ne(s),this._font=void 0,this._fontName=a,this._fontSize=o,this.text=t,this._maxWidth=r,this._maxLineHeight=0,this._letterSpacing=n,this._anchor=new It(()=>{this.dirty=!0},this,0,0),this._roundPixels=L.ROUND_PIXELS,this.dirty=!0,this._resolution=L.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var x;const t=Me.available[this._fontName],e=this.fontSize,i=e/t.size,s=new ie,r=[],n=[],a=[],o=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=Xh(o),h=this._maxWidth*t.size/e,l=t.distanceFieldType==="none"?oc:cc;let f=null,u=0,p=0,m=0,b=-1,_=0,T=0,g=0,d=0;for(let y=0;y<c.length;y++){const C=c[y],S=Qs(C);if(/(?:\s)/.test(C)&&(b=y,_=u,d++),C==="\r"||C===`
`){n.push(u),a.push(-1),p=Math.max(p,u),++m,++T,s.x=0,s.y+=t.lineHeight,f=null,d=0;continue}const A=t.chars[S];if(!A)continue;f&&A.kerning[f]&&(s.x+=A.kerning[f]);const B=hc.pop()||{texture:G.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ie};B.texture=A.texture,B.line=m,B.charCode=S,B.position.x=Math.round(s.x+A.xOffset+this._letterSpacing/2),B.position.y=Math.round(s.y+A.yOffset),B.prevSpaces=d,r.push(B),u=B.position.x+Math.max(A.xAdvance-A.xOffset,A.texture.orig.width),s.x+=A.xAdvance+this._letterSpacing,g=Math.max(g,A.yOffset+A.texture.height),f=S,b!==-1&&h>0&&s.x>h&&(++T,_i(r,1+b-T,1+y-b),y=b,b=-1,n.push(_),a.push(r.length>0?r[r.length-1].prevSpaces:0),p=Math.max(p,_),m++,s.x=0,s.y+=t.lineHeight,f=null,d=0)}const v=c[c.length-1];v!=="\r"&&v!==`
`&&(/(?:\s)/.test(v)&&(u=_),n.push(u),p=Math.max(p,u),a.push(-1));const w=[];for(let y=0;y<=m;y++){let C=0;this._align==="right"?C=p-n[y]:this._align==="center"?C=(p-n[y])/2:this._align==="justify"&&(C=a[y]<0?0:(p-n[y])/a[y]),w.push(C)}const P=r.length,R={},I=[],E=this._activePagesMeshData;l.push(...E);for(let y=0;y<P;y++){const C=r[y].texture,S=C.baseTexture.uid;if(!R[S]){let A=l.pop();if(!A){const M=new _m;let O,H;t.distanceFieldType==="none"?(O=new rc(G.EMPTY),H=Y.NORMAL):(O=new rc(G.EMPTY,{program:Ke.from(jm,Wm),uniforms:{uFWidth:0}}),H=Y.NORMAL_NPM);const j=new na(M,O);j.blendMode=H,A={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:j,vertices:null,uvs:null,indices:null}}A.index=0,A.indexCount=0,A.vertexCount=0,A.uvsCount=0,A.total=0;const{_textureCache:B}=this;B[S]=B[S]||new G(C.baseTexture),A.mesh.texture=B[S],A.mesh.tint=this._tintColor.value,I.push(A),R[S]=A}R[S].total++}for(let y=0;y<E.length;y++)I.includes(E[y])||this.removeChild(E[y].mesh);for(let y=0;y<I.length;y++)I[y].mesh.parent!==this&&this.addChild(I[y].mesh);this._activePagesMeshData=I;for(const y in R){const C=R[y],S=C.total;if(!(((x=C.indices)==null?void 0:x.length)>6*S)||C.vertices.length<na.BATCHABLE_SIZE*2)C.vertices=new Float32Array(4*2*S),C.uvs=new Float32Array(4*2*S),C.indices=new Uint16Array(6*S);else{const A=C.total,B=C.vertices;for(let M=A*4*2;M<B.length;M++)B[M]=0}C.mesh.size=6*S}for(let y=0;y<P;y++){const C=r[y];let S=C.position.x+w[C.line]*(this._align==="justify"?C.prevSpaces:1);this._roundPixels&&(S=Math.round(S));const A=S*i,B=C.position.y*i,M=C.texture,O=R[M.baseTexture.uid],H=M.frame,j=M._uvs,D=O.index++;O.indices[D*6+0]=0+D*4,O.indices[D*6+1]=1+D*4,O.indices[D*6+2]=2+D*4,O.indices[D*6+3]=0+D*4,O.indices[D*6+4]=2+D*4,O.indices[D*6+5]=3+D*4,O.vertices[D*8+0]=A,O.vertices[D*8+1]=B,O.vertices[D*8+2]=A+H.width*i,O.vertices[D*8+3]=B,O.vertices[D*8+4]=A+H.width*i,O.vertices[D*8+5]=B+H.height*i,O.vertices[D*8+6]=A,O.vertices[D*8+7]=B+H.height*i,O.uvs[D*8+0]=j.x0,O.uvs[D*8+1]=j.y0,O.uvs[D*8+2]=j.x1,O.uvs[D*8+3]=j.y1,O.uvs[D*8+4]=j.x2,O.uvs[D*8+5]=j.y2,O.uvs[D*8+6]=j.x3,O.uvs[D*8+7]=j.y3}this._textWidth=p*i,this._textHeight=(s.y+t.lineHeight)*i;for(const y in R){const C=R[y];if(this.anchor.x!==0||this.anchor.y!==0){let M=0;const O=this._textWidth*this.anchor.x,H=this._textHeight*this.anchor.y;for(let j=0;j<C.total;j++)C.vertices[M++]-=O,C.vertices[M++]-=H,C.vertices[M++]-=O,C.vertices[M++]-=H,C.vertices[M++]-=O,C.vertices[M++]-=H,C.vertices[M++]-=O,C.vertices[M++]-=H}this._maxLineHeight=g*i;const S=C.mesh.geometry.getBuffer("aVertexPosition"),A=C.mesh.geometry.getBuffer("aTextureCoord"),B=C.mesh.geometry.getIndex();S.data=C.vertices,A.data=C.uvs,B.data=C.indices,S.update(),A.update(),B.update()}for(let y=0;y<r.length;y++)hc.push(r[y]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:i,size:s}=Me.available[this._fontName];if(i!=="none"){const{a:r,b:n,c:a,d:o}=this.worldTransform,c=Math.sqrt(r*r+n*n),h=Math.sqrt(a*a+o*o),l=(Math.abs(c)+Math.abs(h))/2,f=this.fontSize/s,u=t._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=l*e*f*u}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=Me.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!Me.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??Me.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,s=Me.available[this._fontName].distanceFieldType==="none"?oc:cc;s.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],s.filter(r=>e[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=G.EMPTY});for(const r in e)e[r].destroy(),delete e[r];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};let Ym=$h;Ym.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const qm=[".xml",".fnt"],Km={extension:{type:N.LoadParser,priority:dt.Normal},name:"loadBitmapFont",test(t){return qm.includes(Ie.extname(t).toLowerCase())},async testParse(t){return Js.test(t)||ha.test(t)},async parse(t,e,i){const s=Js.test(t)?Js.parse(t):ha.parse(t),{src:r}=e,{page:n}=s,a=[];for(let h=0;h<n.length;++h){const l=n[h].file;let f=Ie.join(Ie.dirname(r),l);f=sa(f,r),a.push(f)}const o=await i.load(a),c=a.map(h=>o[h]);return Me.install(s,c,!0)},async load(t,e){return(await L.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};V.add(Km);const li=class extends bt{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new li(Object.keys(li.defaultOptions).reduce((e,i)=>({...e,[i]:t[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete li.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:i}=li;if(i[t]){const s=i[t];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return L.ADAPTER.fetch(t).then(s=>s.blob()).then(async s=>new Promise((r,n)=>{const a=URL.createObjectURL(s),o=new FileReader;o.onload=()=>r([a,o.result]),o.onerror=n,o.readAsDataURL(s)})).then(async([s,r])=>{const n=Object.assign({family:Ie.basename(t,Ie.extname(t)),weight:"normal",style:"normal",src:s,dataSrc:r,refs:1,originalUrl:t,fontFace:null},e);i[t]=n,this._fonts.push(n),this.styleID++;const a=new FontFace(n.family,`url(${n.src})`,{weight:n.weight,style:n.style});n.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(i=>!this._overrides.includes(i));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(i=>this._overrides.includes(i));e.length>0&&(this._overrides=this._overrides.filter(i=>!e.includes(i)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=Zu(t)),typeof t=="number"?Ku(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const r=`${i}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${r} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${r} ${t}`}reset(){Object.assign(this,li.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=L.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let Zi=li;Zi.availableFonts={};Zi.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const fi=class extends Et{constructor(t="",e={}){super(G.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const i=new Image,s=G.from(i,{scaleMode:L.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new K,s.trim=new K,this.texture=s;const r="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xhtml",a=document.createElementNS(r,"svg"),o=document.createElementNS(r,"foreignObject"),c=document.createElementNS(n,"div"),h=document.createElementNS(n,"style");o.setAttribute("width","10000"),o.setAttribute("height","10000"),o.style.overflow="hidden",a.appendChild(o),this.maxWidth=fi.defaultMaxWidth,this.maxHeight=fi.defaultMaxHeight,this._domElement=c,this._styleElement=h,this._svgRoot=a,this._foreignObject=o,this._foreignObject.appendChild(h),this._foreignObject.appendChild(c),this._image=i,this._loadImage=new Image,this._autoResolution=fi.defaultAutoResolution,this._resolution=fi.defaultResolution??L.RESOLUTION,this.text=t,this.style=e}measureText(t){var o,c;const{text:e,style:i,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:i.toCSS(s)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const r=this._domElement.getBoundingClientRect();this._svgRoot.remove();const n=Math.min(this.maxWidth,Math.ceil(r.width)),a=Math.min(this.maxHeight,Math.ceil(r.height));return this._svgRoot.setAttribute("width",n.toString()),this._svgRoot.setAttribute("height",a.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(o=this._style)==null?void 0:o.toCSS(s)}),this._styleElement.textContent=(c=this._style)==null?void 0:c.toGlobalCSS()),{width:n+i.padding*2,height:a+i.padding*2}}async updateText(t=!0){const{style:e,_image:i,_loadImage:s}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:r,height:n}=this.measureText();i.width=s.width=Math.ceil(Math.max(1,r)),i.height=s.height=Math.ceil(Math.max(1,n)),this._loading||(this._loading=!0,await new Promise(a=>{s.onload=async()=>{await e.onBeforeDraw(),this._loading=!1,i.src=s.src,s.onload=null,s.src="",this.updateTexture(),a()};const o=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(o)}`}))}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:i,resolution:s}=this,{padding:r}=t,{baseTexture:n}=e;e.trim.width=e._frame.width=i.width/s,e.trim.height=e._frame.height=i.height/s,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-r*2,e.orig.height=e._frame.height-r*2,this._onTextureUpdate(),n.setRealSize(i.width,i.height,s),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var i,s,r,n,a;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},fi.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=e,(s=this._svgRoot)==null||s.remove(),this._svgRoot=e,(r=this._domElement)==null||r.remove(),this._domElement=e,(n=this._foreignObject)==null||n.remove(),this._foreignObject=e,(a=this._styleElement)==null||a.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=Pt(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=Pt(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof Zi?(this.ownsStyle=!1,this._style=t):t instanceof bt?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Zi.from(t)):(this.ownsStyle=!0,this._style=new Zi(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let Dr=fi;Dr.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};Dr.defaultMaxWidth=2024;Dr.defaultMaxHeight=2024;Dr.defaultAutoResolution=!0;const fs=(t,e)=>e(t),W=(t,e)=>new ie(t,e);W.from=t=>W(t.x,t.y);W.add=(t,e)=>W.from(fs(t,i=>W(i.x+e.x,i.y+e.y)));W.sub=(t,e)=>W.from(fs(t,i=>W(i.x-e.x,i.y-e.y)));W.mul=(t,e)=>W.from(fs(t,i=>W(i.x*e.x,i.y*e.y)));W.div=(t,e)=>W.from(fs(t,i=>W(i.x/e.x,i.y/e.y)));W.mod=(t,e)=>W.from(fs(t,i=>W(i.x%e.x,i.y%e.y)));const Ai=(t,e,i,s)=>new K(t,e,i,s);Ai.xy=t=>W(t.x,t.y);Ai.wh=t=>W(t.width,t.height);const Zm=t=>t.filter((e,i)=>i%2===0).map((e,i)=>W(e,t[i*2+1])),Jm=(t,e)=>t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height,Qm=(t,e)=>e instanceof ie?W((e.x-t.x)/2,(e.y-t.y)/2):W(e.x+(e.width-t.x)/2,e.y+(e.height-t.y)/2);class e4{constructor(){Q(this,"_buttonDict");this._buttonDict=new Map,document.addEventListener("keydown",e=>{const i=e.key;this._buttonDict.has(i)||this._buttonDict.set(i,0)}),document.addEventListener("keyup",e=>{const i=e.key;this._buttonDict.delete(i)})}get buttonDict(){return this._buttonDict}update(){this._buttonDict.forEach((e,i)=>{this._buttonDict.has(i)&&this._buttonDict.set(i,e+1)})}}var Vh=(t=>(t[t.A=0]="A",t[t.B=1]="B",t[t.X=2]="X",t[t.Y=3]="Y",t[t.L1=4]="L1",t[t.R1=5]="R1",t[t.L2=6]="L2",t[t.R2=7]="R2",t[t.SELECT=8]="SELECT",t[t.START=9]="START",t[t.L3=10]="L3",t[t.R3=11]="R3",t[t.UP=12]="UP",t[t.DOWN=13]="DOWN",t[t.LEFT=14]="LEFT",t[t.RIGHT=15]="RIGHT",t[t.CENTER=16]="CENTER",t))(Vh||{});const t4=(t,e,i)=>{const[s,r]=[(e-i+360)%360,(e+i)%360];return s>r&&(t.angle>=s||t.angle<=r)||t.angle>=s&&t.angle<=r?t.velocity:0};class i4{constructor(){Q(this,"_buttonDict");Q(this,"_stickDict");this._buttonDict=new Map,this._stickDict=new Map,window.addEventListener("gamepadconnected",()=>{})}get buttonDict(){return this._buttonDict}get stickDict(){return this._stickDict}update(){navigator.getGamepads().forEach((e,i)=>{e&&(this._buttonDict.has(i)||this._buttonDict.set(i,new Map),e.buttons.forEach((s,r)=>{const n=this._buttonDict.get(i);if(!n)return;const a=Vh[r],o=n.has(a);if(s.pressed&&!o)n.set(a,1);else if(!s.pressed&&o)n.delete(a);else if(s.pressed&&o){const c=n.get(a);if(!c)return;n.set(a,c+1)}}),this._stickDict.set(i,Zm(e.axes).map(({x:s,y:r})=>({dx:Math.min(Math.max(s,-1),1),dy:Math.min(Math.max(r,-1),1),angle:(Math.atan2(r,s)*(180/Math.PI)+360)%360,velocity:Math.min(Math.max(Math.sqrt(s*s+r*r),0),1)}))))})}}var la=(t=>(t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t[t.WHEEL_UP=100]="WHEEL_UP",t[t.WHEEL_DOWN=101]="WHEEL_DOWN",t[t.WHEEL_LEFT=102]="WHEEL_LEFT",t[t.WHEEL_RIGHT=103]="WHEEL_RIGHT",t))(la||{});class s4{constructor(e,i){Q(this,"screenSize");Q(this,"wheelDelta");Q(this,"prevPosition");Q(this,"_buttonDict");Q(this,"_position");Q(this,"_deltaPosition");this.screenSize=e,this._buttonDict=new Map,this.wheelDelta=W(0,0),this._position=W(0,0),this.prevPosition=W(0,0),this._deltaPosition=W(0,0),document.addEventListener("mousedown",r=>{const n=la[r.button];r.button<3&&!this._buttonDict.has(n)&&this._buttonDict.set(n,0)}),document.addEventListener("mouseup",r=>{const n=la[r.button];this._buttonDict.delete(n)}),document.addEventListener("contextmenu",r=>r.preventDefault()),document.addEventListener("wheel",({deltaX:r,deltaY:n})=>{this.wheelDelta.x=r,this.wheelDelta.y=n,n<0&&!this._buttonDict.has("WHEEL_UP")&&this._buttonDict.set("WHEEL_UP",0),n>0&&!this._buttonDict.has("WHEEL_DOWN")&&this._buttonDict.set("WHEEL_DOWN",0),r<0&&!this._buttonDict.has("WHEEL_LEFT")&&this._buttonDict.set("WHEEL_LEFT",0),r>0&&!this._buttonDict.has("WHEEL_RIGHT")&&this._buttonDict.set("WHEEL_RIGHT",0)});const s=new Et(G.WHITE);s.name="MouseManager: touchScreen",s.width=this.screenSize.x,s.height=this.screenSize.y,s.alpha=0,s.eventMode="static",s.on("pointermove",r=>{this.prevPosition.set(this._position.x,this._position.y),this._position.set(r.global.x,r.global.y),this._deltaPosition.set(this._position.x-this.prevPosition.x,this._position.y-this.prevPosition.y)}),i.addChild(s)}get buttonDict(){return this._buttonDict}get deltaPosition(){return this._deltaPosition}get position(){return this._position}update(){this._buttonDict.forEach((e,i)=>{this._buttonDict.has(i)&&this._buttonDict.set(i,e+1);const s=5;((this._buttonDict.get("WHEEL_UP")??0)>=s||(this._buttonDict.get("WHEEL_DOWN")??0)>=s||(this._buttonDict.get("WHEEL_LEFT")??0)>=s||(this._buttonDict.get("WHEEL_RIGHT")??0)>=s)&&(this._buttonDict.delete("WHEEL_UP"),this._buttonDict.delete("WHEEL_DOWN"),this._buttonDict.delete("WHEEL_LEFT"),this._buttonDict.delete("WHEEL_RIGHT"),this.wheelDelta.set(0,0)),this._deltaPosition.set(this._position.x-this.prevPosition.x,this._position.y-this.prevPosition.y)})}}class r4{constructor(e,i){Q(this,"keyboardDevice");Q(this,"gamepadDevice");Q(this,"mouseDevice");this.keyboardDevice=new e4,this.gamepadDevice=new i4,this.mouseDevice=new s4(e,i)}_update(){this.keyboardDevice.update(),this.gamepadDevice.update(),this.mouseDevice.update()}isKeyTriggered(e){return(this.keyboardDevice.buttonDict.get(e)??NaN)===1}isKeyPressed(e,i=1){return(this.keyboardDevice.buttonDict.get(e)??NaN)>i}isKeyReleased(e){return!this.keyboardDevice.buttonDict.has(e)}isPadTriggered(e,i){const s=this.gamepadDevice.buttonDict.get(e);return((s==null?void 0:s.get(i))??NaN)===1}isPadPressed(e,i,s=1){const r=this.gamepadDevice.buttonDict.get(e);return((r==null?void 0:r.get(i))??NaN)>s}isPadReleased(e,i){const s=this.gamepadDevice.buttonDict.get(e);return!(s!=null&&s.has(i))}isMouseTriggered(e){return(this.mouseDevice.buttonDict.get(e)??NaN)===1}isMousePressed(e,i=1){return(this.mouseDevice.buttonDict.get(e)??NaN)>i}isMouseReleased(e){return!this.mouseDevice.buttonDict.has(e)}getPadStick(e,i,s=.2){var o;const r=(o=this.gamepadDevice.stickDict.get(e))==null?void 0:o[i];if(!r)return W(0,0);const{dx:n,dy:a}=r;return W(n>=s||n<=s?n:0,a>=s||a<=s?a:0)}getPadStickAngle(e,i,s,r=45,n=.2){var c;const a=(c=this.gamepadDevice.stickDict.get(e))==null?void 0:c[i];if(!a)return 0;const o=t4(a,s,r);return o>=n?o:0}getPadStickRight(e,i,s=45,r=.2){return this.getPadStickAngle(e,i,45*0,s,r)}getPadStickDown(e,i,s=45,r=.2){return this.getPadStickAngle(e,i,45*2,s,r)}getPadStickLeft(e,i,s=45,r=.2){return this.getPadStickAngle(e,i,45*4,s,r)}getPadStickUp(e,i,s=45,r=.2){return this.getPadStickAngle(e,i,45*6,s,r)}getMousePosition(){return this.mouseDevice.position}getMouseMoveDelta(e=.2,i=1/0){const{x:s,y:r}=this.mouseDevice.deltaPosition;return W(s>=e?Math.min(i,s):s<=-e?Math.max(-i,s):0,r>=e?Math.min(i,r):r<=-e?Math.max(-i,r):0)}getAxis(e,{padPlayer:i=0,padStick:s=0,padRange:r=45,threshold:n=.2}={}){const a=W(0,0);switch(e){case"WASD":{this.isKeyPressed("w")&&(a.y=-1),this.isKeyPressed("a")&&(a.x=-1),this.isKeyPressed("s")&&(a.y=1),this.isKeyPressed("d")&&(a.x=1);break}case"ARROW":{this.isKeyPressed("ArrowLeft")&&(a.x=-1),this.isKeyPressed("ArrowRight")&&(a.x=1),this.isKeyPressed("ArrowUp")&&(a.y=-1),this.isKeyPressed("ArrowDown")&&(a.y=1);break}case"NUM":{this.isKeyPressed("2")&&(a.y=1),this.isKeyPressed("4")&&(a.x=-1),this.isKeyPressed("6")&&(a.x=1),this.isKeyPressed("8")&&(a.y=-1);break}case"HJKL":{this.isKeyPressed("h")&&(a.x=-1),this.isKeyPressed("j")&&(a.y=1),this.isKeyPressed("k")&&(a.y=-1),this.isKeyPressed("l")&&(a.x=1);break}case"IJKL":{this.isKeyPressed("i")&&(a.y=-1),this.isKeyPressed("j")&&(a.x=-1),this.isKeyPressed("k")&&(a.y=1),this.isKeyPressed("l")&&(a.x=1);break}case"4PAD":{this.isPadPressed(i,"LEFT")&&(a.x=-1),this.isPadPressed(i,"RIGHT")&&(a.x=1),this.isPadPressed(i,"UP")&&(a.y=-1),this.isPadPressed(i,"DOWN")&&(a.y=1);break}case"4STICK":{const[o,c,h,l]=[this.getPadStickRight(i,s,r,n),this.getPadStickLeft(i,s,r,n),this.getPadStickUp(i,s,r,n),this.getPadStickDown(i,s,r,n)];c&&(a.x=-c),o&&(a.x=o),h&&(a.y=-h),l&&(a.y=l);break}case"STICK":{const o=this.getPadStick(i,s,n);a.x=o.x,a.y=o.y;break}case"WHEEL":{this.isMousePressed("WHEEL_LEFT")&&(a.x=-1),this.isMousePressed("WHEEL_RIGHT")&&(a.x=1),this.isMousePressed("WHEEL_UP")&&(a.y=-1),this.isMousePressed("WHEEL_DOWN")&&(a.y=1);break}}return a}}const n4={"main.ttf":{name:"GameFont",format:"truetype",scale:1,dist:"core",chars:{kigou:!0,english:!0,kana:!0,kanji:!0}}};class a4 extends Ca{constructor(){super({width:128,height:96}),globalThis.__PIXI_APP__=this,this.stage.name="GameManager: stage",q.defaultOptions.scaleMode=De.NEAREST;const e=document.createElement("style");e.innerHTML=Object.entries(n4).reduce((i,[s,r])=>`${i}
@font-face { font-family: "${r.name}"; src: url("./fonts/${s}") format("${r.format}"); }`,""),document.head.appendChild(e),document.body.appendChild(this.view)}}var $t={},Ge={},zh={exports:{}};(function(t,e){(function(i,s){t.exports=s()})(qe,function(){function i(g,d,v,w,P){(function R(I,E,x,y,C){for(;y>x;){if(y-x>600){var S=y-x+1,A=E-x+1,B=Math.log(S),M=.5*Math.exp(2*B/3),O=.5*Math.sqrt(B*M*(S-M)/S)*(A-S/2<0?-1:1),H=Math.max(x,Math.floor(E-A*M/S+O)),j=Math.min(y,Math.floor(E+(S-A)*M/S+O));R(I,E,H,j,C)}var D=I[E],k=x,X=y;for(s(I,x,E),C(I[y],D)>0&&s(I,x,y);k<X;){for(s(I,k,X),k++,X--;C(I[k],D)<0;)k++;for(;C(I[X],D)>0;)X--}C(I[x],D)===0?s(I,x,X):s(I,++X,y),X<=E&&(x=X+1),E<=X&&(y=X-1)}})(g,d,v||0,w||g.length-1,P||r)}function s(g,d,v){var w=g[d];g[d]=g[v],g[v]=w}function r(g,d){return g<d?-1:g>d?1:0}var n=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(g,d,v){if(!v)return d.indexOf(g);for(var w=0;w<d.length;w++)if(v(g,d[w]))return w;return-1}function o(g,d){c(g,0,g.children.length,d,g)}function c(g,d,v,w,P){P||(P=_(null)),P.minX=1/0,P.minY=1/0,P.maxX=-1/0,P.maxY=-1/0;for(var R=d;R<v;R++){var I=g.children[R];h(P,g.leaf?w(I):I)}return P}function h(g,d){return g.minX=Math.min(g.minX,d.minX),g.minY=Math.min(g.minY,d.minY),g.maxX=Math.max(g.maxX,d.maxX),g.maxY=Math.max(g.maxY,d.maxY),g}function l(g,d){return g.minX-d.minX}function f(g,d){return g.minY-d.minY}function u(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function p(g){return g.maxX-g.minX+(g.maxY-g.minY)}function m(g,d){return g.minX<=d.minX&&g.minY<=d.minY&&d.maxX<=g.maxX&&d.maxY<=g.maxY}function b(g,d){return d.minX<=g.maxX&&d.minY<=g.maxY&&d.maxX>=g.minX&&d.maxY>=g.minY}function _(g){return{children:g,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(g,d,v,w,P){for(var R=[d,v];R.length;)if(!((v=R.pop())-(d=R.pop())<=w)){var I=d+Math.ceil((v-d)/w/2)*w;i(g,I,d,v,P),R.push(d,I,I,v)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(g){var d=this.data,v=[];if(!b(g,d))return v;for(var w=this.toBBox,P=[];d;){for(var R=0;R<d.children.length;R++){var I=d.children[R],E=d.leaf?w(I):I;b(g,E)&&(d.leaf?v.push(I):m(g,E)?this._all(I,v):P.push(I))}d=P.pop()}return v},n.prototype.collides=function(g){var d=this.data;if(!b(g,d))return!1;for(var v=[];d;){for(var w=0;w<d.children.length;w++){var P=d.children[w],R=d.leaf?this.toBBox(P):P;if(b(g,R)){if(d.leaf||m(g,R))return!0;v.push(P)}}d=v.pop()}return!1},n.prototype.load=function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var d=0;d<g.length;d++)this.insert(g[d]);return this}var v=this._build(g.slice(),0,g.length-1,0);if(this.data.children.length)if(this.data.height===v.height)this._splitRoot(this.data,v);else{if(this.data.height<v.height){var w=this.data;this.data=v,v=w}this._insert(v,this.data.height-v.height-1,!0)}else this.data=v;return this},n.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},n.prototype.clear=function(){return this.data=_([]),this},n.prototype.remove=function(g,d){if(!g)return this;for(var v,w,P,R=this.data,I=this.toBBox(g),E=[],x=[];R||E.length;){if(R||(R=E.pop(),w=E[E.length-1],v=x.pop(),P=!0),R.leaf){var y=a(g,R.children,d);if(y!==-1)return R.children.splice(y,1),E.push(R),this._condense(E),this}P||R.leaf||!m(R,I)?w?(v++,R=w.children[v],P=!1):R=null:(E.push(R),x.push(v),v=0,w=R,R=R.children[0])}return this},n.prototype.toBBox=function(g){return g},n.prototype.compareMinX=function(g,d){return g.minX-d.minX},n.prototype.compareMinY=function(g,d){return g.minY-d.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(g){return this.data=g,this},n.prototype._all=function(g,d){for(var v=[];g;)g.leaf?d.push.apply(d,g.children):v.push.apply(v,g.children),g=v.pop();return d},n.prototype._build=function(g,d,v,w){var P,R=v-d+1,I=this._maxEntries;if(R<=I)return o(P=_(g.slice(d,v+1)),this.toBBox),P;w||(w=Math.ceil(Math.log(R)/Math.log(I)),I=Math.ceil(R/Math.pow(I,w-1))),(P=_([])).leaf=!1,P.height=w;var E=Math.ceil(R/I),x=E*Math.ceil(Math.sqrt(I));T(g,d,v,x,this.compareMinX);for(var y=d;y<=v;y+=x){var C=Math.min(y+x-1,v);T(g,y,C,E,this.compareMinY);for(var S=y;S<=C;S+=E){var A=Math.min(S+E-1,C);P.children.push(this._build(g,S,A,w-1))}}return o(P,this.toBBox),P},n.prototype._chooseSubtree=function(g,d,v,w){for(;w.push(d),!d.leaf&&w.length-1!==v;){for(var P=1/0,R=1/0,I=void 0,E=0;E<d.children.length;E++){var x=d.children[E],y=u(x),C=(S=g,A=x,(Math.max(A.maxX,S.maxX)-Math.min(A.minX,S.minX))*(Math.max(A.maxY,S.maxY)-Math.min(A.minY,S.minY))-y);C<R?(R=C,P=y<P?y:P,I=x):C===R&&y<P&&(P=y,I=x)}d=I||d.children[0]}var S,A;return d},n.prototype._insert=function(g,d,v){var w=v?g:this.toBBox(g),P=[],R=this._chooseSubtree(w,this.data,d,P);for(R.children.push(g),h(R,w);d>=0&&P[d].children.length>this._maxEntries;)this._split(P,d),d--;this._adjustParentBBoxes(w,P,d)},n.prototype._split=function(g,d){var v=g[d],w=v.children.length,P=this._minEntries;this._chooseSplitAxis(v,P,w);var R=this._chooseSplitIndex(v,P,w),I=_(v.children.splice(R,v.children.length-R));I.height=v.height,I.leaf=v.leaf,o(v,this.toBBox),o(I,this.toBBox),d?g[d-1].children.push(I):this._splitRoot(v,I)},n.prototype._splitRoot=function(g,d){this.data=_([g,d]),this.data.height=g.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(g,d,v){for(var w,P,R,I,E,x,y,C=1/0,S=1/0,A=d;A<=v-d;A++){var B=c(g,0,A,this.toBBox),M=c(g,A,v,this.toBBox),O=(P=B,R=M,I=void 0,E=void 0,x=void 0,y=void 0,I=Math.max(P.minX,R.minX),E=Math.max(P.minY,R.minY),x=Math.min(P.maxX,R.maxX),y=Math.min(P.maxY,R.maxY),Math.max(0,x-I)*Math.max(0,y-E)),H=u(B)+u(M);O<C?(C=O,w=A,S=H<S?H:S):O===C&&H<S&&(S=H,w=A)}return w||v-d},n.prototype._chooseSplitAxis=function(g,d,v){var w=g.leaf?this.compareMinX:l,P=g.leaf?this.compareMinY:f;this._allDistMargin(g,d,v,w)<this._allDistMargin(g,d,v,P)&&g.children.sort(w)},n.prototype._allDistMargin=function(g,d,v,w){g.children.sort(w);for(var P=this.toBBox,R=c(g,0,d,P),I=c(g,v-d,v,P),E=p(R)+p(I),x=d;x<v-d;x++){var y=g.children[x];h(R,g.leaf?P(y):y),E+=p(R)}for(var C=v-d-1;C>=d;C--){var S=g.children[C];h(I,g.leaf?P(S):S),E+=p(I)}return E},n.prototype._adjustParentBBoxes=function(g,d,v){for(var w=v;w>=0;w--)h(d[w],g)},n.prototype._condense=function(g){for(var d=g.length-1,v=void 0;d>=0;d--)g[d].children.length===0?d>0?(v=g[d-1].children).splice(v.indexOf(g[d]),1):this.clear():o(g[d],this.toBBox)},n})})(zh);var o4=zh.exports,Wh={exports:{}};(function(t,e){/** @preserve SAT.js - Version 0.9.0 - Copyright 2012 - 2021 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */(function(i,s){t.exports=s()})(qe,function(){var i={};function s(E,x){this.x=E||0,this.y=x||0}i.Vector=s,i.V=s,s.prototype.copy=s.prototype.copy=function(E){return this.x=E.x,this.y=E.y,this},s.prototype.clone=s.prototype.clone=function(){return new s(this.x,this.y)},s.prototype.perp=s.prototype.perp=function(){var E=this.x;return this.x=this.y,this.y=-E,this},s.prototype.rotate=s.prototype.rotate=function(E){var x=this.x,y=this.y;return this.x=x*Math.cos(E)-y*Math.sin(E),this.y=x*Math.sin(E)+y*Math.cos(E),this},s.prototype.reverse=s.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},s.prototype.normalize=s.prototype.normalize=function(){var E=this.len();return E>0&&(this.x=this.x/E,this.y=this.y/E),this},s.prototype.add=s.prototype.add=function(E){return this.x+=E.x,this.y+=E.y,this},s.prototype.sub=s.prototype.sub=function(E){return this.x-=E.x,this.y-=E.y,this},s.prototype.scale=s.prototype.scale=function(E,x){return this.x*=E,this.y*=typeof x<"u"?x:E,this},s.prototype.project=s.prototype.project=function(E){var x=this.dot(E)/E.len2();return this.x=x*E.x,this.y=x*E.y,this},s.prototype.projectN=s.prototype.projectN=function(E){var x=this.dot(E);return this.x=x*E.x,this.y=x*E.y,this},s.prototype.reflect=s.prototype.reflect=function(E){var x=this.x,y=this.y;return this.project(E).scale(2),this.x-=x,this.y-=y,this},s.prototype.reflectN=s.prototype.reflectN=function(E){var x=this.x,y=this.y;return this.projectN(E).scale(2),this.x-=x,this.y-=y,this},s.prototype.dot=s.prototype.dot=function(E){return this.x*E.x+this.y*E.y},s.prototype.len2=s.prototype.len2=function(){return this.dot(this)},s.prototype.len=s.prototype.len=function(){return Math.sqrt(this.len2())};function r(E,x){this.pos=E||new s,this.r=x||0,this.offset=new s}i.Circle=r,r.prototype.getAABBAsBox=r.prototype.getAABBAsBox=function(){var E=this.r,x=this.pos.clone().add(this.offset).sub(new s(E,E));return new a(x,E*2,E*2)},r.prototype.getAABB=r.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},r.prototype.setOffset=r.prototype.setOffset=function(E){return this.offset=E,this};function n(E,x){this.pos=E||new s,this.angle=0,this.offset=new s,this.setPoints(x||[])}i.Polygon=n,n.prototype.setPoints=n.prototype.setPoints=function(E){var x=!this.points||this.points.length!==E.length;if(x){var y,C=this.calcPoints=[],S=this.edges=[],A=this.normals=[];for(y=0;y<E.length;y++){var B=E[y],M=y<E.length-1?E[y+1]:E[0];if(B!==M&&B.x===M.x&&B.y===M.y){E.splice(y,1),y-=1;continue}C.push(new s),S.push(new s),A.push(new s)}}return this.points=E,this._recalc(),this},n.prototype.setAngle=n.prototype.setAngle=function(E){return this.angle=E,this._recalc(),this},n.prototype.setOffset=n.prototype.setOffset=function(E){return this.offset=E,this._recalc(),this},n.prototype.rotate=n.prototype.rotate=function(E){for(var x=this.points,y=x.length,C=0;C<y;C++)x[C].rotate(E);return this._recalc(),this},n.prototype.translate=n.prototype.translate=function(E,x){for(var y=this.points,C=y.length,S=0;S<C;S++)y[S].x+=E,y[S].y+=x;return this._recalc(),this},n.prototype._recalc=function(){var E=this.calcPoints,x=this.edges,y=this.normals,C=this.points,S=this.offset,A=this.angle,B=C.length,M;for(M=0;M<B;M++){var O=E[M].copy(C[M]);O.x+=S.x,O.y+=S.y,A!==0&&O.rotate(A)}for(M=0;M<B;M++){var H=E[M],j=M<B-1?E[M+1]:E[0],D=x[M].copy(j).sub(H);y[M].copy(D).perp().normalize()}return this},n.prototype.getAABBAsBox=n.prototype.getAABBAsBox=function(){for(var E=this.calcPoints,x=E.length,y=E[0].x,C=E[0].y,S=E[0].x,A=E[0].y,B=1;B<x;B++){var M=E[B];M.x<y?y=M.x:M.x>S&&(S=M.x),M.y<C?C=M.y:M.y>A&&(A=M.y)}return new a(this.pos.clone().add(new s(y,C)),S-y,A-C)},n.prototype.getAABB=n.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},n.prototype.getCentroid=n.prototype.getCentroid=function(){for(var E=this.calcPoints,x=E.length,y=0,C=0,S=0,A=0;A<x;A++){var B=E[A],M=A===x-1?E[0]:E[A+1],O=B.x*M.y-M.x*B.y;y+=(B.x+M.x)*O,C+=(B.y+M.y)*O,S+=O}return S=S*3,y=y/S,C=C/S,new s(y,C)};function a(E,x,y){this.pos=E||new s,this.w=x||0,this.h=y||0}i.Box=a,a.prototype.toPolygon=a.prototype.toPolygon=function(){var E=this.pos,x=this.w,y=this.h;return new n(new s(E.x,E.y),[new s,new s(x,0),new s(x,y),new s(0,y)])};function o(){this.a=null,this.b=null,this.overlapN=new s,this.overlapV=new s,this.clear()}i.Response=o,o.prototype.clear=o.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var c=[],h=0;h<10;h++)c.push(new s);for(var l=[],h=0;h<5;h++)l.push([]);var f=new o,u=new a(new s,1e-6,1e-6).toPolygon();function p(E,x,y){for(var C=Number.MAX_VALUE,S=-Number.MAX_VALUE,A=E.length,B=0;B<A;B++){var M=E[B].dot(x);M<C&&(C=M),M>S&&(S=M)}y[0]=C,y[1]=S}function m(E,x,y,C,S,A){var B=l.pop(),M=l.pop(),O=c.pop().copy(x).sub(E),H=O.dot(S);if(p(y,S,B),p(C,S,M),M[0]+=H,M[1]+=H,B[0]>M[1]||M[0]>B[1])return c.push(O),l.push(B),l.push(M),!0;if(A){var j=0;if(B[0]<M[0])if(A.aInB=!1,B[1]<M[1])j=B[1]-M[0],A.bInA=!1;else{var D=B[1]-M[0],k=M[1]-B[0];j=D<k?D:-k}else if(A.bInA=!1,B[1]>M[1])j=B[0]-M[1],A.aInB=!1;else{var D=B[1]-M[0],k=M[1]-B[0];j=D<k?D:-k}var X=Math.abs(j);X<A.overlap&&(A.overlap=X,A.overlapN.copy(S),j<0&&A.overlapN.reverse())}return c.push(O),l.push(B),l.push(M),!1}i.isSeparatingAxis=m;function b(E,x){var y=E.len2(),C=x.dot(E);return C<0?_:C>y?g:T}var _=-1,T=0,g=1;function d(E,x){var y=c.pop().copy(E).sub(x.pos).sub(x.offset),C=x.r*x.r,S=y.len2();return c.push(y),S<=C}i.pointInCircle=d;function v(E,x){u.pos.copy(E),f.clear();var y=I(u,x,f);return y&&(y=f.aInB),y}i.pointInPolygon=v;function w(E,x,y){var C=c.pop().copy(x.pos).add(x.offset).sub(E.pos).sub(E.offset),S=E.r+x.r,A=S*S,B=C.len2();if(B>A)return c.push(C),!1;if(y){var M=Math.sqrt(B);y.a=E,y.b=x,y.overlap=S-M,y.overlapN.copy(C.normalize()),y.overlapV.copy(C).scale(y.overlap),y.aInB=E.r<=x.r&&M<=x.r-E.r,y.bInA=x.r<=E.r&&M<=E.r-x.r}return c.push(C),!0}i.testCircleCircle=w;function P(E,x,y){for(var C=c.pop().copy(x.pos).add(x.offset).sub(E.pos),S=x.r,A=S*S,B=E.calcPoints,M=B.length,O=c.pop(),H=c.pop(),j=0;j<M;j++){var D=j===M-1?0:j+1,k=j===0?M-1:j-1,X=0,Z=null;O.copy(E.edges[j]),H.copy(C).sub(B[j]),y&&H.len2()>A&&(y.aInB=!1);var J=b(O,H);if(J===_){O.copy(E.edges[k]);var ae=c.pop().copy(C).sub(B[k]);if(J=b(O,ae),J===g){var se=H.len();if(se>S)return c.push(C),c.push(O),c.push(H),c.push(ae),!1;y&&(y.bInA=!1,Z=H.normalize(),X=S-se)}c.push(ae)}else if(J===g){if(O.copy(E.edges[D]),H.copy(C).sub(B[D]),J=b(O,H),J===_){var se=H.len();if(se>S)return c.push(C),c.push(O),c.push(H),!1;y&&(y.bInA=!1,Z=H.normalize(),X=S-se)}}else{var ue=O.perp().normalize(),se=H.dot(ue),_e=Math.abs(se);if(se>0&&_e>S)return c.push(C),c.push(ue),c.push(H),!1;y&&(Z=ue,X=S-se,(se>=0||X<2*S)&&(y.bInA=!1))}Z&&y&&Math.abs(X)<Math.abs(y.overlap)&&(y.overlap=X,y.overlapN.copy(Z))}return y&&(y.a=E,y.b=x,y.overlapV.copy(y.overlapN).scale(y.overlap)),c.push(C),c.push(O),c.push(H),!0}i.testPolygonCircle=P;function R(E,x,y){var C=P(x,E,y);if(C&&y){var S=y.a,A=y.aInB;y.overlapN.reverse(),y.overlapV.reverse(),y.a=y.b,y.b=S,y.aInB=y.bInA,y.bInA=A}return C}i.testCirclePolygon=R;function I(E,x,y){for(var C=E.calcPoints,S=C.length,A=x.calcPoints,B=A.length,M=0;M<S;M++)if(m(E.pos,x.pos,C,A,E.normals[M],y))return!1;for(var M=0;M<B;M++)if(m(E.pos,x.pos,C,A,x.normals[M],y))return!1;return y&&(y.a=E,y.b=x,y.overlapV.copy(y.overlapN).scale(y.overlap)),!0}return i.testPolygonPolygon=I,i})})(Wh);var Ii=Wh.exports;(function(t){var e=qe&&qe.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0}),t.BodyType=t.SATCircle=t.SATPolygon=t.SATVector=t.Response=t.RBush=void 0;const i=e(o4);Object.defineProperty(t,"RBush",{enumerable:!0,get:function(){return i.default}});const s=Ii;Object.defineProperty(t,"Response",{enumerable:!0,get:function(){return s.Response}}),Object.defineProperty(t,"SATVector",{enumerable:!0,get:function(){return s.Vector}}),Object.defineProperty(t,"SATPolygon",{enumerable:!0,get:function(){return s.Polygon}}),Object.defineProperty(t,"SATCircle",{enumerable:!0,get:function(){return s.Circle}});var r;(function(n){n.Ellipse="Ellipse",n.Line="Line",n.Circle="Circle",n.Box="Box",n.Point="Point",n.Polygon="Polygon"})(r||(t.BodyType=r={}))})(Ge);var us={},Tt={},re={},Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.map=Pe.filter=Pe.every=Pe.some=Pe.forEach=void 0;const c4=(t,e)=>{for(let i=0,s=t.length;i<s;i++)e(t[i],i)};Pe.forEach=c4;const h4=(t,e)=>{for(let i=0,s=t.length;i<s;i++)if(e(t[i],i))return!0;return!1};Pe.some=h4;const l4=(t,e)=>{for(let i=0,s=t.length;i<s;i++)if(!e(t[i],i))return!1;return!0};Pe.every=l4;const f4=(t,e)=>{const i=[];for(let s=0,r=t.length;s<r;s++){const n=t[s];e(n,s)&&i.push(n)}return i};Pe.filter=f4;const u4=(t,e)=>{const i=new Array(t.length);for(let s=0,r=t.length;s<r;s++)i[s]=e(t[s],s);return i};Pe.map=u4;Object.defineProperty(re,"__esModule",{value:!0});re.intersectLinePolygon=re.intersectLineLine=re.intersectLineLineFast=re.intersectLineCircle=re.circleOutsidePolygon=re.circleInPolygon=re.circleInCircle=re.pointOnCircle=re.polygonInPolygon=re.pointInPolygon=re.polygonInCircle=re.ensureConvex=void 0;const Br=Ii,d4=Ge,ft=Pe;function jh(t){return t.isConvex||t.type!==d4.BodyType.Polygon?[t]:t.convexPolygons}re.ensureConvex=jh;function p4(t,e){return(0,ft.every)(t.calcPoints,i=>(0,Br.pointInCircle)({x:i.x+t.pos.x,y:i.y+t.pos.y},e))}re.polygonInCircle=p4;function Or(t,e){return(0,ft.some)(jh(e),i=>(0,Br.pointInPolygon)(t,i))}re.pointInPolygon=Or;function m4(t,e){return(0,ft.every)(t.calcPoints,i=>Or({x:i.x+t.pos.x,y:i.y+t.pos.y},e))}re.polygonInPolygon=m4;function Yh(t,e){return(t.x-e.pos.x)*(t.x-e.pos.x)+(t.y-e.pos.y)*(t.y-e.pos.y)===e.r*e.r}re.pointOnCircle=Yh;function g4(t,e){const i=t.pos.x,s=t.pos.y,r=e.pos.x,n=e.pos.y,a=t.r,o=e.r,c=Math.sqrt((i-r)*(i-r)+(s-n)*(s-n));return c+o===a||c+o<a}re.circleInCircle=g4;function y4(t,e){if(t.r===0||!Or(t.pos,e))return!1;const i=(0,ft.map)(e.calcPoints,({x:s,y:r})=>({x:s+e.pos.x,y:r+e.pos.y}));return!((0,ft.some)(i,s=>(0,Br.pointInCircle)(s,t))||(0,ft.some)(i,(s,r)=>{const n=r?i[r-1]:i[i.length-1];return Da({start:n,end:s},t).length>0}))}re.circleInPolygon=y4;function _4(t,e){if(t.r===0||Or(t.pos,e))return!1;const i=(0,ft.map)(e.calcPoints,({x:s,y:r})=>({x:s+e.pos.x,y:r+e.pos.y}));return!((0,ft.some)(i,s=>(0,Br.pointInCircle)(s,t)||Yh(s,t))||(0,ft.some)(i,(s,r)=>{const n=r?i[r-1]:i[i.length-1];return Da({start:n,end:s},t).length>0}))}re.circleOutsidePolygon=_4;function Da(t,{pos:e,r:i}){const s={x:t.end.x-t.start.x,y:t.end.y-t.start.y},r={x:t.start.x-e.x,y:t.start.y-e.y},n=(s.x*r.x+s.y*r.y)*-2,a=(s.x*s.x+s.y*s.y)*2,o=Math.sqrt(n*n-(r.x*r.x+r.y*r.y-i*i)*a*2);if(isNaN(o))return[];const c=(n-o)/a,h=(n+o)/a,l=[];return c<=1&&c>=0&&l.push({x:t.start.x+s.x*c,y:t.start.y+s.y*c}),h<=1&&h>=0&&l.push({x:t.start.x+s.x*h,y:t.start.y+s.y*h}),l}re.intersectLineCircle=Da;function Hs(t,e,i){const s=(i.x-t.x)*(e.y-t.y),r=(e.x-t.x)*(i.y-t.y);return s>r+Number.EPSILON?1:s+Number.EPSILON<r?-1:0}function v4(t,e){return Hs(t.start,e.start,e.end)!==Hs(t.end,e.start,e.end)&&Hs(t.start,t.end,e.start)!==Hs(t.start,t.end,e.end)}re.intersectLineLineFast=v4;function qh(t,e){const i=t.end.x-t.start.x,s=t.end.y-t.start.y,r=i*(e.end.y-e.start.y)-(e.end.x-e.start.x)*s;if(r===0)return null;const n=((e.end.y-e.start.y)*(e.end.x-t.start.x)+(e.start.x-e.end.x)*(e.end.y-t.start.y))/r,a=((t.start.y-t.end.y)*(e.end.x-t.start.x)+i*(e.end.y-t.start.y))/r;return!(n>=0&&n<=1)||!(a>=0&&a<=1)?null:{x:t.start.x+n*i,y:t.start.y+n*s}}re.intersectLineLine=qh;function b4(t,e){const i=[];return(0,ft.forEach)(e.calcPoints,(s,r)=>{const n=r?e.calcPoints[r-1]:e.calcPoints[e.calcPoints.length-1],a={start:{x:n.x+e.pos.x,y:n.y+e.pos.y},end:{x:s.x+e.pos.x,y:s.y+e.pos.y}},o=qh(t,a);o&&i.push(o)}),i}re.intersectLinePolygon=b4;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.drawBVH=t.drawPolygon=t.getSATTest=t.getBounceDirection=t.mapArrayToVector=t.mapVectorToArray=t.dashLineTo=t.clonePointsArray=t.checkAInB=t.intersectAABB=t.notIntersectAABB=t.bodyMoved=t.extendBody=t.clockwise=t.distance=t.ensurePolygonPoints=t.ensureVectorPoint=t.createBox=t.createEllipse=t.rad2deg=t.deg2rad=t.RAD2DEG=t.DEG2RAD=void 0;const e=Ii,i=re,s=Ge,r=Pe;t.DEG2RAD=Math.PI/180,t.RAD2DEG=180/Math.PI;function n(x){return x*t.DEG2RAD}t.deg2rad=n;function a(x){return x*t.RAD2DEG}t.rad2deg=a;function o(x,y=x,C=1){const S=Math.PI*Math.hypot(x,y)*2,A=Math.max(8,Math.ceil(S/Math.max(1,C)));return Array.from({length:A},(B,M)=>{const O=M/A*2*Math.PI,H=Math.cos(O)*x,j=Math.sin(O)*y;return new e.Vector(H,j)})}t.createEllipse=o;function c(x,y){return[new e.Vector(0,0),new e.Vector(x,0),new e.Vector(x,y),new e.Vector(0,y)]}t.createBox=c;function h(x={}){return x instanceof e.Vector?x:new e.Vector(x.x||0,x.y||0)}t.ensureVectorPoint=h;function l(x){if(!x)throw new Error("No points array provided");const y=(0,r.map)(x,h);return u(y)?y.reverse():y}t.ensurePolygonPoints=l;function f(x,y){return Math.hypot(x.x-y.x,x.y-y.y)}t.distance=f;function u(x){let y=0;for(let C=0;C<x.length;C++){const S=x[C],A=x[(C+1)%x.length];y+=(A.x-S.x)*(A.y+S.y)}return y>0}t.clockwise=u;function p(x,y){x.isStatic=!!(y!=null&&y.isStatic),x.isTrigger=!!(y!=null&&y.isTrigger),x.padding=(y==null?void 0:y.padding)||0,x.type!==s.BodyType.Circle&&(x.isCentered=(y==null?void 0:y.isCentered)||!1),x.setAngle((y==null?void 0:y.angle)||0)}t.extendBody=p;function m(x){return x.bbox.minX<x.minX||x.bbox.minY<x.minY||x.bbox.maxX>x.maxX||x.bbox.maxY>x.maxY}t.bodyMoved=m;function b(x,y){return y.minX>x.maxX||y.minY>x.maxY||y.maxX<x.minX||y.maxY<x.minY}t.notIntersectAABB=b;function _(x,y){return!b(x,y)}t.intersectAABB=_;function T(x,y){return x.type===s.BodyType.Circle?y.type!==s.BodyType.Circle?(0,i.circleInPolygon)(x,y):(0,i.circleInCircle)(x,y):y.type===s.BodyType.Circle?(0,i.polygonInCircle)(x,y):(0,i.polygonInPolygon)(x,y)}t.checkAInB=T;function g(x){return(0,r.map)(x,({x:y,y:C})=>({x:y,y:C}))}t.clonePointsArray=g;function d(x,y,C,S,A,B=2,M=4){const O=S-y,H=A-C,j=Math.atan2(H,O),D=Math.cos(j),k=Math.sin(j);let X=y,Z=C,J=Math.hypot(O,H);for(;J>0;){const ae=Math.min(J,B);x.moveTo(X,Z),x.lineTo(X+D*ae,Z+k*ae),X+=D*(B+M),Z+=k*(B+M),J-=B+M}}t.dashLineTo=d;function v({x,y}={x:0,y:0}){return[x,y]}t.mapVectorToArray=v;function w([x,y]=[0,0]){return{x,y}}t.mapArrayToVector=w;function P(x,y){const C=new e.Vector(y.x-x.x,y.y-x.y),S=new e.Vector(x.x-y.x,x.y-y.y),A=S.dot(C.normalize())*2;return new e.Vector(C.x*A-S.x,C.y*A-S.y).normalize()}t.getBounceDirection=P;function R(x,y){return x.type===s.BodyType.Circle?y.type===s.BodyType.Circle?e.testCircleCircle:e.testCirclePolygon:y.type===s.BodyType.Circle?e.testPolygonCircle:e.testPolygonPolygon}t.getSATTest=R;function I(x,{pos:y,calcPoints:C},S=!1){const A=C[C.length-1],B=y.x+A.x,M=y.y+A.y;C.length===1?x.arc(B,M,1,0,Math.PI*2):x.moveTo(B,M),(0,r.forEach)(C,(O,H)=>{const j=y.x+O.x,D=y.y+O.y;if(S){const k=C[H-1]||A;d(x,y.x+k.x,y.y+k.y,j,D)}else x.lineTo(j,D)})}t.drawPolygon=I;function E(x,y){I(x,{pos:{x:y.minX,y:y.minY},calcPoints:c(y.maxX-y.minX,y.maxY-y.minY)})}t.drawBVH=E})(Tt);Object.defineProperty(us,"__esModule",{value:!0});us.Circle=void 0;const x4=Ii,E4=Ge,Xs=Tt;class T4 extends x4.Circle{constructor(e,i,s){super((0,Xs.ensureVectorPoint)(e),i),this.offsetCopy={x:0,y:0},this.dirty=!1,this.isConvex=!0,this.type=E4.BodyType.Circle,this.isCentered=!0,(0,Xs.extendBody)(this,s),this.unscaledRadius=i}get x(){return this.pos.x}set x(e){this.pos.x=e,this.dirty=!0}get y(){return this.pos.y}set y(e){this.pos.y=e,this.dirty=!0}get scale(){return this.r/this.unscaledRadius}set scale(e){this.setScale(e)}get scaleX(){return this.scale}get scaleY(){return this.scale}setPosition(e,i,s=!0){return this.pos.x=e,this.pos.y=i,this.dirty=!0,s&&this.updateBody(),this}setScale(e,i=e,s=!0){return this.r=this.unscaledRadius*Math.abs(e),this.dirty=!0,s&&this.updateBody(),this}setAngle(e,i=!0){this.angle=e;const{x:s,y:r}=this.getOffsetWithAngle();return this.offset.x=s,this.offset.y=r,this.dirty=!0,i&&this.updateBody(),this}setOffset(e,i=!0){this.offsetCopy.x=e.x,this.offsetCopy.y=e.y;const{x:s,y:r}=this.getOffsetWithAngle();return this.offset.x=s,this.offset.y=r,this.dirty=!0,i&&this.updateBody(),this}getAABBAsBBox(){const e=this.pos.x+this.offset.x,i=this.pos.y+this.offset.y;return{minX:e-this.r,maxX:e+this.r,minY:i-this.r,maxY:i+this.r}}draw(e){const i=this.pos.x+this.offset.x,s=this.pos.y+this.offset.y,r=Math.abs(this.r);if(this.isTrigger){const n=Math.max(8,this.r);for(let a=0;a<n;a++){const o=a/n*2*Math.PI,c=(a-1)/n*2*Math.PI,h=i+Math.cos(c)*this.r,l=s+Math.sin(c)*this.r,f=i+Math.cos(o)*this.r,u=s+Math.sin(o)*this.r;(0,Xs.dashLineTo)(e,h,l,f,u)}}else e.moveTo(i+r,s),e.arc(i,s,r,0,Math.PI*2)}drawBVH(e){(0,Xs.drawBVH)(e,this)}updateBody(e=this.dirty){var i;e&&((i=this.system)===null||i===void 0||i.insert(this),this.dirty=!1)}markAsDirty(e){e?this.updateBody(!0):this.dirty=!0}getOffsetWithAngle(){if(!this.offsetCopy.x&&!this.offsetCopy.y||!this.angle)return this.offsetCopy;const e=Math.sin(this.angle),i=Math.cos(this.angle),s=this.offsetCopy.x*i-this.offsetCopy.y*e,r=this.offsetCopy.x*e+this.offsetCopy.y*i;return{x:s,y:r}}}us.Circle=T4;var ds={},Ri={},w4={decomp:L4,quickDecomp:Wi,isSimple:N4,removeCollinearPoints:k4,removeDuplicatePoints:U4,makeCCW:R4};function S4(t,e,i){i=i||0;var s=[0,0],r,n,a,o,c,h,l;return r=t[1][1]-t[0][1],n=t[0][0]-t[1][0],a=r*t[0][0]+n*t[0][1],o=e[1][1]-e[0][1],c=e[0][0]-e[1][0],h=o*e[0][0]+c*e[0][1],l=r*c-o*n,_r(l,0,i)||(s[0]=(c*a-n*h)/l,s[1]=(r*h-o*a)/l),s}function fa(t,e,i,s){var r=e[0]-t[0],n=e[1]-t[1],a=s[0]-i[0],o=s[1]-i[1];if(a*n-o*r===0)return!1;var c=(r*(i[1]-t[1])+n*(t[0]-i[0]))/(a*n-o*r),h=(a*(t[1]-i[1])+o*(i[0]-t[0]))/(o*r-a*n);return c>=0&&c<=1&&h>=0&&h<=1}function ps(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])}function er(t,e,i){return ps(t,e,i)>0}function ua(t,e,i){return ps(t,e,i)>=0}function Kh(t,e,i){return ps(t,e,i)<0}function Ji(t,e,i){return ps(t,e,i)<=0}var A4=[],C4=[];function P4(t,e,i,s){if(s){var r=A4,n=C4;r[0]=e[0]-t[0],r[1]=e[1]-t[1],n[0]=i[0]-e[0],n[1]=i[1]-e[1];var a=r[0]*n[0]+r[1]*n[1],o=Math.sqrt(r[0]*r[0]+r[1]*r[1]),c=Math.sqrt(n[0]*n[0]+n[1]*n[1]),h=Math.acos(a/(o*c));return h<s}else return ps(t,e,i)===0}function Qi(t,e){var i=e[0]-t[0],s=e[1]-t[1];return i*i+s*s}function U(t,e){var i=t.length;return t[e<0?e%i+i:e%i]}function I4(t){t.length=0}function Ne(t,e,i,s){for(var r=i;r<s;r++)t.push(e[r])}function R4(t){for(var e=0,i=t,s=1;s<t.length;++s)(i[s][1]<i[e][1]||i[s][1]===i[e][1]&&i[s][0]>i[e][0])&&(e=s);return er(U(t,e-1),U(t,e),U(t,e+1))?!1:(M4(t),!0)}function M4(t){for(var e=[],i=t.length,s=0;s!==i;s++)e.push(t.pop());for(var s=0;s!==i;s++)t[s]=e[s]}function Zh(t,e){return Kh(U(t,e-1),U(t,e),U(t,e+1))}var D4=[],B4=[];function O4(t,e,i){var s,r,n=D4,a=B4;if(ua(U(t,e+1),U(t,e),U(t,i))&&Ji(U(t,e-1),U(t,e),U(t,i)))return!1;r=Qi(U(t,e),U(t,i));for(var o=0;o!==t.length;++o)if(!((o+1)%t.length===e||o===e)&&ua(U(t,e),U(t,i),U(t,o+1))&&Ji(U(t,e),U(t,i),U(t,o))&&(n[0]=U(t,e),n[1]=U(t,i),a[0]=U(t,o),a[1]=U(t,o+1),s=S4(n,a),Qi(U(t,e),s)<r))return!1;return!0}function F4(t,e,i){for(var s=0;s!==t.length;++s)if(!(s===e||s===i||(s+1)%t.length===e||(s+1)%t.length===i)&&fa(U(t,e),U(t,i),U(t,s),U(t,s+1)))return!1;return!0}function yr(t,e,i,s){var r=s||[];if(I4(r),e<i)for(var n=e;n<=i;n++)r.push(t[n]);else{for(var n=0;n<=i;n++)r.push(t[n]);for(var n=e;n<t.length;n++)r.push(t[n])}return r}function da(t){for(var e=[],i=[],s=[],r=[],n=Number.MAX_VALUE,a=0;a<t.length;++a)if(Zh(t,a)){for(var o=0;o<t.length;++o)if(O4(t,a,o)){i=da(yr(t,a,o,r)),s=da(yr(t,o,a,r));for(var c=0;c<s.length;c++)i.push(s[c]);i.length<n&&(e=i,n=i.length,e.push([U(t,a),U(t,o)]))}}return e}function L4(t){var e=da(t);return e.length>0?Jh(t,e):[t]}function Jh(t,e){if(e.length===0)return[t];if(e instanceof Array&&e.length&&e[0]instanceof Array&&e[0].length===2&&e[0][0]instanceof Array){for(var i=[t],s=0;s<e.length;s++)for(var r=e[s],n=0;n<i.length;n++){var a=i[n],o=Jh(a,r);if(o){i.splice(n,1),i.push(o[0],o[1]);break}}return i}else{var r=e,s=t.indexOf(r[0]),n=t.indexOf(r[1]);return s!==-1&&n!==-1?[yr(t,s,n),yr(t,n,s)]:!1}}function N4(t){var e=t,i;for(i=0;i<e.length-1;i++)for(var s=0;s<i-1;s++)if(fa(e[i],e[i+1],e[s],e[s+1]))return!1;for(i=1;i<e.length-2;i++)if(fa(e[0],e[e.length-1],e[i],e[i+1]))return!1;return!0}function lc(t,e,i,s,r){r=r||0;var n=e[1]-t[1],a=t[0]-e[0],o=n*t[0]+a*t[1],c=s[1]-i[1],h=i[0]-s[0],l=c*i[0]+h*i[1],f=n*h-c*a;return _r(f,0,r)?[0,0]:[(h*o-a*l)/f,(n*l-c*o)/f]}function Wi(t,e,i,s,r,n,a){n=n||100,a=a||0,r=r||25,e=typeof e<"u"?e:[],i=i||[],s=s||[];var o=[0,0],c=[0,0],h=[0,0],l=0,f=0,u=0,p=0,m=0,b=0,_=0,T=[],g=[],d=t,v=t;if(v.length<3)return e;if(a++,a>n)return console.warn("quickDecomp: max level ("+n+") reached."),e;for(var w=0;w<t.length;++w)if(Zh(d,w)){i.push(d[w]),l=f=Number.MAX_VALUE;for(var P=0;P<t.length;++P)er(U(d,w-1),U(d,w),U(d,P))&&Ji(U(d,w-1),U(d,w),U(d,P-1))&&(h=lc(U(d,w-1),U(d,w),U(d,P),U(d,P-1)),Kh(U(d,w+1),U(d,w),h)&&(u=Qi(d[w],h),u<f&&(f=u,c=h,b=P))),er(U(d,w+1),U(d,w),U(d,P+1))&&Ji(U(d,w+1),U(d,w),U(d,P))&&(h=lc(U(d,w+1),U(d,w),U(d,P),U(d,P+1)),er(U(d,w-1),U(d,w),h)&&(u=Qi(d[w],h),u<l&&(l=u,o=h,m=P)));if(b===(m+1)%t.length)h[0]=(c[0]+o[0])/2,h[1]=(c[1]+o[1])/2,s.push(h),w<m?(Ne(T,d,w,m+1),T.push(h),g.push(h),b!==0&&Ne(g,d,b,d.length),Ne(g,d,0,w+1)):(w!==0&&Ne(T,d,w,d.length),Ne(T,d,0,m+1),T.push(h),g.push(h),Ne(g,d,b,w+1));else{if(b>m&&(m+=t.length),p=Number.MAX_VALUE,m<b)return e;for(var P=b;P<=m;++P)ua(U(d,w-1),U(d,w),U(d,P))&&Ji(U(d,w+1),U(d,w),U(d,P))&&(u=Qi(U(d,w),U(d,P)),u<p&&F4(d,w,P)&&(p=u,_=P%t.length));w<_?(Ne(T,d,w,_+1),_!==0&&Ne(g,d,_,v.length),Ne(g,d,0,w+1)):(w!==0&&Ne(T,d,w,v.length),Ne(T,d,0,_+1),Ne(g,d,_,w+1))}return T.length<g.length?(Wi(T,e,i,s,r,n,a),Wi(g,e,i,s,r,n,a)):(Wi(g,e,i,s,r,n,a),Wi(T,e,i,s,r,n,a)),e}return e.push(t),e}function k4(t,e){for(var i=0,s=t.length-1;t.length>3&&s>=0;--s)P4(U(t,s-1),U(t,s),U(t,s+1),e)&&(t.splice(s%t.length,1),i++);return i}function U4(t,e){for(var i=t.length-1;i>=1;--i)for(var s=t[i],r=i-1;r>=0;--r)if(G4(s,t[r],e)){t.splice(i,1);continue}}function _r(t,e,i){return i=i||0,Math.abs(t-e)<=i}function G4(t,e,i){return _r(t[0],e[0],i)&&_r(t[1],e[1],i)}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Polygon=t.isSimple=void 0;const e=w4;Object.defineProperty(t,"isSimple",{enumerable:!0,get:function(){return e.isSimple}});const i=Ii,s=Ge,r=Pe,n=Tt;class a extends i.Polygon{constructor(c,h,l){if(super((0,n.ensureVectorPoint)(c),(0,n.ensurePolygonPoints)(h)),this.dirty=!1,this.type=s.BodyType.Polygon,this.centered=!1,this.scaleVector={x:1,y:1},!(h!=null&&h.length))throw new Error("No points in polygon");(0,n.extendBody)(this,l)}set isCentered(c){if(this.centered===c)return;const h=this.getCentroidWithoutRotation(),l=h.x*(c?1:-1),f=h.y*(c?1:-1);this.translate(-l,-f),this.centered=c}get isCentered(){return this.centered}get x(){return this.pos.x}set x(c){this.pos.x=c,this.dirty=!0}get y(){return this.pos.y}set y(c){this.pos.y=c,this.dirty=!0}get scaleX(){return this.scaleVector.x}get scaleY(){return this.scaleVector.y}get scale(){return this.scaleVector.x}set scale(c){this.setScale(c)}setPosition(c,h,l=!0){return this.pos.x=c,this.pos.y=h,this.markAsDirty(l),this}setScale(c,h=c,l=!0){return this.scaleVector.x=Math.abs(c),this.scaleVector.y=Math.abs(h),super.setPoints((0,r.map)(this.points,(f,u)=>(f.x=this.pointsBackup[u].x*this.scaleVector.x,f.y=this.pointsBackup[u].y*this.scaleVector.y,f))),this.markAsDirty(l),this}setAngle(c,h=!0){return super.setAngle(c),this.markAsDirty(h),this}setOffset(c,h=!0){return super.setOffset(c),this.markAsDirty(h),this}getAABBAsBBox(){const{pos:c,w:h,h:l}=this.getAABBAsBox();return{minX:c.x,minY:c.y,maxX:c.x+h,maxY:c.y+l}}draw(c){(0,n.drawPolygon)(c,this,this.isTrigger)}drawBVH(c){(0,n.drawBVH)(c,this)}getCentroidWithoutRotation(){const c=this.angle;this.setAngle(0);const h=this.getCentroid();return this.setAngle(c),h}setPoints(c){return super.setPoints(c),this.updateIsConvex(),this.pointsBackup=(0,n.clonePointsArray)(c),this}translate(c,h){return super.translate(c,h),this.pointsBackup=(0,n.clonePointsArray)(this.points),this}rotate(c){return super.rotate(c),this.pointsBackup=(0,n.clonePointsArray)(this.points),this}isSimple(){return(0,e.isSimple)(this.calcPoints.map(n.mapVectorToArray))}updateBody(c=this.dirty){var h;c&&(this.updateConvexPolygonPositions(),(h=this.system)===null||h===void 0||h.insert(this),this.dirty=!1)}markAsDirty(c){c?this.updateBody(!0):this.dirty=!0}updateConvexPolygonPositions(){this.isConvex||!this.convexPolygons||(0,r.forEach)(this.convexPolygons,c=>{c.pos.x=this.pos.x,c.pos.y=this.pos.y})}getConvex(){if(this.type&&this.type!==s.BodyType.Polygon||this.points.length<4)return[];const c=(0,r.map)(this.calcPoints,n.mapVectorToArray);return(0,e.quickDecomp)(c)}updateConvexPolygons(c=this.getConvex()){this.isConvex||(this.convexPolygons||(this.convexPolygons=[]),(0,r.forEach)(c,(h,l)=>{this.convexPolygons[l]||(this.convexPolygons[l]=new i.Polygon),this.convexPolygons[l].pos.x=this.pos.x,this.convexPolygons[l].pos.y=this.pos.y,this.convexPolygons[l].setPoints((0,n.ensurePolygonPoints)((0,r.map)(h,n.mapArrayToVector)))}),this.convexPolygons.length=c.length)}updateIsConvex(){const c=this.getConvex();this.isConvex=c.length<=1,this.updateConvexPolygons(c)}}t.Polygon=a})(Ri);Object.defineProperty(ds,"__esModule",{value:!0});ds.Ellipse=void 0;const H4=Ge,$s=Tt,X4=Ri;class $4 extends X4.Polygon{constructor(e,i,s=i,r=(i+s)/Math.PI,n){super(e,(0,$s.createEllipse)(i,s,r),n),this.type=H4.BodyType.Ellipse,this.isConvex=!0,this._radiusX=i,this._radiusY=s,this._step=r}set isCentered(e){}get isCentered(){return!0}get step(){return this._step}set step(e){this._step=e,this.setPoints((0,$s.createEllipse)(this._radiusX,this._radiusY,this._step))}get radiusX(){return this._radiusX}set radiusX(e){this._radiusX=e,this.setPoints((0,$s.createEllipse)(this._radiusX,this._radiusY,this._step))}get radiusY(){return this._radiusY}set radiusY(e){this._radiusY=e,this.setPoints((0,$s.createEllipse)(this._radiusX,this._radiusY,this._step))}center(){}updateIsConvex(){}}ds.Ellipse=$4;var Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});Mi.Box=void 0;const V4=Ge,En=Tt,z4=Ri;class W4 extends z4.Polygon{constructor(e,i,s,r){super(e,(0,En.createBox)(i,s),r),this.type=V4.BodyType.Box,this.isConvex=!0,this._width=i,this._height=s}get width(){return this._width}set width(e){this._width=e,this.setPoints((0,En.createBox)(this._width,this._height))}get height(){return this._height}set height(e){this._height=e,this.setPoints((0,En.createBox)(this._width,this._height))}updateIsConvex(){}}Mi.Box=W4;var ms={};Object.defineProperty(ms,"__esModule",{value:!0});ms.Point=void 0;const j4=Ge,Y4=Tt,q4=Mi;class K4 extends q4.Box{constructor(e,i){super((0,Y4.ensureVectorPoint)(e),.001,.001,i),this.type=j4.BodyType.Point}}ms.Point=K4;var Di={};Object.defineProperty(Di,"__esModule",{value:!0});Di.Line=void 0;const Z4=Ii,J4=Ge,Q4=Ri;class eg extends Q4.Polygon{constructor(e,i,s){if(super(e,[{x:0,y:0},{x:i.x-e.x,y:i.y-e.y}],s),this.type=J4.BodyType.Line,this.isConvex=!0,this.calcPoints.length===1||!i)throw console.error({start:e,end:i}),new Error("No end point for line provided")}get start(){return{x:this.x+this.calcPoints[0].x,y:this.y+this.calcPoints[0].y}}set start({x:e,y:i}){this.x=e,this.y=i}get end(){return{x:this.x+this.calcPoints[1].x,y:this.y+this.calcPoints[1].y}}set end({x:e,y:i}){this.points[1].x=e-this.start.x,this.points[1].y=i-this.start.y,this.setPoints(this.points)}getCentroid(){return new Z4.Vector((this.end.x-this.start.x)/2,(this.end.y-this.start.y)/2)}updateIsConvex(){}}Di.Line=eg;var Fr={},Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.BaseSystem=void 0;const tg=Mi,ig=us,sg=ds,rg=Di,ng=ms,ag=Ri,og=Ge,Tn=Pe,cg=Tt;class hg extends og.RBush{draw(e){(0,Tn.forEach)(this.all(),i=>{i.draw(e)})}drawBVH(e){const i=s=>{(0,cg.drawBVH)(e,s),s.children&&(0,Tn.forEach)(s.children,i)};(0,Tn.forEach)(this.data.children,i)}createPoint(e,i){const s=new ng.Point(e,i);return this.insert(s),s}createLine(e,i,s){const r=new rg.Line(e,i,s);return this.insert(r),r}createCircle(e,i,s){const r=new ig.Circle(e,i,s);return this.insert(r),r}createBox(e,i,s,r){const n=new tg.Box(e,i,s,r);return this.insert(n),n}createEllipse(e,i,s=i,r,n){const a=new sg.Ellipse(e,i,s,r,n);return this.insert(a),a}createPolygon(e,i,s){const r=new ag.Polygon(e,i,s);return this.insert(r),r}}Lr.BaseSystem=hg;Object.defineProperty(Fr,"__esModule",{value:!0});Fr.System=void 0;const lg=Lr,fg=Di,wn=Ge,ri=Tt,Vs=re,Nt=Pe;class ug extends lg.BaseSystem{constructor(){super(...arguments),this.response=new wn.Response}remove(e,i){return e.system=void 0,super.remove(e,i)}insert(e){if(e.bbox=e.getAABBAsBBox(),e.system){if(!(0,ri.bodyMoved)(e))return this;e.system.remove(e)}return e.minX=e.bbox.minX-e.padding,e.minY=e.bbox.minY-e.padding,e.maxX=e.bbox.maxX+e.padding,e.maxY=e.bbox.maxY+e.padding,e.system=this,super.insert(e)}updateBody(e){e.updateBody()}update(){(0,Nt.forEach)(this.all(),e=>{this.updateBody(e)})}separate(){this.checkAll(({a:e,overlapV:i})=>{if(e.isTrigger)return!1;e.setPosition(e.x-i.x,e.y-i.y)})}checkOne(e,i=()=>!0,s=this.response){if(e.isStatic)return!1;const r=this.search(e),n=a=>{if(a!==e&&this.checkCollision(e,a,s))return i(s)};return(0,Nt.some)(r,n)}checkAll(e,i=this.response){const s=this.all(),r=n=>this.checkOne(n,e,i);return(0,Nt.some)(s,r)}getPotentials(e){return(0,Nt.filter)(this.search(e),i=>i!==e)}checkCollision(e,i,s=this.response){if((e.padding||i.padding)&&(0,ri.notIntersectAABB)(e.bbox||e,i.bbox||i))return!1;const r=(0,ri.getSATTest)(e,i);if(e.isConvex&&i.isConvex)return s.clear(),r(e,i,s);const n=(0,Vs.ensureConvex)(e),a=(0,Vs.ensureConvex)(i),o=new wn.SATVector;let c=!1;return(0,Nt.forEach)(n,h=>{(0,Nt.forEach)(a,l=>{s.clear(),r(h,l,s)&&(c=!0,o.add(s.overlapV))})}),c&&(s.a=e,s.b=i,s.overlapV=o,s.overlapN=o.clone().normalize(),s.overlap=o.len(),s.aInB=(0,ri.checkAInB)(e,i),s.bInA=(0,ri.checkAInB)(i,e)),c}raycast(e,i,s=()=>!0){let r=1/0,n=null;return this.ray?(this.ray.start=e,this.ray.end=i):this.ray=new fg.Line(e,i,{isTrigger:!0}),this.insert(this.ray),this.checkOne(this.ray,({b:a})=>{if(!s(a))return!1;const o=a.type===wn.BodyType.Circle?(0,Vs.intersectLineCircle)(this.ray,a):(0,Vs.intersectLinePolygon)(this.ray,a);(0,Nt.forEach)(o,c=>{const h=(0,ri.distance)(e,c);h<r&&(r=h,n={point:c,body:a})})}),this.remove(this.ray),n}traverse(e,{children:i}=this.data){return i==null?void 0:i.find((s,r)=>{if(!s)return!1;if(s.type&&e(s,i,r))return!0;s.children&&this.traverse(e,s)})}}Fr.System=ug;(function(t){var e=qe&&qe.__createBinding||(Object.create?function(s,r,n,a){a===void 0&&(a=n);var o=Object.getOwnPropertyDescriptor(r,n);(!o||("get"in o?!r.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(s,a,o)}:function(s,r,n,a){a===void 0&&(a=n),s[a]=r[n]}),i=qe&&qe.__exportStar||function(s,r){for(var n in s)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&e(r,s,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(Ge,t),i(us,t),i(ds,t),i(Ri,t),i(Mi,t),i(ms,t),i(Di,t),i(Fr,t),i(Tt,t),i(re,t)})($t);const Gi=10;class dg extends $t.System{constructor(i,s){super();Q(this,"physicsDebugCanvas");Q(this,"physicsDebugContext");s!=null&&s.physicsDebug&&(this.physicsDebugCanvas=document.createElement("canvas"),this.physicsDebugCanvas.width=i.screen.width*Gi,this.physicsDebugCanvas.height=i.screen.height*Gi,this.physicsDebugContext=this.physicsDebugCanvas.getContext("2d"),document.body.appendChild(this.physicsDebugCanvas))}updateDebug(){if(this.physicsDebugCanvas){const[{width:i,height:s},r]=[this.physicsDebugCanvas,this.physicsDebugContext];r.save(),r.scale(Gi,Gi),r.clearRect(0,0,i,s),r.lineWidth=1/Gi,r.strokeStyle="rgba(255, 255, 255, 0.5)",r.beginPath(),this.draw(r),r.stroke(),r.strokeStyle="rgba(0, 255, 0, 0.5)",r.beginPath(),this.drawBVH(r),r.stroke(),r.restore()}}}class pg{constructor(e){Q(this,"drawingEngine");Q(this,"physicsEngine");Q(this,"frameCount",0);Q(this,"deltaTime",0);Q(this,"currentScene");Q(this,"sceneDict");Q(this,"_input");if(this.drawingEngine=new a4,this.physicsEngine=new dg(this.drawingEngine,{physicsDebug:!0}),this._input=new r4(W(this.width,this.height),this.drawingEngine.stage),e.length===0)throw new Error("");this.sceneDict=new Map,e.forEach(i=>{this.sceneDict.set(i.name,i)}),this.currentScene=e[0],this.connectScene(),this.drawingEngine.ticker.add(i=>this.update(i))}update(e){this.deltaTime=e,this.frameCount++,this._input._update(),this.physicsEngine.updateDebug(),this.currentScene.update(this)}changeScene(e){const i=this.sceneDict.get(e);if(!i)throw new Error(": "+e);this.clearScene(),this.currentScene=i,this.connectScene()}clearScene(){this.currentScene.destoroy(),this.currentScene.stage.removeChild(this.currentScene.stage),this.physicsEngine.clear()}connectScene(){this.drawingEngine.stage.addChild(this.currentScene.stage),this.currentScene.setup(this).forEach(e=>{this.spawn(e)})}hitTest(e){this.physicsEngine.checkAll(({a:i,b:s,overlapV:r})=>{e({self:i,target:s,overlap:W(r.x,r.y)})})}spawn(e){this.physicsEngine.insert(e.collider),this.currentScene.stage.addChild(e.render)}get input(){return this._input}get width(){return this.drawingEngine.screen.width}get height(){return this.drawingEngine.screen.height}get now(){return this.frameCount}get delta(){return this.deltaTime}get fps(){return this.drawingEngine.ticker.FPS}}class Qh{constructor(e){Q(this,"stage");Q(this,"entityDict");Q(this,"_name");this.stage=new Le,this._name=e,this.stage.name=`Scene: ${this._name}`,this.entityDict=new Map}get name(){return this._name}addEntity(e,i){const s=i||e.name;return this.entityDict.set(s,e),this.getEntity(s)}removeEntity(e){this.entityDict.delete(e)}getEntity(e){const i=this.entityDict.get(e);if(!i)throw new Error(" Entity : "+e);return i}getEntities(){return[...this.entityDict.entries()].reduce((i,[s,r])=>({...i,[s]:r}),{})}destoroy(){this.stage.removeChildren(),this.entityDict.forEach(e=>{e.destroy()}),this.entityDict.clear()}setup(e){return[]}update(e){}}class mg{constructor({position:e,size:i,angle:s=0,scale:r=W(1,1),origin:n=W(0,0)}){Q(this,"posize");Q(this,"angle");Q(this,"scale");Q(this,"origin");this.posize=Ai(e.x,e.y,i.x,i.y),this.angle=s,this.scale=r,this.origin=n}}class Nr{constructor({name:e,placement:i,shape:s,render:r}){Q(this,"placement");Q(this,"destroyed",!1);Q(this,"_name");Q(this,"_collider");Q(this,"_render");if(this._name=e,this.placement=new mg(i),this._render=r,this._render.name=e,s==="BOX")this._collider=new $t.Box(i.position,i.size.x,i.size.y);else if(s==="CIRCLE")this._collider=new $t.Ellipse(i.position,i.size.x,i.size.y);else throw new Error("");this.apply()}get name(){return this._name}get collider(){return this._collider}get render(){return this._render}get globalRect(){return this.placement.posize}destroy(){var e;this._render.destroy(),(e=this._collider.system)==null||e.remove(this._collider),this.destroyed=!0}get position(){const{x:e,y:i}=this.placement.posize;return W(e,i)}setPosition(e){const{x:i,y:s}=e(this.position);this.placement.posize.x=i,this.placement.posize.y=s,this.apply()}get angle(){return this.placement.angle}setAngle(e){const i=e(this.placement.angle);this.placement.angle=i,this.apply()}get scale(){return this.placement.scale}setScale(e){const{x:i,y:s}=e(this.scale);this.placement.scale.x=i,this.placement.scale.y=s,this.apply()}get origin(){return this.placement.origin}setOrigin(e){const{x:i,y:s}=e(this.origin);this.placement.origin.x=i,this.placement.origin.y=s,this.apply()}apply(){if(this.destroyed)return;const{posize:e,angle:i,scale:s,origin:r}=this.placement;this._render.position.set(e.x|0,e.y|0),this._collider.setPosition(e.x,e.y),this._render.angle=i,this._collider.setAngle($t.deg2rad(i)),this._render.scale.set(s.x,s.y),this._collider.setScale(s.x,s.y),this._render.anchor.set(r.x,r.y),this._collider.type==="Ellipse"?this._collider.setOffset(new $t.SATVector(e.width*s.x*(1-2*r.x),e.height*s.y*(1-2*r.y))):this._collider.setOffset(new $t.SATVector(e.width*s.x*-r.x,e.height*s.y*-r.y))}}class Ba extends Et{constructor(e,i,s=!1){const r=document.createElement("canvas");r.width=e.x,r.height=e.y,i(r.getContext("2d"));const n=G.from(r);n.baseTexture.scaleMode=s?De.LINEAR:De.NEAREST,super(n)}}const Oa=(t,e,i,s=!1)=>{const{fillStyle:r}=t;t.fillStyle=`#${e.toString(16)}`,i(),s&&t.fill(),t.fillStyle=r},gg=(t,e,i)=>{const{x:s,y:r,width:n,height:a}=e;t.beginPath(),t.moveTo(s+i,r),t.lineTo(s+n-i,r),t.quadraticCurveTo(s+n,r,s+n,r+i),t.lineTo(s+n,r+a-i),t.quadraticCurveTo(s+n,r+a,s+n-i,r+a),t.lineTo(s+i,r+a),t.quadraticCurveTo(s,r+a,s,r+a-i),t.lineTo(s,r+i),t.quadraticCurveTo(s,r,s+i,r),t.closePath()},yg=(t,e,i,s)=>Oa(t,e,()=>{gg(t,i,s)},!0);class zs extends Nr{constructor(e,i,s,r,n){super({name:"wall",placement:{position:W(i,s),size:W(r,n)},shape:"BOX",render:new Ba(W(r,n),a=>{Oa(a,e,()=>a.fillRect(0,0,r,n))})})}}class Ws extends Nr{constructor(e,i,s,r){super({name:"sphere",placement:{position:W(i,s),size:W(r,r),origin:W(.5,.5)},shape:"CIRCLE",render:new Ba(W(r*2,r*2),n=>{Oa(n,e,()=>{n.beginPath(),n.ellipse(r,r,r,r,0,0,2*Math.PI)},!0)})})}}const _g={palette:[0,4276545,8355711,16777215,8323072,16711680,16744319,32512,8388479,65280,127,255,8355839,16776960,65535,16711935],pixels:[[0,0,5,5,5,5,0,0],[0,5,5,5,5,6,5,0],[4,5,5,5,6,3,6,5],[4,5,5,5,5,6,5,5],[4,5,5,5,5,5,5,5],[4,4,5,5,5,5,5,5],[0,4,4,5,5,5,5,0],[0,0,4,4,4,4,0,0]]},vg={palette:[0,4276545,8355711,16777215,8323072,16711680,16744319,32512,8388479,65280,127,255,8355839,16776960,65535,16711935],pixels:[[0,7,9,9,9,9,9,9],[7,9,9,9,9,9,0,9],[7,9,9,9,9,9,9,9],[7,9,0,0,0,0,0,0],[7,9,7,7,7,7,7,0],[7,9,0,0,7,0,7,0],[7,9,0,0,0,0,0,0],[7,9,9,9,0,0,0,0]]},bg={palette:[0,4276545,8355711,16777215,8323072,16711680,16744319,32512,8388479,65280,127,255,8355839,16776960,65535,16711935],pixels:[[1,1,0,2,2,0,3,3],[1,1,0,2,2,0,3,3],[0,0,0,0,0,0,0,0],[4,4,0,5,5,0,6,6],[7,7,0,8,8,0,9,9],[10,10,0,11,11,0,12,12],[0,0,0,0,0,0,0,0],[13,13,0,14,14,0,15,15]]},xg={ball:_g,greenman:vg,palette:bg};class Eg extends Et{constructor(e,i=!1){const s=xg[e],r=document.createElement("canvas");r.width=s.pixels[0].length,r.height=s.pixels.length;const n=r.getContext("2d");for(let o=0;o<r.height;o++)for(let c=0;c<r.width;c++)n.fillStyle=`#${s.palette[s.pixels[o][c]].toString(16).padStart(6,"0")}`,n.fillRect(c,o,1,1);const a=G.from(r);a.baseTexture.scaleMode=i?De.LINEAR:De.NEAREST,super(a)}}class Tg extends Nr{constructor(e,i){super({name:"player",placement:{position:W(e,i),size:W(8,8),origin:W(.5,.5),scale:W(2,2)},shape:"BOX",render:new Eg("ball",!0)})}}class wg extends Qh{constructor(){super("col-test")}setup(e){return[this.addEntity(new Tg(40,67)),this.addEntity(new zs(16755200,0,0,e.width,0),"topWall"),new zs(16755200,0,e.height,e.width,0),new zs(16755200,0,0,16,96),new zs(16755200,112,0,16,96),new Ws(16755200,40,24,8),new Ws(16755200,88,72,8),new Ws(16755200,80,32,8),new Ws(16755200,77,40,24)]}update(e){const{player:i,topWall:s}=this.getEntities();i.setPosition(r=>W.add(r,e.input.getAxis("WASD"))),i.setAngle(()=>e.now),e.hitTest(({self:r,target:n,overlap:a})=>{r===i.collider&&(n===s.collider&&console.log("HIT!"),i.setPosition(o=>W.sub(o,a)))})}}const Sg="GameFont",Ag="truetype",Cg=1,Pg="core",Ig={kigou:!0,english:!0,kana:!0,kanji:!0},Rg={0:"-4aaeaa4",1:"-4c4444e",2:"-4a2448e",3:"-4a242a4",4:"-26aae22",5:"-e8ca2a4",6:"-4a8caa4",7:"-ea24444",8:"-4aa4aa4",9:"-4aa62a4","!":"-4444404",'"':"-aa00000","#":"-aeaaaea",$:"-4e8e2e4","%":"-824820","&":"-4aa4a86","'":"-4400000","(":"-2444442",")":"-8444448","*":"-a4e4a0","+":"-44e440",",":"-48","-":"-e000",".":"-4","/":"-24800",":":"-40040",";":"-40048","<":"-248420","=":"-e0e00",">":"-842480","?":"-4a24404","@":"-4aeac86","[":"-6444446","\\":"-84200","]":"-c44444c","^":"-4a00000",_:"-e","`":"-4200000","{":"-2448442","|":"-4444444","}":"-8442448","~":"-c6000","":"-84","":"-4a4","":"+2424244800",:"+203c44a81008",:"+2046890a8c480","":"+384482824438","":"+4081020100804","":"+40201008102040","":"+a14285028140a","":"+a05028142850a0","":"+1e101010101000","":"-11111f","":"+3e222e28283800","":"+382828e888f8","":"+1c18101010181c","":"-7311137","":"+fe00fe10101010","":"+c30202020300c","":"+60180808081860","":"+60920c0000","":"+14140a00000000","":"-a55","":"-a500000","":"-4a40000",:"+6018040c3000",:"+a6018040c3000","":"-3300",:"+807e000000",:"+601008040400",:"+a601008040400",A:"-4aaaeaa",B:"-caacaac",C:"-4a888a4",D:"-caaaaac",E:"-e88c88e",F:"-e88c888",G:"-4a8aaa6",H:"-aaaeaaa",I:"-e44444e",J:"-22222a4",K:"-aaccaaa",L:"-888888e",M:"-aeeeaaa",N:"-caaaaaa",O:"-4aaaaa4",P:"-caac888",Q:"-4aaaea6",R:"-caacaaa",S:"-4a842a4",T:"-e444444",U:"-aaaaaae",V:"-aaaaa44",W:"-aaaeeea",X:"-aa444aa",Y:"-aaa4444",Z:"-e24448e",a:"-c26a6",b:"-88caaac",c:"-68886",d:"-226aaa6",e:"-4ae86",f:"-64e4444",g:"-6a62c",h:"-88caaaa",i:"-4044444",j:"-20222a4",k:"-88aacaa",l:"-c444444",m:"-ceeea",n:"-caaaa",o:"-4aaa4",p:"-caac8",q:"-6aa62",r:"-ac888",s:"-6842c",t:"-4e4446",u:"-aaaae",v:"-aaa44",w:"-aaeea",x:"-aa4aa",y:"-aa62c",z:"-e248e",:"+20782078ac74",:"+207c207caab264",:"+888484a040",:"+84828282a040",:"+780078840830",:"+7c007c82020c30",:"+7800f820709c",:"+7c00fc1038488e",:"+20f42078a468",:"+20f6203c62a26c",:"+20f42a4a4888b0",:"+2af02a4a4888b0",:"+107c08fe24403c",:"+147c08fe24403c",:"+4186080601804",:"+4186a80601804",:"+88be8888888810",:"+8abe8888888810",:"+7c000040807e",:"+a7c000040807e",:"+8fe08748c4038",:"+afe08748c4038",:"+40404040424438",:"+54404040424438",:"+8fe2848380830",:"+afe2848380830",:"+4444fe444c403c",:"+4a44fe444c403c",:"+7c1020fe10201c",:"+7a1020fe10201c",:"+20f02e4048908e",:"+2af02e4048908e",:"+20fe205c620438",:"+2afe205c620438",:"+38c4040830",:"+3cc202020438",:"+a3cc202020438",:"+fe102020201c",:"+fe102a20201c",:"+20202c3040807e",:"+2a202c3040807e",:"+20f624449ca61c",:"+809c808090a09e",:"+485c6aaab6aa46",:"+20ec322266aa26",:"+7c9292a2c21c",:"+88be8888b8ccba",:"+8abe8888b8ccba",:"+8cba8c88b8ccba",:"+e8244644444438",:"+ea244644444438",:"+e42a4644444438",:"+300810104c4ab2",:"+300a10104c4ab2",:"+340a14104c4ab2",:"+205048840200",:"+a205048840200",:"+42a5448840200",:"+be88be88b8ccba",:"+ba88be88b8ccba",:"+b48abc88b8ccba",:"+10fe10fe509876",:"+7010247ea4a448",:"+20f62060a2e23c",:"+485c6aaab2a24c",:"+10fc20fc22221c",:"+5058e4282010",:"+485cea22241010",:"+20b8d494b820",:"+10bcca8aaa9c20",:"+101810709864",:"+101c1010789462",:"+700840bcc20438",:"+58644444040830",:"+7c103c42b24a3c",:"+20ec342464a426",:"+7c10207c82023c",:"+40d86444c458",:"+20ec322262a22c",:"+10fc207698283e",:"+101020304a4a84",:"+fc24382040",:"+fe021418101060",:"+40830d01010",:"+2040838c80808",:"+10fc84040830",:"+10fe8282040830",:"+7c1010107c",:"+fe10101010fe",:"+8fc0838c818",:"+8fe081828c818",:"+20fe222222428c",:"+2afe222222428c",:"+10fc1010fe0808",:"+14fc1010fe0808",:"+203e4282041860",:"+2a3e4282041860",:"+407e4888081020",:"+4a7e4888081020",:"+fe02020202fe",:"+afe02020202fe",:"+44fe4444040830",:"+4afe4444040830",:"+6010c022041860",:"+6a10c022041860",:"+7c04040834c2",:"+a7c04040834c2",:"+202ef22224203e",:"+2a2ef22224203e",:"+82424404081020",:"+8a404404081020",:"+203e42ba041860",:"+2a3e42ba041860",:"+c7010fe101060",:"+a7010fe101060",:"+a454540830",:"+a25252040830",:"+aa05252040830",:"+7c00fe10101060",:"+7a00fe10101060",:"+20202038262020",:"+2a202038262020",:"+1010fe10101060",:"+7c00000000fe",:"+7c0424180c32c0",:"+10fc040834d210",:"+40408081020c0",:"+28242444424282",:"+2a202444424282",:"+242a2444424282",:"+40404e7040403e",:"+4a404e7040403e",:"+444a4e7040403e",:"+fe0202041860",:"+afe0202041860",:"+4fa0604041860",:"+205088040200",:"+a205088040200",:"+42a5488040200",:"+10fe1054529230",:"+14fe1054529230",:"+14fa1450549230",:"+fe0204281008",:"+700c601c00f00e",:"+101020204884fa",:"+46414081422c0",:"+7c2020fe20201e",:"+405ce4282010",:"+405ee224201010",:"+780808fc",:"+7808080808fe",:"+7c043c047c",:"+fe027e0202fe",:"+7c00fe02020c30",:"+44444444040830",:"+82828282a4a8c",:"+40404042445860",:"+fe82828282fe",:"+fc84040830",:"+fe8282040830",:"+fe027e02041860",:"+c0200002041860",:"+2a20fe82820c30",:"+70103c5296aa46",:"+7c103844186c92",:"+8fe484848fe08",:"+fe12141010fe",:"+20fc24244498",:"+407c90101020",:"+fe28feaafe28fe",:"+10fe447c2ae432",:"+48f25e68de44da",:"+fe54feaa6418e6",:"+3ed4bef2acd42a",:"+fe7c7cfe54caba",:"+5ed25c58de64de",:"+7e48485c4848be",:"+7cd45652da64da",:"+10fe827eda28ce",:"+92fe547c7c5cb6",:"+10fe927c2818e6",:"+10feaa74fe38d6",:"+8feb4fea0ec0c",:"+44544c44648c32",:"+10fe102aec2472",:"+287ed45454587e",:"+feaafeaafeaafe",:"+fe909cbe88b6fe",:"+287ec85a74545a",:"+38fe38d67c28f6",:"+47e7c546e54aa",:"+28781c247e8256",:"+7c547c54fe48e6",:"+fe92fe7c447c44",:"+727e42764672a6",:"+7c547c28fe00c6",:"+ec54e856eac458",:"+28fe3854fe28f6",:"+285eca7e547e44",:"+48fe48d4fe4454",:"+1c28feba7c38d6",:"+107c28fe38caba",:"+9e0a3ed47e44be",:"+549e54be54f45e",:"+727e4a72a648ba",:"+883e2afe5c62be",:"+489e4abe54fe44",:"+447ec47476cc32",:"+10fe24fa447c44",:"+4fe000000",:"+10fe10feba203c",:"+8c341eda4c56be",:"+28fe109e2a08b6",:"+28fe287c10fe30",:"+f212f282f21232",:"+2eca8aea8ae808",:"+fe92fe92aac6fe",:"+3eeabeaaf6223e",:"+beaafeeaf662be",:"+38287c7c447cc6",:"+c8feaec0fe94a6",:"+8638aa00be88be",:"+c8d4bac8fe94ba",:"+48ae56e4e484ea",:"+c6f8aadcdcb2ae",:"+2cfc5ef21e6072",:"+20fe207ca4243c",:"+10feba10fe1030",:"+fe125a1236da36",:"+fe10fe92b692b6",:"+1ef2beb2fe0012",:"+54ee7cfaf44274",:"+48ee12e4e4eaf2",:"+8a3e883eaabeaa",:"+be2a1cdc7e48be",:"+38feb600fe24fa",:"+300032d4589432",:"+9800986aacca98",:"+28fe2854fe10ee",:"+8fcb4fea8e836",:"+54fe927c1038d6",:"+54feaa38107c7c",:"+58c018ba1cead8",:"+7254fa547022ac",:"+54bee27ed454e6",:"+56b85eea527a56",:"+7c447c207eaa56",:"+87edc54ee4cb6",:"+44fe44827c54fe",:"+883e9016ba949a",:"+eecaeaccec2ab2",:"+54fee27e545466",:"+44fe54f654dabe",:"+5cd41cde32dac6",:"+eeeeaabaaa9aee",:"+fe9292fe828286",:"+c25c8654de40be",:"+941494229c949c",:"+105428c65428c6",:"+7eda28ce10caba",:"+10feaa38fe28f6",:"+4658eabeca54aa",:"+46f86a5eca54ea",:"+febafeaabad6fe",:"+5e4cfede5e649e",:"+a85cbe72be34da",:"+881c3ed45c6abe",:"+4aaaea50ee6ace",:"+505ef45c40dc3e",:"+883ea21caa9ca2",:"+5c847e905aec5a",:"+56faf49eee78ee",:"+be10be109e8286",:"+fe10107c1010fe",:"+eeaaaaba8282fe",:"+107c54fe1028c6",:"+87e504850769c",:"+50887ec85c487e",:"+7eea7e6afe48c8",:"+1ee4a4eea4e41e",:"+e88ed6a4d484ea",:"+ee8ad0aeda84ea",:"+6ac448fed44c72",:"+28c620fe5a36da",:"+107c5c74fe10ee",:"+54fe54fedc5c62",:"+feaafe92d6fe82",:"+7e427e547a48be",:"+287ed47e5c726e",:"+48fed47e5c726e",:"+e8bef4beecbab6",:"+80e784e6c7e94",:"+7808102040827e",:"+287ed46a5c5c46",:"+4e7aaafa2ab8c8",:"+107c28fe7c447c",:"+7c546c7c54caba",:"+bc24bc00bcacfe",:"+c678ea5cdcf26e",:"+fe101814101010",:"+3050d25c50525e",:"+101054581028c6",:"+40fe5a5a5a5abe",:"+fe04745474040c",:"+3e50de5a5a645a",:"+3e42de565e4246",:"+28fe284acc4a4e",:"+285cc87e5c487e",:"+3e48de5a5a5a5e",:"+7c547c54fe38d6",:"+be02ba2aba8286",:"+28fe28fe745474",:"+e454e454c6fc44",:"+40fe5abefe38d6",:"+fe3838386810ee",:"+10feba30da2cda",:"+28fe285ec25a5a",:"+28fe54fe54fe10",:"+28fe7c54fe38d6",:"+284ec84e3c3cc6",:"+9c14943ea2baba",:"+8e4a0ade525abe",:"+88bee2dcda6c9a",:"+36f2a6feaaf42a",:"+4eea2a5ef25a5a",:"+acf4f654f4f456",:"+10feaa38fe5caa",:"+e82eb6e424a47a",:"+486eb4fe92aafe",:"+c87ee25cdaec5a",:"+beea3ec83edcea",:"+48fed4d44854e2",:"+7c4848fe28c818",:"+fe203828584aee",:"+1a68fe28fa246a",:"+fe10bababa82fe",:"+28fe7c48fe28d8",:"+40fe5abe243cc6",:"+eaaebcee6cac6e",:"+4eb43ed4d6bcd2",:"+1028c628282848",:"+fe82baaaba82fe",:"+7e486a6c4854a2",:"+1028de00fe24fa",:"+48dccc7e484876",:"+4fe0454fe549a",:"+e82efa8aaae41a",:"+7cd4c8765c487e",:"+5ef25e60de4ad6",:"+50decc7e545e44",:"+a03e9c7eb4be8c",:"+7c547c547caa48",:"+486e48ee107c7c",:"+44fe54fcd6544a",:"+48946e807ed47a",:"+eeee82feaafeaa",:"+e4b6e4b6a8dc9c",:"+487eea7e6adc2e",:"+64f664f6c85c5c",:"+6ea67a7e745eb4",:"+883eaa7e9c9ca2",:"+487eda5e7ef41a",:"+48feda5e7e745a",:"+a4f624b608dcdc",:"+7c447c447c00c6",:"+487858bc1a28c8",:"+28fe4aaa5a2ad6",:"+10fe927c10fe38",:"+92fe5c485c48be",:"+be24ae24aea4de",:"+56b856fa527a46",:"+4ef6f67e64744a",:"+28fe34fa7c54fe",:"+44de08d40ac4da",:"+4ef676fee4744a",:"+745ef8947a745a",:"+7e5cd45c54dc3e",:"+48fe48feea6a48",:"+18681028c63838",:"+38c87e527e4286",:"+44de5054d46ace",:"+28fe287c54fe10",:"+4cd448d4e25c5c",:"+48fe50ead44c72",:"+4eea40fe9a64ba",:"+2efa5c7a3aec28",:"+54feaa38283ace",:"+c87ed4e254c876",:"+feacccbeb2de96",:"+eeee9aaa92eeba",:"+e45e568c7e6c0e",:"+947edc5ed448b6",:"+14fed4fef6365a",:"+d47edc5ed4c876",:"+54feba08fe1030",:"+c707c48fe547c",:"+926cba10fe38d6",:"+2ef4be5a2ed07a",:"+ded46efa4e206a",:"+54fc547ed47cc4",:"+9424bc10bec2aa",:"+44d87e48dc54dc",:"+8418be089c949c",:"+1cd4dcdef21a06",:"+9c149c1eb29a86",:"+22faaa7a22fa76",:"+28fe447c7ea236",:"+9c14be229c9c94",:"+5cf43c5ef27a46",:"+c87eeadc48fe5c",:"+7c447c447c44fe",:"+58dc68fec85c6a",:"+28c638d63854fe",:"+54bedc4efc5cea",:"+121ada2a225286",:"+7c1010fe101010",:"+722a2afa222226",:"+44fe447c44447c",:"+9c08883e888888",:"+203c50fe10547c",:"+10feba00fe28ce",:"+eea4e4bee4a4a4",:"+10feba283c243c",:"+fe82640ef46cbe",:"+5438fe4cba203c",:"+c703cfe7ca43c",:"+eeb2c4b6b6d696",:"+f05eeca448f24e",:"+54fe5656f6aafa",:"+1038387c7ccaba",:"+7cd67c7c447cc6",:"+10feaa7c7cb208",:"+1ce4dcdcfe0836",:"+547ed4547ee83e",:"+5ce45c5cfe48f6",:"+7426fa5a5af41a",:"+48fe62dcde525e",:"+48ee56e404e45a",:"+eeaafeaabaaaba",:"+eeee92febad692",:"+487eaa7aea6a76",:"+10feaa7c383ace",:"+e44ae0ae44ee44",:"+47e74b200caba",:"+947eaa3efe88b6",:"+5cf6dc5c5c5c62",:"+486eb4feb23c3c",:"+eeeeaa92fe92aa",:"+4476aa74e4647a",:"+e8ced0e67c54fe",:"+46b86a9e4ad46a",:"+44fef47240726e",:"+be3e14dc6a48be",:"+44be52ecee8aee",:"+fe6a7ed45cea08",:"+486eb4eeeebaba",:"+4e7aae7aee6c76",:"+e85eeabe54fe44",:"+54f6b0b6e0acbe",:"+54b6f056e06cde",:"+20f82868384a8e",:"+1028fe087c447c",:"+92fe405c487e88",:"+547c00fe40bc3c",:"+dc407ed454d426",:"+feb2feb2feb4fa",:"+6e04fe6a6eb00a",:"+2ef45efaae90aa",:"+fea4fefaaef0aa",:"+1028d6105c50fe",:"+287ec87c544876",:"+38c87e5c54529e",:"+5cd454d4d45466",:"+407eb87c5424d2",:"+445e44eeeae41a",:"+641824fe48be2a",:"+7c047c407ccaba",:"+a03ed83c848482",:"+107c1028fe5474",:"+42ec284eea4a52",:"+38fe3cda08fe10",:"+5e8242be50f25e",:"+d07cd4d454d466",:"+feaaeabee48cf6",:"+5ee202de10d2de",:"+2ef22ef86e609e",:"+5cb454d4d494e6",:"+107c547c7a2cce",:"+5cc4feea5c5c88",:"+287c28fe449238",:"+10fe9228fe5474",:"+5ef25ef25e6c96",:"+38c87c7c94fc0e",:"+10fe7c28fe447c",:"+549854fc4a649a",:"+7eea7e5cdc7ec8",:"+5efa5e7afe0a96",:"+54fe54dcfe4062",:"+107c54fe447cc6",:"+10fe2874fe38d6",:"+4eba90fe6a34ca",:"+48ee5c6cbe2072",:"+6c6c10fe10ee6c",:"+549854fc0ae4ea",:"+3eb63eec6c7e84",:"+52e452fcd6546a",:"+e4dee4cafe22aa",:"+48fe487cd448f6",:"+10feba283828fe",:"+547cccd47e426a",:"+54fe5274fc049a",:"+44fe10fe2afc2a",:"+9ee49e6aec58b6",:"+547ec8fe567c52",:"+2634eeb4a6b4ea",:"+66fa665cfe54ea",:"+d4fec87ed67c52",:"+94fe08be16fcd2",:"+28fe407ed63a56",:"+10fe107c007c7c",:"+16fed6fadc0836",:"+48fe08dc00dcdc",:"+2e7a2afa2a58e8",:"+10fe9a6810ee38",:"+eebeeebeeeb4bc",:"+943e08ea7e50be",:"+80e784e5e509e",:"+20f82828484a8e",:"+203c44880834c2",:"+f8282c245448b6",:"+7c047c40fe020e",:"+c70407c4848fe",:"+bea2a2bea2a2be",:"+287ec85c5c6a48",:"+3cd4d6d2ea245a",:"+5ee848eec24246",:"+20ce82ee8282fe",:"+14fe105438d432",:"+10feaa4cf82ace",:"+883e94149498be",:"+38c87c047ccaba",:"+7c9456925ae45a",:"+4494549456fc44",:"+10feaa38107c7c",:"+24f62aba6ab46a",:"+ca7e48ea5cea18",:"+48946e805cd45c",:"+8dcd4dcfe0836",:"+10feb674d632d6",:"+507c9010fe1010",:"+107c10fe1024fa",:"+fe80fc84fc80fe",:"+7e7e445e445e9e",:"+5ef05e72de50de",:"+50de6a6ada50ee",:"+54fe44ba7cfe30",:"+80e784e4054be",:"+50dc28c83ec8c8",:"+feb0de72def0de",:"+38c87c547c00aa",:"+66be56de767c44",:"+8c349e1a9e80aa",:"+828aaa92aac2fe",:"+287c2828fe00c6",:"+4d4d4d4d63c04",:"+ae44a46ea424de",:"+10fe447c1054b2",:"+10fe447c08fe10",:"+547ed4d47e4062",:"+485eea404a7e56",:"+be22a23e9494a6",:"+487e48eafec836",:"+48fe486afe48f6",:"+a87ec86afe48b6",:"+ec4c6cd600caba",:"+287c28fe4420aa",:"+e8aef6aaf6bea2",:"+107c24fe56bc24",:"+c852fe9cdc4afe",:"+24762afa5ab42a",:"+46be6cbee66cb4",:"+487ed47e5cdc26",:"+5cfe54eafe626a",:"+9cfe54ea7e62aa",:"+48bed47edc5ce6",:"+24fe5afe5a6cb6",:"+76b666bc28fe38",:"+56fa74ba3e02aa",:"+506eeaea7a6848",:"+8fcbef4bed426",:"+aafe287cfe38d6",:"+a63a261cbe94aa",:"+28feaafeaaaafe",:"+7c447c407e6aba",:"+5ee84cf6d6445e",:"+fe10107c1014fe",:"+10fe9292929610",:"+c70407e484888",:"+505ee24a66da06",:"+845810de5464be",:"+1028fe10fe54fe",:"+28fe28febad6fe",:"+54fe56f6f62afa",:"+ee44ee38c63808",:"+486eb4687e6ab6",:"+547ed4fe7e487e",:"+24fe6cb6fe54b2",:"+eecae42afe1092",:"+48bcd45cfe6ac8",:"+94fe14be3ec8fe",:"+52f6325cfe486a",:"+8f4aea0fe0418",:"+5eb2fe52fe74da",:"+fe84b48894a0fe",:"+203e42ba2a3a06",:"+28fe28fe107c7c",:"+eec8eaccea28ae",:"+7c447c44fe00c6",:"+5cd4dc547e4062",:"+38387c5c74caba",:"+10feaa4c3810fe",:"+3c5cc87e6a6e7a",:"+9c5c08fe6e7abe",:"+dcdc88feeaaeba",:"+107c7c10fefe10",:"+7e427e5c486abe",:"+7ee27e6ee456de",:"+10feb67c7c6abe",:"+54f650745600aa",:"+5c947eaa7edc6a",:"+7c14fe143ee23e",:"+52da1ada1ad2e2",:"+68fe6a6af600aa",:"+28fe38fe54feaa",:"+fe92fe7c54fe10",:"+f656fc5666f474",:"+fa5ef45e64fe74",:"+7c44447c282ace",:"+fa5656fe525296",:"+fa5452fc505294",:"+7c106014fa1092",:"+7c9448f65c487e",:"+28fe2810ee107c",:"+3e48d04a7e486a",:"+fa56fe52ba10fe",:"+5eea4af67c10ee",:"+44e41ec404e4e4",:"+10fe7c547ccaba",:"+f65a748a7c447c",:"+5cd45c5ef25ac6",:"+8638aa1cbe88b6",:"+7c9448b65cc87e",:"+54fe927c7c14fa",:"+54f65a7a9a543a",:"+7c44fe447c54b2",:"+fc54c8f65cc87e",:"+2e64fe6a6e704a",:"+54de745efc56e2",:"+5a945eb45af05e",:"+52dc12de00dede",:"+87e547e7a4cb6",:"+5cd4fe545c486a",:"+ca7ed86ed0de5e",:"+f44efa6e00caba",:"+56fa749a30fe38",:"+e40eae48ee42aa",:"+28fe287cfe24fa",:"+902e2aea7a48be",:"+64be6a6e6416ac",:"+e4b6ccaca4d68c",:"+223aeadab2dab6",:"+2efa74ea3cfe30",:"+9436ba7a9aacda",:"+56e056f2d25256",:"+407e52901028c6",:"+10fe8228284482",:"+207c54545454fe",:"+881c8c3e8888b6",:"+48be489c40dc5c",:"+5a6ed6ea7e5c6a",:"+963e963abe88aa",:"+3e223e223e4286",:"+1410fe101028c6",:"+2c4ed4445e4444",:"+7c447c447c2ace",:"+5438fe44be146c",:"+fe447c5c545c94",:"+dc4e9c48de48be",:"+fe4a4a9e6a6a12",:"+3ca4bca4fe1092",:"+2854fe6a7e4876",:"+44fe782ef86caa",:"+2256feaefa22da",:"+5438fe44ba7c30",:"+ee44e4fe44e444",:"+345eee547e546e",:"+c8d4beeafe88b6",:"+feaafebad69afe",:"+eecae41a7c10fe",:"+48d47eeafe4876",:"+94bedccefc5caa",:"+26f42ef4d4f4ba",:"+4c8c40be52fe52",:"+883e2afe5c5ebe",:"+48ee54eedc4c4e",:"+10fe927c38caba",:"+eecae40a7c7cc6",:"+94fe1cce3cdcea",:"+5aaeea56ea68d6",:"+28fe28feb6deb6",:"+fe946efa6e70ca",:"+e8d4feeafe28b6",:"+6ee488ee54caba",:"+7c00fe28284a8e",:"+2e22d2622252f4",:"+10fe20681024fa",:"+38fe0038007c7c",:"+c87ed0b4c854fa",:"+feb2deb2bed49a",:"+7e485c5c486a98",:"+fe525ef25eec16",:"+44fea8bae4aabe",:"+843ea43ca6bcda",:"+be24ae2ea4b6cc",:"+547e60765a749a",:"+fc0404fc80827e",:"+fe007c447c4080",:"+1010fe107c447c",:"+6f8eac8fe0818",:"+fe92ba92aabafe",:"+eeaae0aeeaa4ba",:"+80e784e4054a6",:"+e23c5474d456ea",:"+c25cd494d456ea",:"+48ee5aeaaae41a",:"+48c87ec8dc545c",:"+3e6afe6a767e7e",:"+87e487e5c7e88",:"+ae7aae7adefa8a",:"+fe447c545e749e",:"+48fe14aa1cc2c6",:"+44ee44aeca64da",:"+7eaafe6af67efe",:"+fe547666f6607a",:"+7c10107c2424fe",:"+fe203c247808fe",:"+407c9010fe1010",:"+3ca4fc08fe00c6",:"+48904afe544876",:"+4656fca4de6092",:"+5cc8fc547e545c",:"+287c28fe44ba58",:"+5cc83cd43ed4dc",:"+46d61cc41ec0d2",:"+94fe1cde14c8f6",:"+7e4242427e42",:"+7c10101010fe",:"+282844921024fa",:"+203e52922a7602",:"+e8284868c84ace",:"+8fe4a4a6aca16",:"+1ee8484e62c206",:"+87e40484854ba",:"+fe92fe92fe1010",:"+10fe28c62810ee",:"+105410fe282ace",:"+10fe82baaaba86",:"+c70407e405c9c",:"+2e22f45e6434cc",:"+803e88088888be",:"+127c18fe30de02",:"+5c807ec444444c",:"+487ec05c54d426",:"+127c18fe24de08",:"+48fe405cd454e6",:"+8ee5a4a6ac41a",:"+fe547c547c30ce",:"+28fe5a8a5a2ad6",:"+107cfe28fe7c10",:"+50de625ada42c6",:"+105c50fe447c44",:"+2c44de485e445a",:"+7e5c5c447e4898",:"+7edcd45c545c7e",:"+943e9414be80a2",:"+107c447cfe10fe",:"+409e44a444e45e",:"+28fe407c005496",:"+2efa5c8a5a2cd8",:"+c70fe38d67c7c",:"+2c64fe687e645a",:"+48fe54e2d44876",:"+54fe54d47ed464",:"+48fea0bcf4b4a6",:"+7c10fe7c447cc6",:"+ccd488f6dcbe84",:"+10fe2838feaaba",:"+87e4e7c6a5caa",:"+48fe7640dc48fe",:"+7edc5cc8d84876",:"+28fe28fe547cc6",:"+2ce4bea8fe243a",:"+54fed05c405a6a",:"+943e947eaad09c",:"+fe4e4e846c641a",:"+48be54a254c876",:"+1ee85e527ec012",:"+943e943e9cbe94",:"+44bef054f46ace",:"+54fe54fedc7e54",:"+7ea276aa76fe62",:"+ea5cc8fed4eec4",:"+c87ed45cfee26a",:"+46baeebafe00c6",:"+5ea856fa7a526a",:"+7ea2f66af67ee2",:"+94fe14be1cfed4",:"+d4fed4fedc3e94",:"+407eb80830423e",:"+3828fe203c041c",:"+1028de007c447c",:"+4adc487ed86ec2",:"+fa8edeaedafa8a",:"+547ed6fe565c6a",:"+10fe44feda2cda",:"+10fe7c447c2ace",:"+507c90fe007c7c",:"+28441028c63838",:"+22fa4aaa5222d6",:"+feba92ba96bafe",:"+7c547c10fe00aa",:"+2efa20feaa74aa",:"+ec4ef4fea0eeee",:"+b65ca67ca43cda",:"+7c4cfec67c444c",:"+e8cef2ceee22a6",:"+984808d46240be",:"+9ea8de92bee012",:"+1028de007c0830",:"+fe92febad692fe",:"+7c447c486e48ee",:"+5ef2de525e545a",:"+5ef25ef2de545a",:"+5e54feb4da6c8c",:"+be22be24b6a4b6",:"+87edc54dc549a",:"+54be549c54d45c",:"+e81efa5ebeec16",:"+2cdc6aac6a10fe",:"+2cdc6aac6ac0ba",:"+20fe203c48887e",:"+285ec84e54445e",:"+881c9a288a8498",:"+10fe38d67c44fe",:"+e85c5a886a6418",:"+12fed4e6dc2816",:"+44fe10fe5c48be",:"+50de28ce08cec8",:"+56a4fe52fe60d2",:"+87e546a5c48be",:"+54d46a48dc48fe",:"+8fe080c18e818",:"+fe547c54fe444c",:"+4a944a105428c6",:"+10fe147cfe28f6",:"+ef05408fe38d6",:"+e85c4c96687e08",:"+10fe927c28fe10",:"+287a28fe2674aa",:"+1ae45224f872ac",:"+46f86a44fe5cea",:"+883e9408b69ca4",:"+7652ac44ba54b2",:"+10fe38ee547c94",:"+5e9656be56f65e",:"+28fe5408fe38d6",:"+7c44fe525af41a",:"+287a28fe66d46a",:"+285cc87e5c5c62",:"+2a7ed45e74545e",:"+10feaa7cfe54ba",:"+105c50fe4674aa",:"+287a28fe66f42a",:"+deea94e2dc88aa",:"+487ec8547ec414",:"+20fe285cc8487e",:"+44fe44c6cc744c",:"+22fa5a2ada7296",:"+e4bee4a6ec14ac",:"+fefe28ee28ee48",:"+487e48d4fec414",:"+284ed84e484e48",:"+b22afa9af292b6",:"+8eeb8eea8ee08",:"+5eda5afeda5a52",:"+107c10feaa3092",:"+486eb4fe9238d6",:"+e84ef8eea8eee8",:"+48fe7650dc6ec8",:"+54bed47edc54dc",:"+14e0bea8fe0836",:"+7e6a6afe6a6a42",:"+28f8287868aa2e",:"+7a4a7a527a5a96",:"+522ada2afa72aa",:"+4af44a6eda44d8",:"+5e2ad02efa74aa",:"+10feea44ba54b2",:"+5cd47e5eda7cca",:"+48fe6a54e25cea",:"+4aee6cbeec7cae",:"+7c54545454fe",:"+7c00380000fe",:"+101092929292fe",:"+2874fe54a20870",:"+4afe48fcca445a",:"+fe10ee547c14fa",:"+48d4fa546a4458",:"+10fe247e5c48be",:"+1028d63854fe10",:"+54f65afa5a745a",:"+486eb47c44fe48",:"+ea5eeaf2acf4ea",:"+44ee44aa7c7cc6",:"+ea5e68bc6a449a",:"+e458f0fe54e444",:"+2ef86ef4247c7c",:"+1010fe1010107c",:"+7c0810fe101030",:"+10fe10782810ee",:"+10105c505050fe",:"+c70507e4844e2",:"+2848fe4848485c",:"+107c547c3010ee",:"+fe027a027a7a06",:"+feaaaaaec282fe",:"+10fe107c545410",:"+407c90fe1028c6",:"+8cf0827e7c447c",:"+fe486aac684a8e",:"+10641824fa1092",:"+fe2874107c10fe",:"+3e42da425a5a46",:"+10fe107c00caba",:"+7424f42478aa2e",:"+287eda5e784876",:"+22fa22faaa72aa",:"+2424fa5e603ece",:"+445ee4bed67684",:"+48fe48fcd44876",:"+44e43654f4545e",:"+e4bee4aeeaa4ba",:"+901eaa14fe28f6",:"+7c547c547ccaba",:"+52dc525ec05ede",:"+48ee586eba286e",:"+5ee8feaaeaea08",:"+901e2a9400caba",:"+429c54be54f45a",:"+eaaceaaee0aeae",:"+5ef23e52fe4c56",:"+24b6a4f67a1092",:"+5ee21ac21adac6",:"+105efc765a767e",:"+6e620ef2fede92",:"+4ac83ec43cd4fa",:"+48dc08be04fed4",:"+901e2a947c7cc6",:"+5ea25ac2da9ae6",:"+48fe08dc00d2ee",:"+545ef4ded4f4de",:"+287cec763cfe30",:"+feb2fea8ee16aa",:"+a8ce16c42adede",:"+7c00fe10549230",:"+10feba08fe1030",:"+107c10fe08fe28",:"+901e2a088894a2",:"+fe243c3c24fe04",:"+107e427a5e427e",:"+3256d25a72445a",:"+5c545c545c2ace",:"+10fe54fc16fc30",:"+285cc87e447e54",:"+8808943a809c9c",:"+48dc487ec47ed4",:"+8fca8fea4fe14",:"+943e922492a4b6",:"+44fe244824caba",:"+24deea5ee4bee4",:"+ea5e4a946a741e",:"+5eaa4eeeea9ee2",:"+fe54feb6da7cfe",:"+87e547c7664b6",:"+afe08782434c2",:"+56fc1ebc06dcda",:"+e45ef6fe56f65e",:"+20202ef020221e",:"+10f0b2bcf0121e",:"+507c90fe1028c6",:"+10feb2287410fe",:"+87ed05cfe48b6",:"+287cf454fc7426",:"+be22be14b694be",:"+849ef0d8fe54aa",:"+883e9c2a9cacda",:"+24486ebc243cc6",:"+10feba10fe10ee",:"+28fe107c0850be",:"+fea23c20fe0818",:"+44e42e44e4445e",:"+10fe547c54fe10",:"+1028d638fe447c",:"+127c18fe20dc1c",:"+227e527ad632d6",:"+48d46a5cfe54dc",:"+24762afa5ad45a",:"+225af22af22eb2",:"+147c18fe5c00aa",:"+883e2cfe406abe",:"+52fe2abe2edaea",:"+feaaacfa6aac68",:"+44feb2e84e68ce",:"+203e42a2120206",:"+7c447c50484482",:"+547ed4fe5c545c",:"+e84ef2eaa6e2e6",:"+fe2aba2cfc6ab2",:"+fe547e7e6652f6",:"+28fe20fe40bc3c",:"+ee22ee8866aa66",:"+10feb22efa24aa",:"+c70fe10fe1030",:"+2010fe107c10fe",:"+10fe8208fe2818",:"+507c90fe1038d6",:"+f05e727a54fa10",:"+a85ed244fe548c",:"+44fe107c7c447c",:"+f85c68be685caa",:"+d85c68fe48dc2a",:"+be14be36a2bebe",:"+e2acfeaeeea4be",:"+c458fe5cdcc87e",:"+58ee5aec5ac8be",:"+107cfe24fe4494",:"+fe54feba2810ee",:"+3ee2a2bef41466",:"+7ed47e62dc48f6",:"+38feb67c10feaa",:"+5c7eeadc487e6a",:"+52fe52faee527a",:"+2ea2aaaab4e42a",:"+fe929292aac6fe",:"+5252f6f6525292",:"+107c5444fe5494",:"+38fe38d6782cc4",:"+7e527a527e6aba",:"+10feba00fe54b2",:"+48d46e40dc54dc",:"+c848ea6cc8d462",:"+107c447cfe10ee",:"+286ef46a64624c",:"+44fe365ef6765e",:"+4c9448b648e04c",:"+44fe10fe7c54be",:"+fe5a36da207c7c",:"+be2a3eea765ebe",:"+26f45e7424b46a",:"+107cfe509a5492",:"+287ca83cfe38d6",:"+74fe74aa00caba",:"+ea4afefeaaeaea",:"+e85efafebeecf6",:"+d6bcee7cd4fcd2",:"+26fc56fafe68b6",:"+1010fe10101010",:"+8808be08888888",:"+10fe2874282ace",:"+2844de444e445e",:"+38fe52b0fe38d6",:"+38fe547c5438fe",:"+52be44d654546e",:"+8416943ea294a2",:"+48bed47ad454e6",:"+d6747e04f4547a",:"+5aae54b654dc56",:"+2e322afa24b46a",:"+5ef2325eec4c56",:"+10fe825ec85e5e",:"+ae32aa7aa4f4aa",:"+107c16fc567a96",:"+48be629e74d656",:"+28fc5c7cae10fe",:"+28fc5c7cae00aa",:"+1054547c9292fe",:"+8a3e08ea6a48be",:"+56b856fa7a5256",:"+327ed4665c6856",:"+107c38fe44ba38",:"+feb4fea2f4bee4",:"+203e6aba2a3a06",:"+aa2a54ea6a40be",:"+6787e485c5c9c",:"+941e341e94949e",:"+e84e76be765e82",:"+48be48aa7ec84e",:"+429c5ed45e6e4e",:"+5e747e7a7e509a",:"+941eb41e90fe10",:"+f676de4adecade",:"+947e36e27e4cbe",:"+407c54d426508e",:"+5eea2a4aea6a56",:"+f20c785e7a4a92",:"+107c16fc10fe7c",:"+87e547e5c40aa",:"+7c447c38fe34dc",:"+feaafe38fe34dc",:"+4a9c48be50ee4e",:"+4adc08be10eece",:"+1010fe246818e6",:"+202efa5a6a3ace",:"+745e7656765aea",:"+87e5c447e4a98",:"+2e52fa2af424aa",:"+48947ec87e486a",:"+c8d4bec8fe88aa",:"+10105452921030",:"+14e424fe242444",:"+105452903418e0",:"+fe1222c67c447c",:"+fe8cb0bea8c8fe",:"+87e487e485caa",:"+48dc5a68ca44d8",:"+52347e427e4246",:"+5410fe82baaaba",:"+5eea5266de52de",:"+3808d27c54ba10",:"+7c447c28fe2848",:"+54d462c8c8547a",:"+be0a92269e929e",:"+1eeab2e6bef21e",:"+10feb67c447c44",:"+4678ea44fe544c",:"+aa08be22bea2a6",:"+87ede44d654be",:"+4afe244ee45e44",:"+d05ee85cdaea58",:"+486eb410fe10ee",:"+1cf4bea2fe223e",:"+10fe24feaade9a",:"+882ca87eaa8cb8",:"+107c28fe44fe10",:"+5e8a52a65ef25e",:"+54d422c808d4fa",:"+f6a4feacfeaab6",:"+54feaa387cfe30",:"+7c44feaaeeaaee",:"+485cfed47e54a6",:"+283e7ca83e00aa",:"+f6445e927e7216",:"+a45ef45ef4d46e",:"+5eea12c61ed2de",:"+5ee404d614d4fe",:"+38c83c3cda2cda",:"+305ef45c5e6a56",:"+5eca5ec47e10ee",:"+feaaf2aeee00aa",:"+94fe08dc08fec8",:"+22fc52fc70fa24",:"+c8fe94fedcbe88",:"+48fed47e5c487e",:"+4eb056fa7a527a",:"+54feaa7c447cc6",:"+2a5cf65c5c5c62",:"+ea4e5c8c6e6016",:"+48bed47edc48fe",:"+10101c101010fe",:"+10fe10301028c6",:"+fe823828284a8e",:"+186810ee7c38d6",:"+4a48fe48c85462",:"+c70fe54fe38d6",:"+447ee47c6ef42a",:"+8c349e7e8abe98",:"+1266fe56fa72aa",:"+54feaa38fe9210",:"+48dcc87e545c54",:"+5c54fe505eea16",:"+7c547cfeba28fe",:"+28fe32d452feaa",:"+5c945eba56dc46",:"+487ed4767ed41a",:"+88bed4f6fe549a",:"+44beee44d654ee",:"+48fe14b63ed4da",:"+c87ed4f6fed4da",:"+38c87c547c423e",:"+4ac87e44fc54fa",:"+1028d630342876",:"+44de44d6d6505e",:"+e45e64b676509e",:"+48ae54c4de96e4",:"+68be6a7e686abe",:"+3efea4acfe365a",:"+56bc5ebc46dc5a",:"+f67c6e7c66f43a",:"+7e5c7ea8fe2818",:"+7e427e507c54a6",:"+2010206462a43c",:"+10fe92fe92fe10",:"+287eea7e6a7e48",:"+fe90fc84fc90fe",:"+28fe2820646aba",:"+103c243efc146c",:"+107c28fe107c10",:"+3c44dc7e764876",:"+2c5ec04c405e5e",:"+883c8e3c88be88",:"+48fe2a7eea7e48",:"+7e5c7e68b63c3c",:"+5e50f6b0de749a",:"+5ed05650de74da",:"+9c049c3eb688b6",:"+10fe3838fe00c6",:"+44a4fe44e464c4",:"+be229426be9caa",:"+48be6abe6afe48",:"+941e34de545ebe",:"+107c3854fe6cb6",:"+48d42ac40ac4d8",:"+10fe86de5ac45a",:"+48fedc5c7e4062",:"+22fc582efa72aa",:"+10feba54fe7cba",:"+38feb67c7e68b6",:"+28fe5c28fe7aa2",:"+2efa5e2afe74aa",:"+10101028284482",:"+fe1272122a4286",:"+205ec04040405e",:"+7c44785444b208",:"+bc143cd45240be",:"+28fe2838fe547e",:"+c8fe9cdcdcbe88",:"+7c04ee4afe2818",:"+eecae40a7c7c44",:"+5e885e921e4092",:"+fed286aa9aa6fe",:"+1012f438549230",:"+10deeac8c81422",:"+c70fe54fe10fe",:"+505eeac84854a2",:"+48feeaaaeaea08",:"+a87cd466c8fe48",:"+10fe38ee38e836",:"+54de745ed454de",:"+e85cecf6a8fee8",:"+943e08da6c5abe",:"+eea4feacfea4ee",:"+c87edc5cc0f26e",:"+5ca8fe54fe48fe",:"+f4aec4b8b6d6ae",:"+746ee4b876765e",:"+5ef05af4da505e",:"+547cfeba7c54b2",:"+ac76aa4afa54ea",:"+5ede545ed46ace",:"+22f4227460a22c",:"+5efe345ef46a4e",:"+8fe0848280818",:"+ae74fe7aaef0aa",:"+7c44fe105c50be",:"+24fe2424fe2444",:"+5454fe545c407e",:"+fe10105c5050fe",:"+507e90107c10fe",:"+47e44745654aa",:"+fe28feaace82fe",:"+10fe107c547c80",:"+627aaa7a22faaa",:"+2c2ef4546e24de",:"+5e8444d654547e",:"+58dee8485c487e",:"+107c10fe447c44",:"+10fe2810ee3848",:"+f4262abaaab4ca",:"+7c447e50bc10fe",:"+d8dee848dc487e",:"+1054923ce43c3c",:"+883e0c1cbe94ba",:"+923c16d67a52be",:"+881c883e949c94",:"+47e64aa7c54fe",:"+5e4aecb6ca6e8a",:"+4eea4feaaee0a",:"+287cec76bc146c",:"+fe6afe107c10fe",:"+44fe24bc2ef4ea",:"+a85cc87ed4dc54",:"+627aaa72fe68b6",:"+44d85ed464fe38",:"+267a24fe567e54",:"+48dc08be14dcd4",:"+26fa74aafe5cfe",:"+ee4aeef4aee4fe",:"+d47ee27ed4d466",:"+101e22da040870",:"+c70407e584c88",:"+fe20207ca4243c",:"+107c10fe28aa58",:"+287c28fe7c447c",:"+44d850ded45464",:"+87e547e487eaa",:"+d610d638c67c44",:"+283e68be2810ee",:"+54fed47e5c545c",:"+47e545c567c92",:"+107c10fe447cc6",:"+e8bed476f6d4ec",:"+c85cc87edcdc62",:"+489c48be5cdc62",:"+486eb43ef47eac",:"+5e4aea4a4a6a16",:"+44d8505ed464c4",:"+48ea7e48ea6afe",:"+10feaa4cee466a",:"+48fe547ed44cf2",:"+5cd426dc14c8f6",:"+38feb6007c047c",:"+7ed4547ee254e2",:"+486eb4eeea9ae8",:"+94fe22be14d4e6",:"+c70fe107c447c",:"+4c945eba5ef05e",:"+c7010fe101010",:"+42525252524282",:"+2848ea6a6a6a7e",:"+10101e107e427e",:"+507c90fe282ace",:"+10feba003828fe",:"+10fe3838fe2818",:"+107c447cda54b2",:"+8a3e883c8a84ba",:"+981ea83e9494a6",:"+903c9426fe38d6",:"+fe7c407e6a5eaa",:"+48d47ec8dc487e",:"+48ee506ea62c76",:"+4aeaaab0eeaaae",:"+aa08fef426f42a",:"+44fe54745400aa",:"+44fe10fe9c08b6",:"+e8bcf4bcfabcaa",:"+48d43ec81cc8fe",:"+eabee85ceae4da",:"+486eb41afc1a66",:"+4abee85cea64da",:"+58bce87ed454e6",:"+943e942a9c949c",:"+489c549c7adc6a",:"+be5c1cea505cbe",:"+b61224f65c62be",:"+28fe547c5e42aa",:"+56bc56bc56dc72",:"+6abe646e641ea4",:"+1028fe107c10fe",:"+44fe00eaaae2a6",:"+44fe10fe54fe7c",:"+745eb424ca00aa",:"+5ae43e5ee45e44",:"+b21cb83e9aba92",:"+eabee4beeabeae",:"+54be48be54fe5c",:"+bc54dc54dc54be",:"+dcd49cd4dc94be",:"+5cf43c54fc547e",:"+dc54dc54dcd47e",:"+107cfe24fa1092",:"+54fe547edc54dc",:"+bc54dc54dcd47e",:"+5c945cb45cd47e",:"+e83e5a7ec8dcea",:"+44d810de1cd6e4",:"+aefade7aca10fe",:"+ae7a3eda6a40be",:"+ea5e4a946e6c16",:"+fe125a2a24548a",:"+4848fe48c8485c",:"+7c447c447cfe10",:"+38c83cfe147c30",:"+107c10fe1c50be",:"+107c38fe549228",:"+2efa2e7a6eaa2e",:"+28fe40c87ec85c",:"+28fe7c447cfe10",:"+943e08dc4854be",:"+1028fe38205c9c",:"+48fe6a7ed448f6",:"+44d8487eea7ec8",:"+3808e622dc38d6",:"+547c7c10fe38d6",:"+5cc47e6adc5cc8",:"+28fefeaafe447c",:"+44fe92fe7c447c",:"+10fe54385428c6",:"+10feaa4c30caba",:"+225aea6a4272b6",:"+10fe7610fe68b6",:"+87edc7ed448b6",:"+28fe6ca84efe48",:"+48fe48dcfe68b6",:"+547eeafe5c545c",:"+2efa6eba2ec0ba",:"+7e7e546a7e549c",:"+54a254ba40f26e",:"+943e14fe7e54be",:"+54fe54fefe545c",:"+c8beee40fec8ea",:"+5cd47e6afe5cea",:"+5c54feea7e5caa",:"+38feb62efa7aae",:"+fecae4deee24be",:"+28fe942abe1caa",:"+981c28fe545cbe",:"+2c74dc5c5a6c5a",:"+547eea7e5cd41c",:"+54feea7e5c545c",:"+28fe287c7674ba",:"+d4feeafedc14bc",:"+f4bee4bef4b4ba",:"+eeaaeaaaea98e8",:"+10fe547c1038d6",:"+7c447c105c50be",:"+3e52de4456546e",:"+e2aaeaaae202a6",:"+107c447c7ccaba",:"+5ed25e44d654ee",:"+887e2afe5c6abe",:"+3a6efe6e7a426a",:"+ba2ebe2eba82aa",:"+5462c8d4625c5c",:"+48ee586cbe246a",:"+7e7e4c5c7e6eba",:"+c4fed4fcd604aa",:"+48be48be62d466",:"+10fe4444aafe10",:"+10fe542054fe10",:"+20fe2c44fe4858",:"+24fe24746ca42c",:"+ee244864de44d6",:"+44fe5c6cfe2818",:"+4cec5e72de40d2",:"+be1428e45e74be",:"+2454de7654525e",:"+186810ee320c70",:"+883e881494a2aa",:"+5ee44464c444cc",:"+ef054fe2818e6",:"+1cc8fed4fe083e",:"+c8de88d68610fe",:"+50fed46e5c5c54",:"+e8dee8d4f422aa",:"+10fe1028284492",:"+22fe125a265286",:"+287ec85c6a5c48",:"+fa46faaeaeaaaa",:"+489c48fe447e54",:"+1024fa447ccaba",:"+e4a4eabee0aeae",:"+9e521ed25c56be",:"+54fe54fe927c54",:"+107c38ee5438d6",:"+545ef45e74d41e",:"+2a5ec452fe68b6",:"+883c1cea5c6abe",:"+44ee44aa7c447c",:"+2a5ec4423c3cc6",:"+d4fe90eadcaa98",:"+943e943eaa9c94",:"+54f6507456c8ba",:"+2a78fe68fa04aa",:"+1010fe101028c6",:"+2a48de48444442",:"+101024fa007c7c",:"+486eb47c503ed2",:"+6e64fe2e706a9e",:"+883e943e9c9c86",:"+10feba10fe101e",:"+5ed25e54d452e2",:"+be22be28a8a4c2",:"+101e7c447cfe10",:"+5ee8486eda4ace",:"+44d808be08cace",:"+b612b6149eb49e",:"+94fe10be10eece",:"+be2a9e229a9eba",:"+3e52de525e405e",:"+881c3ed47e48be",:"+eabef2beecacb6",:"+10fe74bafe2818",:"+7eea7eeafe6a56",:"+54de34de14d4de",:"+7c445444fe448c",:"+7c447c447c00fe",:"+5ef25e72de40de",:"+547c547c54fe10",:"+92fe486a6c48b6",:"+eeaaeeaaeea0ae",:"+7ee25466fe5cea",:"+aa14a208aa94a2",:"+9ee05ef25e6c9e",:"+14feaabefe0836",:"+6afea0be50fe2a",:"+44be6e8456d46e",:"+b2dc26943ed0ee",:"+4eb6f856fa74da",:"+fe8afeaa8a9afe",:"+7c547c54fe22c6",:"+2e4a604e6ac45a",:"+d2acf8aeda8af2",:"+ea44febec87ec8",:"+6f8aafeaaf42a",:"+aad422c82ad4e2",:"+487ef67e5cd43e",:"+4454de7654d21e",:"+84149e3694929e",:"+407eaa7a2a5a8e",:"+245ec45656505e",:"+e864687a78ea2e",:"+f4265afa6a34ca",:"+9e5e10da5e64be",:"+87ed05ef656a8",:"+f45ef45ef4d45e",:"+feaafe24bca4fe",:"+7c9666be56fc4a",:"+486eb42424242c",:"+10fe6012fe547c",:"+be501aec5a68be",:"+28fe6012fe547c",:"+486eb44cee38d6",:"+d85ce87ec8d462",:"+10feaa5c7a10fe",:"+28fe1028fe1092",:"+44fe10fe5c5c9c",:"+88bed4feea76be",:"+10fe9292fe1010",:"+287eea6a7e4848",:"+107c54547c14fa",:"+883eaa2abe8888",:"+10fe927c7c547c",:"+107c547c10caba",:"+48fe6a7eea6afe",:"+9008be089c88be",:"+7c447844ba28fe",:"+50c87ec8dc487e",:"+10fe547c2ae432",:"+e45ee4f4ace4ec",:"+48bcfe54fe64d4",:"+e8c4eec4ee24ae",:"+28fe3c18fe34dc",:"+e4bef2aee404ac",:"+fe101010101030",:"+7c147c50fe1216",:"+87e407e484898",:"+28aa2c6caa28ce",:"+f0bef4b4b4f40c",:"+3c203820fe2876",:"+54f65476d454e6",:"+5ed0dcd07e545a",:"+de50dc90fe54da",:"+faacfaacd8fa8c",:"+f4b6f4b6f4b4e6",:"+48aef24ae662c6",:"+fe485e525ec012",:"+107c7c407e02aa",:"+ee4aeeaa4eea56",:"+eea8eca8feacaa",:"+e8a8eea8fe12be",:"+2ef62af06e6a9e",:"+eeaafea8eeb6aa",:"+f4b6f456f4d4e6",:"+54be46fe567c4a",:"+3edabebade3a12",:"+be1abe3a9eba92",:"+ba14a21c5488be",:"+beea3eaa36fee2",:"+e47e6e6e60fa36",:"+54be46fc52c8ba",:"+10fe10bca4bcfe",:"+24fe6e7e267aaa",:"+44d6547eea44d8",:"+883eaa0c8c94a6",:"+e8546ac46ac418",:"+eaa0eea4eea4ba",:"+c8fe9cdcc89caa",:"+2458fe483c3cc6",:"+44beec4cfe60d2",:"+885e1ed05e52be",:"+54de74ded4545e",:"+d4fe9aec9a10fe",:"+be043eea7e6abe",:"+87ec47eea7eaa",:"+7e62dc7a5cec1a",:"+881c883e9c9ca2",:"+7e48ea487ec808",:"+c705454545492",:"+24feae78ee6276",:"+225cd45e54525e",:"+7c44fe107c10fe",:"+c458887ec85cbe",:"+28fc147c503ed2",:"+10feba105c50be",:"+87e5e545e54ba",:"+42dc545ed452de",:"+16e6a4f6a694ec",:"+10fe44feba1030",:"+101e7c447c7cc6",:"+10fe24fe927c54",:"+5ee404c404e4ec",:"+87e72546e54ae",:"+825c14de5664be",:"+287ed47e5e4858",:"+284edc545c5c62",:"+4c4cfe4456d42e",:"+4cec5e44d654ee",:"+dc54fe48dcc87e",:"+72dce4def4deee",:"+48be54be6adc54",:"+48fe14be2adcd4",:"+be22be28aea8ce",:"+48eeb2eaa6e206",:"+486eb4107c547c",:"+48fe547eea76fe",:"+883e943eaab6be",:"+883e14fe6a76be",:"+24f65afaaadcfa",:"+b612b624b6dab6",:"+8c4e14de445abe",:"+44d85ed47c447c",:"+4caef45ee464da",:"+54be56e65e5c5a",:"+54fe5666de5cda",:"+fe107c101028c6",:"+287c6c7cfe00c6",:"+87e484e485e9e",:"+101c107c7c00aa",:"+7e427e547e68b6",:"+8418be14a288aa",:"+ee40fee444ea5e",:"+7f405c5c5c5c",:"+fe9292fe9292fe",:"+3c40fe4848547a",:"+7e4a706e7a44aa",:"+38feb67c547c0e",:"+482848280ef808",:"+4e4bea4e4041e",:"+5e48e8aeda6a8e",:"+489c48fe4c586e",:"+88143ec86a58be",:"+2e7a2cfa4abc38",:"+883eac3eaaa4da",:"+8814be08ba10fe",:"+e4aee4bee816a6",:"+10107c101010fe",:"+2e22fa5a6434ca",:"+2efa546abc146c",:"+87e547e5448b6",:"+2efa54ea00caba",:"+fe121222224286",:"+18681028d6300c",:"+5e44e4c444648c",:"+52347e023e027e",:"+5cd4665cd448f6",:"+fe007c447c28fe",:"+10fe547c5438d6",:"+f22a5afa6232c6",:"+943614f65466be",:"+3a56e67e527a46",:"+883e1c1c889caa",:"+87e5c4e7c549c",:"+107c7c407eaafa",:"+54f654f6d45466",:"+44de04d40cc4cc",:"+9c3e1cea4c54be",:"+54feba28382ace",:"+48cedc545c7e48",:"+901e2a947c54fe",:"+d0deaadecaaebe",:"+547ec8547ed41c",:"+54fe4854fe54dc",:"+48fe5cdcc85c6a",:"+9c14be109eaa96",:"+87ec05ed24c9e",:"+74aa44ba2810fe",:"+486eb438c63838",:"+486eb418fe2818",:"+486eb4fe82baba",:"+48be54ba54d466",:"+e658ea40f6d656",:"+e8badc6adcf4dc",:"+a47eec66fcea4e",:"+ee04eeaa4ee012",:"+f6a4feacf2acac",:"+28fe2af4aafcaa",:"+eeee82f6dea6f6",:"+f6a4feaceea2b6",:"+fe82ba82baaaba",:"+be22ba22babaa6",:"+feb2feb2febeb2",:"+e85eeaeaea4af6",:"+54feaa387c10fe",:"+107c28fe7c10fe",:"+943e08d45c54be",:"+345ef676567a4a",:"+5eb2fe52fe7ed2",:"+543edc5cfe2818",:"+e4beeabeeea4fe",:"+484e48feecea08",:"+fea8feb0dc94fe",:"+c8dcc87ec47e54",:"+5c947ec47e544c",:"+2e3af4aa7c447c",:"+48be5cdc40726e",:"+486ebc507e02aa",:"+107c10fe54fe7c",:"+a85eba7ea82ade",:"+48fe08be22d4e6",:"+5ed05ed4d66a4a",:"+382828ee8282fe",:"+10feaa4cfe10ee",:"+7e427e487e6abe",:"+16f810527e101e",:"+fea8ecb6ecb6ac",:"+2ef42eaafe203a",:"+1028fe087c7cc6",:"+48bec86afe48ce",:"+7c44feb67824fa",:"+24fe3424fe2444",:"+f656f456f654b4",:"+10fe28c67c54b2",:"+10fe92aac68286",:"+6afa6ab2fe38d6",:"+aac41eac36e4fe",:"+4eaaea5ef27ada",:"+10fe10feaafe92",:"+e84ef6e444e45a",:"+5afe5cfefc2cde",:"+7c00000004fe",:"+7e427e505e509e",:"+6a08fe680434c2",:"+203e62ba223a06",:"+10fe92aa92aa86",:"+40eea4e44464de",:"+7e42427e42427e",:"+70101028284482",:"+3cd4047414fc26",:"+7e427e487a5caa",:"+2458c87e48485c",:"+222cf45e6434ce",:"+7c2c146c10caba",:"+5ed60ad600d2ee",:"+10feaa5cfe1030",:"+286cf46cb600aa",:"+407e907c50fe10",:"+1028de3808c2ba",:"+48d46e5cc472ee",:"+a848ee48fed25e",:"+545eecd46a40aa",:"+6ac2d46a76627e",:"+48be6aaa76e266",:"+2456f476567456",:"+eaa2f4aaf6b2be",:"+287c7c007e68b6",:"+943ebe00beb4da",:"+7eea6a7ee062de",:"+883eaa3cb4c8b6",:"+8438a638b6b4d2",:"+e45e569e7a740a",:"+fe547cae4aee52",:"+7e507c507e02aa",:"+841e942afe28f6",:"+feaafe507e02aa",:"+7edc485cc87ec8",:"+7ec848dcea4848",:"+28ee28fe447c44",:"+e4bee4bef6b6a4",:"+5476d4f6547654",:"+ee42e2eea8eaee",:"+54f65476d476d4",:"+e8aefaaaea04aa",:"+87e7a547e54a6",:"+28ee28fe54fe10",:"+10fe10fe8228ce",:"+287ed47e405c5c",:"+50de4cfed45e44",:"+487ed47e40dc1c",:"+c8fe94fec09c9c",:"+94bed4dcfe5caa",:"+feaafe7c447cc6",:"+e4beeabee00eae",:"+107e427e42427e",:"+285ed25e52525e",:"+48fe527ed252de",:"+883ea23ea2a2be",:"+885e12de525ebe",:"+7f405c5c5c5c",:"+48feb2bef2b2be",:"+4a7edc5c7e544c",:"+28fe9c1cbe148c",:"+107c10fe2850ae",:"+943e9c14be88b6",:"+4abe5c9c7ed44c",:"+7e7ed4fe6a5caa",:"+486eb42afe7aae",:"+486eb418fe34dc",:"+5e56f6de56769e",:"+fcb4f4b4f4b4a6",:"+28282828444482",:"+48bec85cea5cc8",:"+74aa44ba7c28ce",:"+7244f27e1c28d6",:"+2a48de484a445a",:"+50fe505cd468d6",:"+feaafe6a0ae2e6",:"+eeee82aefaaab6",:"+7e407c545448b6",:"+1054107c10fe10",:"+bc24a42ca0a29e",:"+be52b276b032de",:"+5cd4d4dc545466",:"+bc24b42ca4a4c6",:"+2456c45e445e44",:"+22aa22fa22fa26",:"+5e50fe5a5ae41a",:"+ded09edadaa49a",:"+5ed05edada645a",:"+aea8ee8aeab4aa",:"+e64c6cee4cd42e",:"+4f6e4fee4fe04",:"+4eeaa0aeeaa4ba",:"+eea8eeaaea14aa",:"+d67c4cee54d42e",:"+5eb05edada94ea",:"+56fa686efa6cea",:"+5e48fed25e6092",:"+5e548e7a5e50ba",:"+486eb4fe6af82e",:"+86fa74ea7c1092",:"+28fe9c3e942e8c",:"+cf4beeabed426",:"+fe54fe38d67c7c",:"+10fe28ba3814fa",:"+6e6af4aa7c54fe",:"+48487a4c487ace",:"+87e4a7c5448b6",:"+2e22f25e683ace",:"+fe1034d27c447c",:"+54d45e54d45cf6",:"+48be6afc746856",:"+48fe6a7cf468d6",:"+feaaeabee0a2be",:"+28ee28ee28ee48",:"+107c547c28fe08",:"+fc54d27cd65492",:"+87ec45eda54aa",:"+d04ad274fad06e",:"+44fe365efa745a",:"+28ee28ee28c2ba",:"+fe447c765476a4",:"+28fe2afec47cc6",:"+e85e5a9e6c7e04",:"+feaafe54f67456",:"+b43e2af47e44be",:"+7e7e4c784e788e",:"+7e4a7e525e529e",:"+44fe7c10fe10ee",:"+547ed4fe605e56",:"+54be46fe56546a",:"+1038287c54fe48",:"+e4beecb6ecb6ac",:"+e4bee4b4eca4ac",:"+fea8a8aace80fe",:"+201424aab220de",:"+900a9234ba90ae",:"+486eb47e14fe10",:"+5e54feb2de749e",:"+fe107c447c447c",:"+5012f438549230",:"+107c10fc2ae432",:"+287ec87c5a745a",:"+fe547c00fe54b2",:"+bec82ac83ec8c8",:"+be1c9c00be88aa",:"+7edc5cc0fe486a",:"+28fe287c7c547c",:"+c85cda68cac458",:"+87edc7eea76a2",:"+54fe547efe6afe",:"+947ed47efe6abe",:"+7c447c00eeaaee",:"+84189e14be80a2",:"+2844fa287c7cc6",:"+10feba547838c6",:"+2eb4aefabe20ca",:"+84f66a7aaaf42a",:"+be50fc74fc74ba",:"+fe101034d21010",:"+107c10fe1028c6",:"+28c628281028c6",:"+245ec4544c444c",:"+20fe287eaa2a08",:"+48dc487ec854e2",:"+87e525e725a96",:"+50fed0645e5644",:"+1078487c44fe10",:"+eab6d2bab2d296",:"+48e808cc0ae8e8",:"+38c87c447c7cc6",:"+24f426f474609e",:"+8e34801c84be88",:"+5c44feaadc7c88",:"+486eb45ec4544c",:"+10feaa387c547c",:"+44fe6c28fe447c",:"+87e546c7e6ab6",:"+24f66a6afa64aa",:"+80e785e5e5e92",:"+f6c4fed4dc34ba",:"+94fe14b614fedc",:"+305ecc7e545e44",:"+6a08fe145c52fa",:"+2efa5cfa0a6c68",:"+80fe54fe54be44",:"+227e22fa6632c6",:"+7c547c7c545cb6",:"+2a48fe48485462",:"+7e52705e7a54ba",:"+fa567606faaafa",:"+7ed4dcc07e6a7e",:"+509e6ccc544876",:"+5eec2c40fe565e",:"+f0beecacf4a8b6",:"+50fe2c4cf46856",:"+fe547c8c54c876",:"+48e84868d054fa",:"+943e9e34be96a4",:"+2848c84850547a",:"+d0deee4ed66a56",:"+b454e25cd4d46c",:"+5494629c54d46c",:"+38feb644be146c",:"+8fed4fed41c22",:"+487ed47e54dc22",:"+48fed47e545c62",:"+10fe74ba7c547c",:"+282844be1424cc",:"+10fe28281028c6",:"+eeee82febafa8a",:"+fe10fe92aac286",:"+fe543810fe1010",:"+c707c48fe00c6",:"+3440fe547e5464",:"+44fe28aaac28fe",:"+7ec87eeaf66266",:"+e4f6a4f6dc88be",:"+eeaaee92fab2d6",:"+7e62fe746cfe14",:"+966af4aa7c5410",:"+966af4aafe2848",:"+28fe9466dab4da",:"+54a07ed4fe94e4",:"+5410fe1038d610",:"+647e4afe6410fe",:"+646eca64fe3cfe",:"+87ef47eea7eb4",:"+f29afa4a7252b6",:"+28fe547e4a648a",:"+48487e407c4484",:"+be4a0ad26640be",:"+9e501eda546abe",:"+10fe28ba6810ee",:"+3e54dc505e6e4a",:"+be5c10de6e4abe",:"+7e945c905eee4a",:"+1024fa28fe2848",:"+3e5cdc48584876",:"+64ae76762a6abe",:"+105c50fe549a70",:"+3c54dc487e5c6a",:"+afea8beea3e2a",:"+4afe487eea7eea",:"+4afe285efa7e5a",:"+4abe48fe2afeea",:"+3c3424fe547e0c",:"+28fe38fe7caa58",:"+28fe38fe449238",:"+28fe38fe4420aa",:"+28fe38fe44ba38",:"+486eb41cbe148c",:"+10fe203c24448c",:"+407eba0a7a407e",:"+28fe10fe203cc4",:"+2efa2cfa2afc48",:"+107c38fe54ba10",:"+10feba103814fe",:"+50de7a4ada50de",:"+24f64a7a5a54ba",:"+881c883e8894ba",:"+901eba0a9a909e",:"+e8aef6a2eea8ae",:"+285cfe546a5c48",:"+547ed6de6e4c5a",:"+4c5448f6c8fe08",:"+e84e56826e680e",:"+92fe7e5a7e5ab6",:"+48fe10de12d2e6",:"+2e7af85efa742a",:"+4cf4a8f6487ec8",:"+287c7cfe4438fe",:"+48ae56e2ee88ee",:"+10fe54dc2ae432",:"+568a44ba5ed46e",:"+10fe404040403e",:"+7c107c0850609e",:"+48fed05050504e",:"+445ee84e6aca16",:"+445ee8aeca6a96",:"+10fe407c54caba",:"+e4bec8aeaaca96",:"+fe447c487e54ac",:"+e4bee8aeeaaab6",:"+28fe2838fe38d6",:"+fe82fe447c447c",:"+22fa5afa027276",:"+449e48ae4aea56",:"+2efa4e72fe10fe",:"+287ed47e6a4c54",:"+7ee2fed45c545c",:"+48dc7ed4ea5c48",:"+2ec6ea7c447cc6",:"+28de72be72ac56",:"+7c7c28fe5438d6",:"+eabceabcf8aabc",:"+94fe14dc3edcea",:"+7f405c5e5e5c",:"+2828ea2c68aa2e",:"+10fe1038549210",:"+28f8287c6aa828",:"+d0def454d44876",:"+e8bcfeb4e6a8fe",:"+2a7ed47e5c4876",:"+7c54fe00aa10fe",:"+6afe547edc48f6",:"+9c14a61c9488b6",:"+246ef6962af266",:"+7e62fe6e64d61e",:"+10fe103854ba10",:"+10fe28d638fe48",:"+fe6afe6abe7e6a",:"+7c446454544486",:"+2844fa287c54fe",:"+87e547e547e94",:"+87e547e547e98",:"+87e547e545eac",:"+87e547e5c5ca6",:"+407eb4fe547e0c",:"+485ce8bec85caa",:"+50de74d4d44876",:"+8fca8fea8dc2a",:"+7e6afe6a7ec83e",:"+28fe38fe56bc34",:"+eabeecacfea4ba",:"+48fe6acccc5466",:"+7c0424281028c6",:"+10fe107c1038d6",:"+48fe485cc85cea",:"+fe203c2424448c",:"+943e947eaabea2",:"+5cd4fe7e544876",:"+9c14be3e9488b6",:"+107c10fe1038d6",:"+8fca8bee81c2a",:"+48fce8fe5c6abe",:"+7e6a7eeafee808",:"+10feaa60ba547c",:"+10feaa7cb814fa",:"+e4b8e6b8f6b4b2",:"+485cfaa8ca6498",:"+7c447c507e48e6",:"+feb2feb4feb4fa",:"+7c1408fe2ac818",:"+e82e54ea7eaa76",:"+80fe54fe54feaa",:"+28fe54feaa1870",:"+38feb66cfa66aa",:"+445ef2beda749a",:"+3c2458103ed21e",:"+1028de00eeea08",:"+eeaaeeaaee1226",:"+aa083edc6a48be",:"+feba2838fe00c6",:"+eeaaee127c54fe",:"+4eaaf448fe6ace",:"+8dcdcd0de022a",:"+847efc54fed4aa",:"+38c87c547c2ace",:"+fe10feaabaaafe",:"+489c549c7eea48",:"+5ee85e76be56be",:"+28fe287e4a449a",:"+54fe5cd4fe4876",:"+c701ef01ef01e",:"+10fe407cfe28f6",:"+10fe407c7c447c",:"+44f84ef84ef84e",:"+ac44fe48dc5cbe",:"+7ea276fe6aee62",:"+7e427e427e427e",:"+eafee848f600aa",:"+eeaaee82828286",:"+48be549448d462",:"+eeaaee82baaaba",:"+203e52b21e22c6",:"+8808143a809c9c",:"+10fe284eda445a",:"+feb2f4bef624fc",:"+d05ee89cda6ad8",:"+7e405c5454529e",:"+5c9466dc544876",:"+488e52aa46e246",:"+5ed21ed414d2e2",:"+28feba6cfe38d6",:"+eea6ee44eedcee",:"+eeee92feaafeba",:"+10fe92fe9292fe",:"+883eaa3eaaaabe",:"+38d4eec0fa3c2a",:"+48d4ee405a5a5a",:"+48d42ec01adada",:"+e854eee05afa5a",:"+87ec876f452ae",:"+14def4ded4141e",:"+20fe203c5448b6",:"+20fe207ca43c24",:"+7c087c54fe22c6",:"+34dab6dafe92fe",:"+265ad45a00caba",:"+7e2afc6afa2cf8",:"+9e049e1abe8ab6",:"+947ed47ef662be",:"+54e22854e26c4c",:"+943e16da6e54be",:"+2afe2c4e5cac7e",:"+5cfe1caa3cd6e2",:"+fe3838feee10ee",:"+f46e6afe94f6be",:"+3e5cdc7e764876",:"+203c2038fe0818",:"+7c2810fe121030",:"+1028fe10fe54b2",:"+54fe44ba007c7c",:"+ee244eea6e40d2",:"+282eda6a2a5af6",:"+7e527e527e5296",:"+44fe107c10fe10",:"+222cf45e6434ca",:"+943e881c88be88",:"+fe547c10fe28f6",:"+10feaa5428fe38",:"+87e5c7e6a7eaa",:"+5cd47e50de6ad6",:"+46da487ec86afe",:"+28fe5c40fe38d6",:"+dcd4bed0deaa96",:"+883eb60894ae8c",:"+feaceca8feacba",:"+54fe5cfeea5c6a",:"+87ed45cfe56aa",:"+eea4de76def6d6",:"+10feaa7c10feaa",:"+44fe10fe7ab43a",:"+48fe566cf654e6",:"+46da08de08eafe",:"+1eeabee4aefc0e",:"+50ee6a6afa68c8",:"+8418883e8888b6",:"+94228814a29c9c",:"+54862a5484747a",:"+fe5a36da7c28fe",:"+fe5a3658fe00c6",:"+48fe5454d458fe",:"+7eea3e48fe5c6a",:"+feaafe945ef45e",:"+10fe5410fe38d6",:"+38feb6007c547c",:"+2ef47e7a2e70aa",:"+4c94489462dc5c",:"+28fe8c3488369c",:"+e64ae4eab0eeee",:"+48feba7ee85caa",:"+1464fc24745476",:"+2ecaeeaaea2848",:"+e8cee638383ace",:"+b426a036809cbe",:"+28fe684e6038fe",:"+76f66afeea7e6a",:"+10fe547c3010ee",:"+722afa2a72a226",:"+7c547c547c10fe",:"+fe6a7eea7ec83e",:"+87ec876d67a96",:"+10fe547cfe68b6",:"+7e7e586e5a749a",:"+c87e54dc7eee3a",:"+2afe5c6efcbcee",:"+c8dcbed4e688be",:"+10fe44242828fe",:"+48bc4efc487e48",:"+7edcdc487e5c6a",:"+6eae4eaf0ee0e",:"+56e676f6f65464",:"+883e943a989aaa",:"+2ec696ea7c547c",:"+107c28fe547c0e",:"+a87ed454d4d87e",:"+ccd488f6dc88be",:"+e45e489e606a1a",:"+3e52de485e525e",:"+48ee5468ba2c6a",:"+80e785e7e4ab6",:"+80e785e5c72ae",:"+fe041810101030",:"+fe10fe92d6fe82",:"+107c447c5448e6",:"+a454e454c6fc44",:"+883e941c88aa98",:"+aa44be6abe2aca",:"+c8dc88fed4a896",:"+7c44fe547c10fe",:"+287ed47e54486a",:"+5ea4ee0aee6052",:"+10feaa7caa3892",:"+87ed47ed448aa",:"+e8bef4bef4a8ea",:"+bc54fe5cdcc87e",:"+10fe1222224286",:"+5c847e886adc6a",:"+24fe246c76a424",:"+7e6a7e6a7e48be",:"+2854ee407e7e6a",:"+e854eee05efe56",:"+eabccaa0b4dea4",:"+f4a6fe96f0aefe",:"+ce7666fa5cdc1c",:"+be129e149ea49a",:"+7c547c24fa1092",:"+7c547c8244927c",:"+ae74ae2afe20da",:"+1028de00fe1210",:"+48e82848e84a4e",:"+88142e00be8a88",:"+f48ef6a6b6daba",:"+fe447c487e48b6",:"+3a56de6e5a5266",:"+48b4ee40fe6ac8",:"+38feb628fe1210",:"+38feb600ba54fe",:"+48fc4efc1aec5a",:"+24baeeb0deb6f4",:"+eeaa7e547e64b6",:"+7e547e547e62be",:"+7e547e544654be",:"+f24a6aaa624286",:"+10549a30fe22c6",:"+f24a6aa24600aa",:"+f26aaa42fe68b6",:"+10fe28aa00caba",:"+883e1cdc7e48be",:"+87e5c4e7e5caa",:"+48be5c9c48dc6a",:"+48bedc5cc85cea",:"+3c243c107e427e",:"+5e40ded25e50a0",:"+e6aae4aaf00eae",:"+e6aae44af0ceee",:"+38feb6eaa45aee",:"+127c18fe3cd01e",:"+54fe927c1424cc",:"+7c107c28fe2848",:"+4eeaacea8aace8",:"+4eeaaeea8eaad6",:"+883ca43caaa4b2",:"+87e5674766eb4",:"+6adc6ad0fe547a",:"+be3ea03ea8de9a",:"+486ef456fa7456",:"+10fe0028284482",:"+5ca4fe48ea5cea",:"+44ee7e547e64b6",:"+48d42ec03efeea",:"+702efa2a7aaa2e",:"+44d83ec81cd4dc",:"+e8bee8aefa0eaa",:"+e8beeaa0eabeaa",:"+afe64ea00caba",:"+50fc54e6c87e48",:"+883e94369c9e82",:"+e4bef2aef6acb6"},Mg={name:Sg,format:Ag,scale:Cg,dist:Pg,chars:Ig,table:Rg},Dg=t=>({...t," ":"-0","":"+0"});class Bg{constructor(e,i,s=Mg){Q(this,"binarySize");Q(this,"fontSize");Q(this,"_canvas");this._canvas=document.createElement("canvas");const r=Dg(s.table);this.fontSize=s.scale*8,this.binarySize=(+`0b${"1".repeat(this.fontSize)}`).toString(16).length;const n=[...e].map(h=>this.unzip(r[h])),a=n.reduce((h,l)=>h+(l!=null&&l.isHalf?.5:1)*this.fontSize,0);this._canvas.width=a,this._canvas.height=this.fontSize;const o=this._canvas.getContext("2d");let c=0;for(let h=0;h<n.length;h++){const{isHalf:l,content:f}=n[h],u=l?this.fontSize/2:this.fontSize;console.log(c);for(let p=0;p<this.fontSize;p++)for(let m=0;m<u;m++)o.fillStyle=`#${i.toString(16).padStart(6,"0")}`,f[p][m]===1&&o.fillRect(c+m,p,1,1);c+=u}}get canvas(){return this._canvas}get size(){return W(this._canvas.width,this._canvas.height)}unzip(e){try{const i=e.slice(0,1)==="-",s=e.slice(1),n="0".repeat(this.fontSize*(i?this.binarySize/2:this.binarySize)-s.length)+s,o=n.match(new RegExp(`.{${n.length/this.fontSize}}`,"g")).map(c=>(+`0x${c}`).toString(2).padStart(i?this.fontSize/2:this.fontSize,"0")).map(c=>[...c].map(Number));return{isHalf:i,content:o}}catch{return{isHalf:!1,content:[]}}}}class Og extends Nr{constructor(e,i,{backgroundColor:s=16777215,textColor:r=0,borderRadius:n=8,padding:a=1}={}){const o=new Bg(i,r),c=Qm(o.size,Ai.wh(e)),h=new Ba(W(e.width,e.height),l=>{yg(l,s,Ai(a,a,e.width-a*2,e.height-a*2),n),l.drawImage(o.canvas,c.x,c.y)});super({name:"button",placement:{position:W(e.x,e.y),size:W(e.width,e.height)},shape:"BOX",render:h})}}class Fg extends Qh{constructor(){super("main")}setup(e){return[this.addEntity(new Og(Ai(32,16,64,16),""))]}update(e){const{button:i}=this.getEntities();Jm(e.input.getMousePosition(),i.globalRect)&&e.input.isMouseTriggered("LEFT")&&e.changeScene("col-test")}}const Lg=new pg([new Fg,new wg]);globalThis.__DEBUG__=Lg;const ni={prevHeap:0,currentHeap:0};setInterval(()=>{ni.prevHeap=ni.currentHeap,ni.currentHeap=globalThis.performance.memory.totalJSHeapSize/(1024*2)|0;const t=ni.prevHeap-ni.currentHeap;t!==0&&console.log(`RAM: ${ni.currentHeap} MB (${t>0?"+":"-"}${Math.abs(t)})`)},1e3);
